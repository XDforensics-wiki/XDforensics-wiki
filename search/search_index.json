{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to XDforensics-wiki \u00b6 This is a wiki-blog created by Xidian University, for studying and shareing forensics tricks using. \u8fd9\u91cc\u662f\u897f\u5b89\u7535\u5b50\u79d1\u6280\u5927\u5b66\u7535\u5b50\u6570\u636e\u53d6\u8bc1Wiki\uff0c\u5b66\u4e60\u3001\u5206\u4eab\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u7684\u6280\u5de7\u4e0e\u65b9\u6cd5 \u76f8\u5173\u7684\u53d6\u8bc1\u5de5\u5177\u4e0e\u5f80\u5c4a\u6bd4\u8d5b\u9898\u76ee\u955c\u50cf\u5b58\u50a8\u5728\u897f\u7535\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u5b9e\u9a8c\u5ba4\u7684\u767e\u5ea6\u7f51\u76d8\u4e2d\u3002 What's Forensics? \u00b6 \u00b7\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u4ece\u5b9e\u6218\u51fa\u53d1\uff0c\u5b66\u4e60\u4e0e\u5b9e\u8df5\u89c4\u5f8b\u76f8\u7ed3\u5408\uff0c\u6280\u672f\u548c\u6cd5\u5f8b\u5e76\u91cd\u3002 \u00b7\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u5305\u62ec\u5e76\u4e0d\u9650\u4e8eWindows\u3001MacOS\u3001UNIX/Linux\u3001\u79fb\u52a8\u7ec8\u7aef\u3001\u7f51\u7edc\u6570\u636e\u53d6\u8bc1\u7684\u57fa\u672c\u77e5\u8bc6\u548c\u53d6\u8bc1\u6280\u672f\u3001\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u7684\u76f8\u5173\u6cd5\u5f8b\u89c4\u5219\u548c\u6807\u51c6\u7b49\u7b49\uff1b\u540c\u65f6\u4ee5\u5b9e\u6218\u51fa\u53d1\uff0c\u5bf9\u4e8e\u7535\u5b50\u6570\u636e\u73b0\u573a\u52d8\u9a8c\u3001\u9274\u5b9a\u548c\u68c0\u9a8c\u3001\u5b9e\u9a8c\u5ba4\u5efa\u8bbe\u4e0e\u8ba4\u53ef\u7b49\u8fdb\u884c\u6df1\u5165\u9610\u8ff0\uff0c\u6700\u540e\u8f85\u4ee5\u771f\u5b9e\u6848\u4f8b\uff0c\u63d0\u51fa\u5404\u79cd\u7f51\u7edc\u6848\u4ef6\u7684\u53d6\u8bc1\u601d\u8def\u548c\u8fc7\u7a0b\u3002 \u00b7\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u76ee\u7684\u662f\u57f9\u517b\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u7684\u80fd\u529b\u3002 \u5f80\u5c4a\u8d5b\u4e8b \u00b6 2019\u201c\u864e\u9cb8\u676f\u201d\u5168\u56fd\u5927\u5b66\u751f\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u6bd4\u8d5b 2019\u201c\u957f\u5b89\u676f\u201d\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u7ade\u8d5b 2019\u201c\u7f8e\u4e9a\u676f\u201d\u7b2c\u4e94\u5c4a\u4e2d\u56fd\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u5927\u8d5b \u53d6\u8bc1\u76f8\u5173\u673a\u6784\uff08\u516c\u53f8\uff09 \u00b6 \u4e0a\u6d77\u5f18\u8fde\u7f51\u7edc\u79d1\u6280 \u5927\u8fde\u777f\u6d77\u4fe1\u606f\u79d1\u6280 \u53a6\u95e8\u7f8e\u4e9a\u67cf\u79d1 Join us \u00b6 \u897f\u7535\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u6821\u5185\u4ea4\u6d41QQ\u7fa4\uff1a857172003 \u897f\u7535\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u5b9e\u9a8c\u5ba4\u5730\u5740\uff1a\u56fe\u4e66\u9986B\u533a465","title":"About"},{"location":"#welcome-to-xdforensics-wiki","text":"This is a wiki-blog created by Xidian University, for studying and shareing forensics tricks using. \u8fd9\u91cc\u662f\u897f\u5b89\u7535\u5b50\u79d1\u6280\u5927\u5b66\u7535\u5b50\u6570\u636e\u53d6\u8bc1Wiki\uff0c\u5b66\u4e60\u3001\u5206\u4eab\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u7684\u6280\u5de7\u4e0e\u65b9\u6cd5 \u76f8\u5173\u7684\u53d6\u8bc1\u5de5\u5177\u4e0e\u5f80\u5c4a\u6bd4\u8d5b\u9898\u76ee\u955c\u50cf\u5b58\u50a8\u5728\u897f\u7535\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u5b9e\u9a8c\u5ba4\u7684\u767e\u5ea6\u7f51\u76d8\u4e2d\u3002","title":"Welcome to XDforensics-wiki"},{"location":"#whats-forensics","text":"\u00b7\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u4ece\u5b9e\u6218\u51fa\u53d1\uff0c\u5b66\u4e60\u4e0e\u5b9e\u8df5\u89c4\u5f8b\u76f8\u7ed3\u5408\uff0c\u6280\u672f\u548c\u6cd5\u5f8b\u5e76\u91cd\u3002 \u00b7\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u5305\u62ec\u5e76\u4e0d\u9650\u4e8eWindows\u3001MacOS\u3001UNIX/Linux\u3001\u79fb\u52a8\u7ec8\u7aef\u3001\u7f51\u7edc\u6570\u636e\u53d6\u8bc1\u7684\u57fa\u672c\u77e5\u8bc6\u548c\u53d6\u8bc1\u6280\u672f\u3001\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u7684\u76f8\u5173\u6cd5\u5f8b\u89c4\u5219\u548c\u6807\u51c6\u7b49\u7b49\uff1b\u540c\u65f6\u4ee5\u5b9e\u6218\u51fa\u53d1\uff0c\u5bf9\u4e8e\u7535\u5b50\u6570\u636e\u73b0\u573a\u52d8\u9a8c\u3001\u9274\u5b9a\u548c\u68c0\u9a8c\u3001\u5b9e\u9a8c\u5ba4\u5efa\u8bbe\u4e0e\u8ba4\u53ef\u7b49\u8fdb\u884c\u6df1\u5165\u9610\u8ff0\uff0c\u6700\u540e\u8f85\u4ee5\u771f\u5b9e\u6848\u4f8b\uff0c\u63d0\u51fa\u5404\u79cd\u7f51\u7edc\u6848\u4ef6\u7684\u53d6\u8bc1\u601d\u8def\u548c\u8fc7\u7a0b\u3002 \u00b7\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u76ee\u7684\u662f\u57f9\u517b\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u7684\u80fd\u529b\u3002","title":"What's Forensics?"},{"location":"#_1","text":"2019\u201c\u864e\u9cb8\u676f\u201d\u5168\u56fd\u5927\u5b66\u751f\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u6bd4\u8d5b 2019\u201c\u957f\u5b89\u676f\u201d\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u7ade\u8d5b 2019\u201c\u7f8e\u4e9a\u676f\u201d\u7b2c\u4e94\u5c4a\u4e2d\u56fd\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u5927\u8d5b","title":"\u5f80\u5c4a\u8d5b\u4e8b"},{"location":"#_2","text":"\u4e0a\u6d77\u5f18\u8fde\u7f51\u7edc\u79d1\u6280 \u5927\u8fde\u777f\u6d77\u4fe1\u606f\u79d1\u6280 \u53a6\u95e8\u7f8e\u4e9a\u67cf\u79d1","title":"\u53d6\u8bc1\u76f8\u5173\u673a\u6784\uff08\u516c\u53f8\uff09"},{"location":"#join-us","text":"\u897f\u7535\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u6821\u5185\u4ea4\u6d41QQ\u7fa4\uff1a857172003 \u897f\u7535\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u5b9e\u9a8c\u5ba4\u5730\u5740\uff1a\u56fe\u4e66\u9986B\u533a465","title":"Join us"},{"location":"Linux1/","text":"Linux Basic Analysis \u00b6 \u6587\u6863\u4fa7\u91cd\u4e8e\u4ee5\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u4e3a\u76ee\u7684\u7684Linux \u7cfb\u7edf\u89e3\u6790\uff0c\u4e3b\u8981\u5305\u542bLinux \u6587\u4ef6\u7cfb\u7edf\u76ee\u5f55\u3001\u7279\u6b8a\u7684\u7cfb\u7edf\u6587\u4ef6\u3001\u5e38\u7528\u8f6f\u4ef6\u7684\u76ee\u5f55\u3001\u6587\u4ef6\u4e0e\u529f\u80fd\u7b49\uff0c\u53ef\u80fd\u4e0d\u4f1a\u4ecb\u7ecdLinux \u5f00\u53d1\u7684\u76f8\u5173\u5185\u5bb9\u3002 \u4e00\u3001\u5e38\u89c1\u7684Linux \u53d1\u884c\u7248 \u00b6 DebianOS\uff0c\u4ee5\u53ca\u5176\u884d\u751f\u7248\u672c\uff1aUbuntu\u3001LinuxMint\u3001Deepin\u3001Kali Linux Redhat\uff0c\u4ee5\u53ca\u5176\u884d\u751f\u7248\u672c\uff1aCentOS\u3001Fedora \u5176\u4ed6\uff1aArchlinux \u7b49 \u67e5\u770b\u5f53\u524d\u7684Linux \u53d1\u884c\u7248\u7248\u672c\uff1a lsb_release \uff1a lsb_release -a uname \uff1a uname -a \u67e5\u627e\\etc \u4e2d\u7684\u6587\u4ef6\uff1a \u5bf9\u4e8eDebian \u53ca\u5176\u884d\u751f\u7248\uff1a cat \\etc\\issue cat \\etc\\issue.net cat \\etc\\lsb-release cat \\etc\\os-release \u5bf9\u4e8eCentOS\uff1a cat \\etc\\centos-release \u5bf9\u4e8eFedora\uff1a cat \\etc\\fedora-release \u4e8c\u3001Linux \u7cfb\u7edf\u7684\u5178\u578b\u76ee\u5f55\u7ed3\u6784\uff08Dir Structure\uff09 \u00b6 \u76ee\u5f55 \u8bf4\u660e / \u6839\u76ee\u5f55\uff0c\u6839\u76ee\u5f55\u4e0b\u4e00\u822c\u53ea\u6709\u4ee5\u4e0b\u6587\u4ef6\u5939\uff0c\u6ca1\u6709\u6587\u4ef6| /bin \u5b58\u653e\u4e86\u7cfb\u7edf\u547d\u4ee4\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4f8b\u5982cat\u3001vi\uff0c\u76f8\u5f53\u4e8eWindows \u7684\u7cfb\u7edf\u73af\u5883\u53d8\u91cfPATH /etc \u5b58\u653e\u4e86\u7cfb\u7edf\u914d\u7f6e\uff0c\u4f8b\u5982release /home \u7528\u6237\u6587\u4ef6\u5939\uff0c\u4f8b\u5982/home/user1 \uff0c/home/user2 /usr \u5b58\u653e\u4e86\u7528\u6237\u5e94\u7528\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3001\u4ee3\u7801\u3001\u52a8\u6001\u94fe\u63a5\u5e93\u7b49\uff0c\u76f8\u5f53\u4e8eWindows \u7684\u7528\u6237\u73af\u5883\u53d8\u91cfPATH /usr/bin \u7528\u6237\u5b89\u88c5\u7684\u5e94\u7528\u7684\u53ef\u6267\u884c\u6587\u4ef6 /usr/doc Linux \u6587\u6863 /usr/include \u5934\u6587\u4ef6\u76ee\u5f55 /usr/lib \u5b58\u653e\u52a8\u6001\u94fe\u63a5\u5e93\u3001\u8f6f\u4ef6\u5305\u914d\u7f6e\u6587\u4ef6 /usr/man \u6267\u884cman\u547d\u4ee4\u663e\u793a\u7684\u5e2e\u52a9\u6587\u6863 /usr/src \u6e90\u4ee3\u7801\uff0c\u4f8b\u5982Linux\u5185\u6838\u6e90\u7801: /usr/src/linux /usr/local \u672c\u673a\u5355\u72ec\u589e\u52a0\u7684\u547d\u4ee4\u3001\u52a8\u6001\u94fe\u63a5\u5e93 /root root\u7528\u6237\u7684\u7528\u6237\u6587\u4ef6\u5939\u88ab\u5355\u72ec\u62ff\u51fa\u6765\u653e\u5230root\u76ee\u5f55\u91cc\uff0c\u4e0d\u5728usr\u76ee\u5f55\u91cc /opt \u53ef\u9009\u5e94\u7528\u7a0b\u5e8f\u7684\u5b89\u88c5\u76ee\u5f55 /dev \u5b58\u653e\u8bbe\u5907\u6587\u4ef6\uff08\u5206\u5b57\u7b26\u8bbe\u5907\u548c\u5757\u8bbe\u5907\uff09 /boot \u7cfb\u7edf\u5f15\u5bfc /lib \u5b58\u653e\u8ddf\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u7a0b\u5e8f\u8fd0\u884c\u6240\u9700\u8981\u7684\u5171\u4eab\u5e93\u53ca\u5185\u6838\u6a21\u5757\u3002\u5171\u4eab\u5e93\u53c8\u53eb\u52a8\u6001\u94fe\u63a5\u5171\u4eab\u5e93\uff0c\u4f5c\u7528\u7c7b\u4f3cwindows\u91cc\u7684.dll\u6587\u4ef6\uff0c\u5b58\u653e\u4e86\u6839\u6587\u4ef6\u7cfb\u7edf\u7a0b\u5e8f\u8fd0\u884c\u6240\u9700\u7684\u5171\u4eab\u6587\u4ef6 /tmp \u4e34\u65f6\u6587\u4ef6\u5939 /var \u65e5\u5fd7 /lost+found \u610f\u5916\u4e22\u5931\u7684\u6587\u4ef6 /proc \u865a\u5047\u7684\u76ee\u5f55\uff0c\u78c1\u76d8\u4e2d\u5e76\u4e0d\u5b58\u5728\uff0c\u5176\u4e2d\u7684\u5185\u5bb9\u662f\u7cfb\u7edf\u6620\u5c04\u51fa\u6765\u7684\u5185\u5b58\u4e2d\u7684\u4fe1\u606f\u3002 \u4e09\u3001Linux \u7cfb\u7edf\u91cd\u8981\u6587\u4ef6\u5939\u4e0e\u6587\u4ef6\u7684\u5185\u5bb9 \u00b6 1\u3001 /etc/passwd \u4fdd\u5b58\u4e86\u7528\u6237\u6570\u636e\u5e93\uff0c\u5176\u4e2d\u5305\u62ec\u7528\u6237\u540d\u3001\u52a0\u5bc6\u8fc7\u7684\u5bc6\u7801\u7b49 2\u3001/etc/group \u4fdd\u5b58\u4e86\u7528\u6237\u7ec4\u7684\u4fe1\u606f 3\u3001/etc/issue \u9ed8\u8ba4\u662f\u53d1\u884c\u7248\u4fe1\u606f\uff0c\u5b9e\u9645\u4e0a\uff0c\u6587\u4ef6\u91cc\u7684\u5185\u5bb9\u7528\u6765\u663e\u793a\u5728\u6bcf\u6b21\u767b\u5f55\u7cfb\u7edf\u540e\u7ec8\u7aef\u663e\u793a\u7684\u6b22\u8fce\u6587\u5b57 4\u3001/var/log \u4fdd\u5b58\u4e86\u8bb8\u591a\u7a0b\u5e8f\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4f8b\u5982\u767b\u5f55\u65e5\u5fd7 \u56db\u3001Linux \u6587\u4ef6\u7684\u5c5e\u6027\uff08File Attribute\uff09 \u00b6 \u67e5\u770b\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u7684\u6743\u9650 \u00b6 \u4f7f\u7528 ls -l filename \u547d\u4ee4\u67e5\u770b\u6587\u4ef6\u7684\u6743\u9650\uff0c\u4f8b\u5982\uff1a -rw-r--r-- 1 root root 298 Sep 30 21:31 os-release \u7b2c\u4e00\u4e2a\u5b57\u7b26 - \u4ee3\u8868\u8fd9\u662f\u4e00\u4e2a\u6587\u4ef6\uff0cd\u8868\u793a\u76ee\u5f55\uff08\u5373\u6587\u4ef6\u5939\uff0c\u5728Linux\u5185\uff0c\u6587\u4ef6\u5939\u4e5f\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6587\u4ef6\uff09\uff0cl\u8868\u793a\u94fe\u63a5 \u63a5\u4e0b\u6765\u4e09\u4e2a\u5b57\u7b26rw- \u8868\u793a\u6587\u4ef6\u7684\u6240\u6709\u8005\u5bf9\u8be5\u6587\u4ef6\u53ef\u8bfb\uff08r\uff0cread\uff09\u53ef\u5199\uff08w\uff0cwrite\uff09\u4f46\u4e0d\u53ef\u8fd0\u884c\uff08x\uff09 \u4e4b\u540e\u4e09\u4e2a\u5b57\u7b26r-- \u8868\u793a\u6587\u4ef6\u6240\u6709\u8005\u6240\u5728\u7684\u7528\u6237\u7ec4 \u7684\u5176\u4ed6\u7528\u6237\u4eec \u5bf9\u8be5\u6587\u4ef6\u53ef\u8bfb\uff0c\u4e0d\u53ef\u5199\uff0c\u4e0d\u53ef\u8fd0\u884c \u6700\u540e\u4e09\u4e2ar-- \u8868\u793a\u5176\u4ed6\u7528\u6237\u5bf9\u8be5\u6587\u4ef6\u53ef\u8bfb\uff0c\u4e0d\u53ef\u5199\uff0c\u4e0d\u53ef\u8fd0\u884c \u6570\u5b571\u8868\u793a\u94fe\u63a5\u7684\u6587\u4ef6\u6570\uff08\u4e0el\u7c7b\u578b\u7684\u6587\u4ef6\u6709\u5173\uff09 \u4e4b\u540e\u7684root \u8868\u793a\u4e3a\u6587\u4ef6\u6240\u5c5e\u7684\u7528\u6237 \u7b2c\u4e8c\u4e2aroot \u8868\u793a\u4e3a\u6587\u4ef6\u6240\u5c5e\u7684\u7528\u6237\uff08\u5373root\u7528\u6237\uff09\u6240\u5728\u7684\u7528\u6237\u7ec4\u4e3aroot\u7528\u6237\u7ec4 Sep 30 21:31 \u8868\u793a\u6587\u4ef6\u6700\u540e\u7684\u66f4\u6539\u65e5\u671f os-release \u4e3a\u6587\u4ef6\u540d \u5982\u4f55\u4fee\u6539\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u7684\u6743\u9650\uff1a \u00b6 1\u3001\u4f7f\u7528\u6570\u5b57\u8868\u793a \u4f8b\u5982\uff1arw-r--r--\uff0c\u4ee5\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a110,100,100\uff0c\u5373644 chmod 644 os-release \u4f8b\u5982 rwxrw-r--\uff0c\u4ee5\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a111,110,100\uff0c\u5373764 chmod 764 os-release 2\u3001\u4f7f\u7528\u5b57\u6bcd\u8868\u793a chmod u+x os-release \u8868\u793a\u7ed9\u6587\u4ef6\u6240\u5c5e\u7684\u7528\u6237\uff08u\uff09\u589e\u52a0\uff08+\uff09\u8fd0\u884c\uff08x\uff09\u6743\u9650\uff1b chmod g-wx os-release \u8868\u793a\u7ed9\u6587\u4ef6\u6240\u5c5e\u7528\u6237\u7684\u7528\u6237\u7ec4\uff08g\uff09\u53bb\u9664\uff08-\uff09\u5199\u6743\u9650\uff08w\uff09\u548c\u8fd0\u884c\u6743\u9650\uff08x\uff09 chmod o+wx os-release \u8868\u793a\u7ed9\u6587\u4ef6\u6240\u5c5e\u7528\u6237\u7528\u6237\u7ec4\u4e4b\u5916\u7684\u7528\u6237\uff08o\uff09\u589e\u52a0\uff08+\uff09\u5199\u6743\u9650\uff08w\uff09\u548c\u8fd0\u884c\u6743\u9650\uff08x\uff09 chmod a+r os-release \u8868\u793a\u7ed9\u6240\u6709\u7528\u6237\uff08a\uff09\u589e\u52a0\u8bfb\uff08r\uff09\u6743\u9650 3\u3001\u6539\u53d8\u6587\u4ef6\u6240\u6709\u8005 chown\u547d\u4ee4\uff08change owner\uff09 chown user1 os-release \u5c06os-release\u6587\u4ef6\u6240\u6709\u8005\u6539\u4e3auser1 chgrp\u547d\u4ee4\uff08change group\uff09 chgrp basic\u2014user os-release \u5c06os-release\u6587\u4ef6\u6240\u5c5e\u7528\u6237\u7ec4\u6539\u4e3abasic-user \u4e94\u3001\u6587\u4ef6\u7cfb\u7edf\uff08File System\uff09 \u00b6 \u5f53\u524d\u7684Linux \u6b63\u5728\u4f7f\u7528\u4ec0\u4e48\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5728 /etc/fstab \u6587\u4ef6\u4e2d\u67e5\u770b\uff0c\u901a\u5e38\u4e3aext4 Windows \u901a\u5e38\u4e3aNTFS //TODO: \u7b49\u5f85\u5b8c\u6210 \u516d\u3001\u5e38\u89c1\u7684\u7cfb\u7edf\u529f\u80fd \u00b6 1\u3001NTP \u65f6\u95f4\u540c\u6b65 NTP \u670d\u52a1\u4f7f\u7528UDP123 \u7aef\u53e3\u4e0eNTP\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u66f4\u65b0\u7cfb\u7edf\u65f6\u95f4\uff0cntp \u670d\u52a1\u5668\u914d\u7f6e\u4fdd\u5b58\u5728/etc/ntp.conf \u6587\u4ef6\u4e2d 2\u3001Bash \u4e0eWindows \u7684cmd \u7c7b\u4f3c\uff0cLinux \u4f7f\u7528bash \u6765\u8fdb\u884c\u7cfb\u7edf\u4ea4\u4e92\u3002 Shell \u548cTerminal \u6709\u4ec0\u4e48\u533a\u522b\uff1f \u6211\u4eec\u6253\u5f00 Windows \u7684\u90a3\u4e2a\u300c\u5c0f\u9ed1\u6846\u300d\uff08Command Prompt\uff09\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u6253\u5f00\u4e86\u4e00\u4e2a**\u7ec8\u7aef\uff08Terminal\uff09** \u5728\u7ec8\u7aef\u91cc\u9762\u300c\u8f93\u5165\u547d\u4ee4\uff0c\u5f97\u5230\u7ed3\u679c\u300d\u7684\u4ea4\u4e92\u7a0b\u5e8f\uff0c\u5c31\u662f**\u547d\u4ee4\u884c\u89e3\u91ca\u5668\uff08Shell\uff09** \u4e5f\u6b63\u56e0\u5982\u6b64\uff0cWindows \u6700\u65b0\u7684 Shell \u53eb PowerShell\u3002\uff08\u63a7\u5236\u53f0 Console \u5219\u662f\u76f8\u5bf9\u53e4\u8001\u7684\u6982\u5ff5\uff0c\u662f\u5927\u578b\u673a\u7269\u7406\u610f\u4e49\u4e0a\u9762\u7684\u72ec\u7acb\u7ec8\u7aef\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u5148\u4e0d\u63a2\u8ba8\u8fd9\u4e2a\u8bdd\u9898\u3002\uff09\u4f7f\u7528 macOS \u548c Linux \u7684\u540c\u5b66\u5982\u679c\u542c\u8bf4\u8fc7 bash \u548c zsh \u7684\u8bdd\uff0c\u5b83\u4eec\u540c\u6837\u4e5f\u662f Shell\u3002 \u6253\u4e2a\u6bd4\u65b9\uff0cTerminal \u5c31\u50cf\u662f\u4e00\u4e2a\u4eba\u7684\u8863\u670d\uff0c\u53ef\u4ee5\u6709\u5404\u79cd\u989c\u8272\u3001\u5f62\u72b6\u751a\u81f3\u529f\u80fd\uff1b\u90a3\u4e48 Shell \u5219\u662f\u8fd9\u4e2a\u4eba\uff0c\u4f60\u548c\u4ed6\u6c9f\u901a\u6765\u83b7\u5f97\u4fe1\u606f\uff0c\u5e76\u4e14\u4ed6\u53ef\u4ee5\u5728\u4e0e\u4f60\u6c9f\u901a\u7684\u8fc7\u7a0b\u4e2d\u4e8b\u5148\u544a\u8bc9\u4f60\u8bb8\u591a\u4fe1\u606f\u3001\u63d0\u9192\uff0c\u751a\u81f3\u81ea\u52a8\u5e2e\u4f60\u8865\u5145\u4f60\u60f3\u8bf4\u7684\u8bdd\u3002 Terminal \u548c Shell \u7684\u533a\u522b\u548c\u8054\u7cfb \u6765\u6e90\uff1a https://sspai.com/post/52868 //TODO: \u6dfb\u52a0\u65b0\u5185\u5bb9 \u53c2\u8003\uff1a 1\u3001 https://linux.cn/article-9586-1.html \u67e5\u770bLinux\u53d1\u884c\u7248\u540d\u79f0\u4e0e\u7248\u672c\u53f7\u76848\u79cd\u65b9\u6cd5 2\u3001 https://www.cnblogs.com/zhuchenglin/p/8686924.html Linux \u5404\u4e2a\u76ee\u5f55\u7684\u8be6\u7ec6\u4ecb\u7ecd 3\u3001 https://www.cnblogs.com/123-/p/4189072.html Linux\u4e0b\u7528\u6237\u7ec4\u3001\u6587\u4ef6\u6743\u9650\u8be6\u89e3","title":"Linux Basic Analysis"},{"location":"Linux1/#linux-basic-analysis","text":"\u6587\u6863\u4fa7\u91cd\u4e8e\u4ee5\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u4e3a\u76ee\u7684\u7684Linux \u7cfb\u7edf\u89e3\u6790\uff0c\u4e3b\u8981\u5305\u542bLinux \u6587\u4ef6\u7cfb\u7edf\u76ee\u5f55\u3001\u7279\u6b8a\u7684\u7cfb\u7edf\u6587\u4ef6\u3001\u5e38\u7528\u8f6f\u4ef6\u7684\u76ee\u5f55\u3001\u6587\u4ef6\u4e0e\u529f\u80fd\u7b49\uff0c\u53ef\u80fd\u4e0d\u4f1a\u4ecb\u7ecdLinux \u5f00\u53d1\u7684\u76f8\u5173\u5185\u5bb9\u3002","title":"Linux Basic Analysis"},{"location":"Linux1/#linux","text":"DebianOS\uff0c\u4ee5\u53ca\u5176\u884d\u751f\u7248\u672c\uff1aUbuntu\u3001LinuxMint\u3001Deepin\u3001Kali Linux Redhat\uff0c\u4ee5\u53ca\u5176\u884d\u751f\u7248\u672c\uff1aCentOS\u3001Fedora \u5176\u4ed6\uff1aArchlinux \u7b49 \u67e5\u770b\u5f53\u524d\u7684Linux \u53d1\u884c\u7248\u7248\u672c\uff1a lsb_release \uff1a lsb_release -a uname \uff1a uname -a \u67e5\u627e\\etc \u4e2d\u7684\u6587\u4ef6\uff1a \u5bf9\u4e8eDebian \u53ca\u5176\u884d\u751f\u7248\uff1a cat \\etc\\issue cat \\etc\\issue.net cat \\etc\\lsb-release cat \\etc\\os-release \u5bf9\u4e8eCentOS\uff1a cat \\etc\\centos-release \u5bf9\u4e8eFedora\uff1a cat \\etc\\fedora-release","title":"\u4e00\u3001\u5e38\u89c1\u7684Linux \u53d1\u884c\u7248"},{"location":"Linux1/#linux-dir-structure","text":"\u76ee\u5f55 \u8bf4\u660e / \u6839\u76ee\u5f55\uff0c\u6839\u76ee\u5f55\u4e0b\u4e00\u822c\u53ea\u6709\u4ee5\u4e0b\u6587\u4ef6\u5939\uff0c\u6ca1\u6709\u6587\u4ef6| /bin \u5b58\u653e\u4e86\u7cfb\u7edf\u547d\u4ee4\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4f8b\u5982cat\u3001vi\uff0c\u76f8\u5f53\u4e8eWindows \u7684\u7cfb\u7edf\u73af\u5883\u53d8\u91cfPATH /etc \u5b58\u653e\u4e86\u7cfb\u7edf\u914d\u7f6e\uff0c\u4f8b\u5982release /home \u7528\u6237\u6587\u4ef6\u5939\uff0c\u4f8b\u5982/home/user1 \uff0c/home/user2 /usr \u5b58\u653e\u4e86\u7528\u6237\u5e94\u7528\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3001\u4ee3\u7801\u3001\u52a8\u6001\u94fe\u63a5\u5e93\u7b49\uff0c\u76f8\u5f53\u4e8eWindows \u7684\u7528\u6237\u73af\u5883\u53d8\u91cfPATH /usr/bin \u7528\u6237\u5b89\u88c5\u7684\u5e94\u7528\u7684\u53ef\u6267\u884c\u6587\u4ef6 /usr/doc Linux \u6587\u6863 /usr/include \u5934\u6587\u4ef6\u76ee\u5f55 /usr/lib \u5b58\u653e\u52a8\u6001\u94fe\u63a5\u5e93\u3001\u8f6f\u4ef6\u5305\u914d\u7f6e\u6587\u4ef6 /usr/man \u6267\u884cman\u547d\u4ee4\u663e\u793a\u7684\u5e2e\u52a9\u6587\u6863 /usr/src \u6e90\u4ee3\u7801\uff0c\u4f8b\u5982Linux\u5185\u6838\u6e90\u7801: /usr/src/linux /usr/local \u672c\u673a\u5355\u72ec\u589e\u52a0\u7684\u547d\u4ee4\u3001\u52a8\u6001\u94fe\u63a5\u5e93 /root root\u7528\u6237\u7684\u7528\u6237\u6587\u4ef6\u5939\u88ab\u5355\u72ec\u62ff\u51fa\u6765\u653e\u5230root\u76ee\u5f55\u91cc\uff0c\u4e0d\u5728usr\u76ee\u5f55\u91cc /opt \u53ef\u9009\u5e94\u7528\u7a0b\u5e8f\u7684\u5b89\u88c5\u76ee\u5f55 /dev \u5b58\u653e\u8bbe\u5907\u6587\u4ef6\uff08\u5206\u5b57\u7b26\u8bbe\u5907\u548c\u5757\u8bbe\u5907\uff09 /boot \u7cfb\u7edf\u5f15\u5bfc /lib \u5b58\u653e\u8ddf\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u7a0b\u5e8f\u8fd0\u884c\u6240\u9700\u8981\u7684\u5171\u4eab\u5e93\u53ca\u5185\u6838\u6a21\u5757\u3002\u5171\u4eab\u5e93\u53c8\u53eb\u52a8\u6001\u94fe\u63a5\u5171\u4eab\u5e93\uff0c\u4f5c\u7528\u7c7b\u4f3cwindows\u91cc\u7684.dll\u6587\u4ef6\uff0c\u5b58\u653e\u4e86\u6839\u6587\u4ef6\u7cfb\u7edf\u7a0b\u5e8f\u8fd0\u884c\u6240\u9700\u7684\u5171\u4eab\u6587\u4ef6 /tmp \u4e34\u65f6\u6587\u4ef6\u5939 /var \u65e5\u5fd7 /lost+found \u610f\u5916\u4e22\u5931\u7684\u6587\u4ef6 /proc \u865a\u5047\u7684\u76ee\u5f55\uff0c\u78c1\u76d8\u4e2d\u5e76\u4e0d\u5b58\u5728\uff0c\u5176\u4e2d\u7684\u5185\u5bb9\u662f\u7cfb\u7edf\u6620\u5c04\u51fa\u6765\u7684\u5185\u5b58\u4e2d\u7684\u4fe1\u606f\u3002","title":"\u4e8c\u3001Linux \u7cfb\u7edf\u7684\u5178\u578b\u76ee\u5f55\u7ed3\u6784\uff08Dir Structure\uff09"},{"location":"Linux1/#linux_1","text":"1\u3001 /etc/passwd \u4fdd\u5b58\u4e86\u7528\u6237\u6570\u636e\u5e93\uff0c\u5176\u4e2d\u5305\u62ec\u7528\u6237\u540d\u3001\u52a0\u5bc6\u8fc7\u7684\u5bc6\u7801\u7b49 2\u3001/etc/group \u4fdd\u5b58\u4e86\u7528\u6237\u7ec4\u7684\u4fe1\u606f 3\u3001/etc/issue \u9ed8\u8ba4\u662f\u53d1\u884c\u7248\u4fe1\u606f\uff0c\u5b9e\u9645\u4e0a\uff0c\u6587\u4ef6\u91cc\u7684\u5185\u5bb9\u7528\u6765\u663e\u793a\u5728\u6bcf\u6b21\u767b\u5f55\u7cfb\u7edf\u540e\u7ec8\u7aef\u663e\u793a\u7684\u6b22\u8fce\u6587\u5b57 4\u3001/var/log \u4fdd\u5b58\u4e86\u8bb8\u591a\u7a0b\u5e8f\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4f8b\u5982\u767b\u5f55\u65e5\u5fd7","title":"\u4e09\u3001Linux \u7cfb\u7edf\u91cd\u8981\u6587\u4ef6\u5939\u4e0e\u6587\u4ef6\u7684\u5185\u5bb9"},{"location":"Linux1/#linux-file-attribute","text":"","title":"\u56db\u3001Linux \u6587\u4ef6\u7684\u5c5e\u6027\uff08File Attribute\uff09"},{"location":"Linux1/#_1","text":"\u4f7f\u7528 ls -l filename \u547d\u4ee4\u67e5\u770b\u6587\u4ef6\u7684\u6743\u9650\uff0c\u4f8b\u5982\uff1a -rw-r--r-- 1 root root 298 Sep 30 21:31 os-release \u7b2c\u4e00\u4e2a\u5b57\u7b26 - \u4ee3\u8868\u8fd9\u662f\u4e00\u4e2a\u6587\u4ef6\uff0cd\u8868\u793a\u76ee\u5f55\uff08\u5373\u6587\u4ef6\u5939\uff0c\u5728Linux\u5185\uff0c\u6587\u4ef6\u5939\u4e5f\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6587\u4ef6\uff09\uff0cl\u8868\u793a\u94fe\u63a5 \u63a5\u4e0b\u6765\u4e09\u4e2a\u5b57\u7b26rw- \u8868\u793a\u6587\u4ef6\u7684\u6240\u6709\u8005\u5bf9\u8be5\u6587\u4ef6\u53ef\u8bfb\uff08r\uff0cread\uff09\u53ef\u5199\uff08w\uff0cwrite\uff09\u4f46\u4e0d\u53ef\u8fd0\u884c\uff08x\uff09 \u4e4b\u540e\u4e09\u4e2a\u5b57\u7b26r-- \u8868\u793a\u6587\u4ef6\u6240\u6709\u8005\u6240\u5728\u7684\u7528\u6237\u7ec4 \u7684\u5176\u4ed6\u7528\u6237\u4eec \u5bf9\u8be5\u6587\u4ef6\u53ef\u8bfb\uff0c\u4e0d\u53ef\u5199\uff0c\u4e0d\u53ef\u8fd0\u884c \u6700\u540e\u4e09\u4e2ar-- \u8868\u793a\u5176\u4ed6\u7528\u6237\u5bf9\u8be5\u6587\u4ef6\u53ef\u8bfb\uff0c\u4e0d\u53ef\u5199\uff0c\u4e0d\u53ef\u8fd0\u884c \u6570\u5b571\u8868\u793a\u94fe\u63a5\u7684\u6587\u4ef6\u6570\uff08\u4e0el\u7c7b\u578b\u7684\u6587\u4ef6\u6709\u5173\uff09 \u4e4b\u540e\u7684root \u8868\u793a\u4e3a\u6587\u4ef6\u6240\u5c5e\u7684\u7528\u6237 \u7b2c\u4e8c\u4e2aroot \u8868\u793a\u4e3a\u6587\u4ef6\u6240\u5c5e\u7684\u7528\u6237\uff08\u5373root\u7528\u6237\uff09\u6240\u5728\u7684\u7528\u6237\u7ec4\u4e3aroot\u7528\u6237\u7ec4 Sep 30 21:31 \u8868\u793a\u6587\u4ef6\u6700\u540e\u7684\u66f4\u6539\u65e5\u671f os-release \u4e3a\u6587\u4ef6\u540d","title":"\u67e5\u770b\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u7684\u6743\u9650"},{"location":"Linux1/#_2","text":"1\u3001\u4f7f\u7528\u6570\u5b57\u8868\u793a \u4f8b\u5982\uff1arw-r--r--\uff0c\u4ee5\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a110,100,100\uff0c\u5373644 chmod 644 os-release \u4f8b\u5982 rwxrw-r--\uff0c\u4ee5\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a111,110,100\uff0c\u5373764 chmod 764 os-release 2\u3001\u4f7f\u7528\u5b57\u6bcd\u8868\u793a chmod u+x os-release \u8868\u793a\u7ed9\u6587\u4ef6\u6240\u5c5e\u7684\u7528\u6237\uff08u\uff09\u589e\u52a0\uff08+\uff09\u8fd0\u884c\uff08x\uff09\u6743\u9650\uff1b chmod g-wx os-release \u8868\u793a\u7ed9\u6587\u4ef6\u6240\u5c5e\u7528\u6237\u7684\u7528\u6237\u7ec4\uff08g\uff09\u53bb\u9664\uff08-\uff09\u5199\u6743\u9650\uff08w\uff09\u548c\u8fd0\u884c\u6743\u9650\uff08x\uff09 chmod o+wx os-release \u8868\u793a\u7ed9\u6587\u4ef6\u6240\u5c5e\u7528\u6237\u7528\u6237\u7ec4\u4e4b\u5916\u7684\u7528\u6237\uff08o\uff09\u589e\u52a0\uff08+\uff09\u5199\u6743\u9650\uff08w\uff09\u548c\u8fd0\u884c\u6743\u9650\uff08x\uff09 chmod a+r os-release \u8868\u793a\u7ed9\u6240\u6709\u7528\u6237\uff08a\uff09\u589e\u52a0\u8bfb\uff08r\uff09\u6743\u9650 3\u3001\u6539\u53d8\u6587\u4ef6\u6240\u6709\u8005 chown\u547d\u4ee4\uff08change owner\uff09 chown user1 os-release \u5c06os-release\u6587\u4ef6\u6240\u6709\u8005\u6539\u4e3auser1 chgrp\u547d\u4ee4\uff08change group\uff09 chgrp basic\u2014user os-release \u5c06os-release\u6587\u4ef6\u6240\u5c5e\u7528\u6237\u7ec4\u6539\u4e3abasic-user","title":"\u5982\u4f55\u4fee\u6539\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u7684\u6743\u9650\uff1a"},{"location":"Linux1/#file-system","text":"\u5f53\u524d\u7684Linux \u6b63\u5728\u4f7f\u7528\u4ec0\u4e48\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5728 /etc/fstab \u6587\u4ef6\u4e2d\u67e5\u770b\uff0c\u901a\u5e38\u4e3aext4 Windows \u901a\u5e38\u4e3aNTFS //TODO: \u7b49\u5f85\u5b8c\u6210","title":"\u4e94\u3001\u6587\u4ef6\u7cfb\u7edf\uff08File System\uff09"},{"location":"Linux1/#_3","text":"1\u3001NTP \u65f6\u95f4\u540c\u6b65 NTP \u670d\u52a1\u4f7f\u7528UDP123 \u7aef\u53e3\u4e0eNTP\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u66f4\u65b0\u7cfb\u7edf\u65f6\u95f4\uff0cntp \u670d\u52a1\u5668\u914d\u7f6e\u4fdd\u5b58\u5728/etc/ntp.conf \u6587\u4ef6\u4e2d 2\u3001Bash \u4e0eWindows \u7684cmd \u7c7b\u4f3c\uff0cLinux \u4f7f\u7528bash \u6765\u8fdb\u884c\u7cfb\u7edf\u4ea4\u4e92\u3002 Shell \u548cTerminal \u6709\u4ec0\u4e48\u533a\u522b\uff1f \u6211\u4eec\u6253\u5f00 Windows \u7684\u90a3\u4e2a\u300c\u5c0f\u9ed1\u6846\u300d\uff08Command Prompt\uff09\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u6253\u5f00\u4e86\u4e00\u4e2a**\u7ec8\u7aef\uff08Terminal\uff09** \u5728\u7ec8\u7aef\u91cc\u9762\u300c\u8f93\u5165\u547d\u4ee4\uff0c\u5f97\u5230\u7ed3\u679c\u300d\u7684\u4ea4\u4e92\u7a0b\u5e8f\uff0c\u5c31\u662f**\u547d\u4ee4\u884c\u89e3\u91ca\u5668\uff08Shell\uff09** \u4e5f\u6b63\u56e0\u5982\u6b64\uff0cWindows \u6700\u65b0\u7684 Shell \u53eb PowerShell\u3002\uff08\u63a7\u5236\u53f0 Console \u5219\u662f\u76f8\u5bf9\u53e4\u8001\u7684\u6982\u5ff5\uff0c\u662f\u5927\u578b\u673a\u7269\u7406\u610f\u4e49\u4e0a\u9762\u7684\u72ec\u7acb\u7ec8\u7aef\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u5148\u4e0d\u63a2\u8ba8\u8fd9\u4e2a\u8bdd\u9898\u3002\uff09\u4f7f\u7528 macOS \u548c Linux \u7684\u540c\u5b66\u5982\u679c\u542c\u8bf4\u8fc7 bash \u548c zsh \u7684\u8bdd\uff0c\u5b83\u4eec\u540c\u6837\u4e5f\u662f Shell\u3002 \u6253\u4e2a\u6bd4\u65b9\uff0cTerminal \u5c31\u50cf\u662f\u4e00\u4e2a\u4eba\u7684\u8863\u670d\uff0c\u53ef\u4ee5\u6709\u5404\u79cd\u989c\u8272\u3001\u5f62\u72b6\u751a\u81f3\u529f\u80fd\uff1b\u90a3\u4e48 Shell \u5219\u662f\u8fd9\u4e2a\u4eba\uff0c\u4f60\u548c\u4ed6\u6c9f\u901a\u6765\u83b7\u5f97\u4fe1\u606f\uff0c\u5e76\u4e14\u4ed6\u53ef\u4ee5\u5728\u4e0e\u4f60\u6c9f\u901a\u7684\u8fc7\u7a0b\u4e2d\u4e8b\u5148\u544a\u8bc9\u4f60\u8bb8\u591a\u4fe1\u606f\u3001\u63d0\u9192\uff0c\u751a\u81f3\u81ea\u52a8\u5e2e\u4f60\u8865\u5145\u4f60\u60f3\u8bf4\u7684\u8bdd\u3002 Terminal \u548c Shell \u7684\u533a\u522b\u548c\u8054\u7cfb \u6765\u6e90\uff1a https://sspai.com/post/52868 //TODO: \u6dfb\u52a0\u65b0\u5185\u5bb9 \u53c2\u8003\uff1a 1\u3001 https://linux.cn/article-9586-1.html \u67e5\u770bLinux\u53d1\u884c\u7248\u540d\u79f0\u4e0e\u7248\u672c\u53f7\u76848\u79cd\u65b9\u6cd5 2\u3001 https://www.cnblogs.com/zhuchenglin/p/8686924.html Linux \u5404\u4e2a\u76ee\u5f55\u7684\u8be6\u7ec6\u4ecb\u7ecd 3\u3001 https://www.cnblogs.com/123-/p/4189072.html Linux\u4e0b\u7528\u6237\u7ec4\u3001\u6587\u4ef6\u6743\u9650\u8be6\u89e3","title":"\u516d\u3001\u5e38\u89c1\u7684\u7cfb\u7edf\u529f\u80fd"},{"location":"law/","text":"Laws and Regulations \u00b6 \uff08\u867d\u7136\u662f\u8001\u751f\u5e38\u8c08\u4f46\u8fd8\u662f\u5e94\u8be5\u8bf4\u4e00\u4e0b\uff09 \u4ece\u4e8b\u4fe1\u606f\u5b89\u5168\u76f8\u5173\u884c\u4e1a\u79bb\u4e0d\u5f00\u5b8c\u5907\u7684\u6cd5\u5f8b\u6cd5\u89c4\u610f\u8bc6\uff0c\u628a\u63e1\u5e95\u7ebf\uff1a\u6388\u6743\u6d4b\u8bd5\uff0c\u62d2\u7edd\u9ed1\u4ea7\u3002 \u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\u79d1\u666e \u00b6 \u516c\u5b89\u90e8\u300a\u516c\u5b89\u673a\u5173\u529e\u7406\u5211\u4e8b\u6848\u4ef6\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u89c4\u5219\u300b\uff082019\uff09 \u300a\u4e2d\u534e\u4eba\u6c11\u5171\u548c\u56fd\u7535\u5b50\u7b7e\u540d\u6cd5\u300b \u300a\u6700\u9ad8\u4eba\u6c11\u6cd5\u9662\u5173\u4e8e\u4e92\u8054\u7f51\u6cd5\u9662\u5ba1\u7406\u6848\u4ef6\u82e5\u5e72\u95ee\u9898\u7684\u89c4\u5b9a\u300b \u76f8\u5173\u6307\u5bfc\u4e66\u7c4d \u00b6 \u300a\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u300b","title":"Laws and Regulations"},{"location":"law/#laws-and-regulations","text":"\uff08\u867d\u7136\u662f\u8001\u751f\u5e38\u8c08\u4f46\u8fd8\u662f\u5e94\u8be5\u8bf4\u4e00\u4e0b\uff09 \u4ece\u4e8b\u4fe1\u606f\u5b89\u5168\u76f8\u5173\u884c\u4e1a\u79bb\u4e0d\u5f00\u5b8c\u5907\u7684\u6cd5\u5f8b\u6cd5\u89c4\u610f\u8bc6\uff0c\u628a\u63e1\u5e95\u7ebf\uff1a\u6388\u6743\u6d4b\u8bd5\uff0c\u62d2\u7edd\u9ed1\u4ea7\u3002","title":"Laws and Regulations"},{"location":"law/#_1","text":"\u516c\u5b89\u90e8\u300a\u516c\u5b89\u673a\u5173\u529e\u7406\u5211\u4e8b\u6848\u4ef6\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u89c4\u5219\u300b\uff082019\uff09 \u300a\u4e2d\u534e\u4eba\u6c11\u5171\u548c\u56fd\u7535\u5b50\u7b7e\u540d\u6cd5\u300b \u300a\u6700\u9ad8\u4eba\u6c11\u6cd5\u9662\u5173\u4e8e\u4e92\u8054\u7f51\u6cd5\u9662\u5ba1\u7406\u6848\u4ef6\u82e5\u5e72\u95ee\u9898\u7684\u89c4\u5b9a\u300b","title":"\u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\u79d1\u666e"},{"location":"law/#_2","text":"\u300a\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u300b","title":"\u76f8\u5173\u6307\u5bfc\u4e66\u7c4d"},{"location":"linux2/","text":"Linux Program Analysis \u00b6 \u4e00\u3001Linux \u4e0b\u7684Docker \u5bb9\u5668 \u00b6 \u6211\u4eec\u53ef\u4ee5\u628aDocker \u5f53\u4f5c\u591a\u529f\u80fd\u6c99\u76d2\uff0c\u53ef\u4ee5\u5c06\u9700\u8981\u7684\u8f6f\u4ef6\u653e\u5728\u4e00\u4e2a\u5bb9\u5668\u5185\u8fd0\u884c\uff0c\u800c\u4e0d\u5e72\u6270\u5bb9\u5668\u5916\u7684\u7cfb\u7edf\u3002\u4f8b\u5982\uff0c\u5728\u4e24\u4e2a\u4e2a\u5bb9\u5668\u5185\u5206\u522b\u8fd0\u884cnginx\u670d\u52a1\u5668\uff0c\u5bb9\u5668\u4e00\u5bf9\u5916\u5f00\u653e\u7aef\u53e310801\uff0c\u5bb9\u5668\u4e8c\u5bf9\u5916\u5f00\u653e\u7aef\u53e310802\uff0c\u8fd9\u6837\uff0c\u5728\u540c\u4e00\u53f0\u4e3b\u673a\u5185\uff0c\u4e24\u4e2aweb\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u540c\u65f6\u4e92\u4e0d\u5e72\u6270\u5730\u8fd0\u884c\u3002 \u4f7f\u7528Docker \u65f6\uff0c\u4e3b\u8981\u533a\u5206\u4ee5\u4e0b\u4e24\u4e2a\u6982\u5ff5\uff1a \u00b6 1\u3001Docker\u955c\u50cf image 2\u3001\u5bb9\u5668 Container \u6211\u4eec\u53ef\u4ee5\u5728Docker Hub\u4e0a\u4e0b\u8f7d\u5404\u79cdimages\uff0c\u4f8b\u5982nginx\uff0cmysql\uff0cubuntu\u7b49\uff0c\u4e5f\u53ef\u4ee5\u5c06\u81ea\u5df1\u7684\u8f6f\u4ef6\u8fd0\u884c\u73af\u5883\u6253\u5305\u6210\u4e00\u4e2aimage \u4f7f\u7528image\u6765\u65b0\u5efa\u4e00\u4e2acontainer Docker \u5165\u95e8 \u00b6 \u4f8b\u5982\uff1a \u67e5\u9605Docker Hub\u5185\u7684 \u5b98\u65b9MySQL \u6587\u6863 \uff0c\u9996\u5148\u4e0b\u8f7dMySQL\u955c\u50cf docker pull mysql \u5982\u679c\u8981\u6307\u5b9a\u67d0\u4e2a\u7248\u672c\u7684MySQL\uff0c\u5728mysql\u540e\u52a0\u5192\u53f7\u6307\u5b9a\u7248\u672c\uff0c\u4f8b\u5982\uff1a docker pull mysql:8.0.10 \u4e0d\u6307\u5b9a\u7248\u672c\u5219\u9ed8\u8ba4\u4e3alatest\uff08\u6700\u65b0\u7248\uff09 \u7b49\u5f85\u4e0b\u8f7d\u5b8c\u6210\uff0c\u4e0b\u8f7d\u5b8c\u6210\u540e\u67e5\u770b\u76ee\u524d\u5df2\u7ecf\u4e0b\u8f7d\u597d\u7684images\uff1a docker images \u786e\u8ba4\u955c\u50cf\u5df2\u7ecf\u4e0b\u8f7d\u6210\u529f\uff0c\u63a5\u4e0b\u6765\u4f7f\u7528\u8fd9\u4e2a\u955c\u50cf\u65b0\u5efa\u4e00\u4e2a\u5bb9\u5668\uff1a docker run --name first_mysql_container -p 23306:3306 -e MYSQL_ROOT_PASSWORD=yourpassword -d mysql \u5176\u4e2d\u7684\u547d\u4ee4\u548c\u53c2\u6570\u5206\u522b\u4e3a\uff1a run\uff1adocker\u64cd\u4f5c\uff0c\u7528\u6765\u65b0\u5efa\u5bb9\u5668\uff1b --name first_mysql_container\uff1a\u7ed9\u5bb9\u5668\u547d\u540d\uff0c\u53ef\u9009\uff1b -p 23306:3306\uff1a\u7aef\u53e3\u6620\u5c04\uff0c\u5c06\u5bb9\u5668\u5185\u76843306\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a\u768423306\u7aef\u53e3 -e MYSQL_ROOT_PASSWORD=yourpassword\uff1a\u8bbe\u7f6eMySQL root\u5bc6\u7801 -d \uff1a\u5bb9\u5668\u521b\u5efa\u540e\u5c06\u4f1a\u5728\u540e\u53f0\u8fd0\u884c\uff0c\u547d\u4ee4\u6267\u884c\u540e\u8fd4\u56de\u4e00\u4e2acontainer id mysql\uff1a\u4f7f\u7528mysql\u955c\u50cf\uff0c\u5982\u679c\u8981\u6307\u5b9a\u7248\u672c\uff0c\u5219\u5199\u4e3a mysql:tag \u4f7f\u7528\u547d\u4ee4 docker ps \u6765\u67e5\u770b\u5df2\u7ecf\u521b\u5efa\u7684\u5bb9\u5668\uff0cDocker\u4f1a\u663e\u793a\u4ee5\u4e0b\u8be6\u60c5\uff1a CONTAINER ID \uff1a\u552f\u4e00\u7684\u5bb9\u5668id\uff0c\u5bf9\u5e94\u6bcf\u4e00\u4e2a\u5355\u72ec\u7684\u5bb9\u5668 IMAGE\uff1a\u8fd9\u4e2a\u5bb9\u5668\u662f\u4f7f\u7528\u4ec0\u4e48\u955c\u50cf\u521b\u5efa\u7684 COMMAND CREATED\uff1a \u5bb9\u5668\u521b\u5efa\u7684\u65f6\u95f4 STATUS\uff1a\u5bb9\u5668\u5df2\u7ecf\u8fd0\u884c\u4e86\u6216\u8005\u505c\u6b62\u4e86\u591a\u957f\u65f6\u95f4 PORTS\uff1a\u7aef\u53e3\u6620\u5c04\u60c5\u51b5 NAMES\uff1a\u5bb9\u5668\u7684\u540d\u5b57 \u521b\u5efa\u597d\u5bb9\u5668\u4e4b\u540e\uff0c\u8fdb\u5165\u5bb9\u5668\uff0c\u4eb2\u624b\u64cd\u4f5cmysql\uff1a docker exec -it first_mysql_container bash exec\uff1adocker\u547d\u4ee4\uff0c\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u4e2d\u6267\u884c\u547d\u4ee4 -it\uff1a\u6211\u4e00\u822c\u90fd\u52a0\u4e0a\u8fd9\u4e24\u4e2a\u53c2\u6570 first_mysql_container\uff1a\u5bb9\u5668\u540d\u5b57\uff0c\u6b64\u5904\u586b\u5bb9\u5668ID\u4ea6\u53ef bash\uff1a\u5728\u8fd9\u4e2a\u5bb9\u5668\u5185\u8fd0\u884cbash \u4e4b\u540e\u8f93\u5165 mysql -u root -p \u5373\u53ef\u4f7f\u7528MySQL Docker \u7684\u914d\u7f6e\u76ee\u5f55\u4e0e\u6587\u4ef6\u5206\u6790 \u00b6 1\u3001\u5982\u679c\u7cfb\u7edf\u8fd8\u53ef\u4ee5\u4eff\u771f\u8fd0\u884c\uff0cdocker\u670d\u52a1\u53ef\u4ee5\u542f\u52a8\uff0c\u4f7f\u7528\u4e00\u4e0b\u547d\u4ee4\uff1a docker version \u67e5\u8be2docker client \u548cserver \u7248\u672c\uff0c docker info \u53ef\u4ee5\u8be6\u7ec6\u8c03\u67e5\u6b63\u5728\u8fd0\u884c\u3001\u6682\u505c\u6216\u505c\u6b62\u7684container\u6570\u91cf\uff0c\u662f\u5426\u4f7f\u7528\u4e86docker\u96c6\u7fa4\u9700\u8981\u7684swarm\u7f51\u7edc\u6a21\u5f0f\uff0cdocker\u955c\u50cf\u6e90\u5730\u5740\u7b49 docker sespect ImageID \u67e5\u8be2\u67d0\u4e2a\u955c\u50cf\u7684\u8be6\u7ec6\u4fe1\u606f 2\u3001\u5982\u679c\u7cfb\u7edf\u4e0d\u80fd\u4eff\u771f\uff0c\u6216\u662f\u4eff\u771f\u4e4b\u540e\u65e0\u6cd5\u542f\u52a8docker\u670d\u52a1\uff0c\u5e94\u8be5\u9996\u5148\u8003\u8651\u4fee\u590d\u7cfb\u7edf\u4e22\u5931\u7684\u6587\u4ef6\u6216\u8fdb\u884c\u5408\u7406\u914d\u7f6e\uff0c\u6062\u590ddocker\u670d\u52a1\u3002 3\u3001\u5982\u679c\u53ea\u80fd\u4ece\u786c\u76d8\u5206\u6790\u5165\u624b\uff0c\u5219\u8003\u8651\u4e00\u4e0b\u65b9\u6cd5\uff1a \u8981\u786e\u5b9aDocker Server\u7684\u7248\u672c\uff0c\u53ef\u4ee5\u67e5\u627eapt \u5305\u7ba1\u7406\u7a0b\u5e8f\u7684\u65e5\u5fd7\uff1a/var/log/apt/term.log \u67e5\u770b\u5df2\u7ecf\u4e0b\u8f7d\u4e86\u54ea\u4e9b\u955c\u50cf\uff0c\u68c0\u67e5 /var/lib/docker/image/overlay2/repositories.json \u6587\u4ef6 * \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cdocker image \u4f7f\u7528OverlayFS \u5206\u5c42\u5b58\u50a8\u5728/var/lib/docker/overlay2\uff0c\u4e0d\u597d\u533a\u5206 \u67e5\u770bcontainer\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5728/var/lib/docker/containers\u627e\u5230\u5bf9\u5e94containerID \u7684\u6587\u4ef6\u5939\uff0c\u67e5\u770bconfig.v2.json \u4e2d\u7684\u5185\u5bb9\uff0c\u5176\u4e2d\u5305\u542b\uff1a\u5f53\u524d\u5bb9\u5668\u662f\u5426\u5728\u8fd0\u884c\u3001\u6682\u505c\u6216\u8005\u505c\u6b62\uff0c\u5bb9\u5668\u8fd0\u884c\u7684\u865a\u62df\u4e3b\u673a\u540d\u79f0Hostname\uff0c\u5728\u5bb9\u5668\u5185\u4f7f\u7528\u7684\u7aef\u53e3ExposedPorts\uff0c\u5bb9\u5668\u5185\u7684\u73af\u5883\u53d8\u91cfEnv\uff0c\u5bb9\u5668\u6240\u4f7f\u7528\u7684\u955c\u50cfID\uff0c\u5bb9\u5668\u6620\u5c04\u7684\u7aef\u53e3Network Settings.Ports \u7b49\u7b49 Docker \u7f51\u7edc \u00b6 //TODO: \u7b49\u5f85\u5b8c\u6210 \u4e8c\u3001Firefox \u00b6 \u5bf9\u4e8e\u5b89\u88c5\u4e86Xserver\uff0cgnome\u5957\u4ef6\uff0c\u6216\u8005Xfce \u7b49\u684c\u9762\u7684Linux \u7cfb\u7edf\uff0c\u53ef\u4ee5\u8fd0\u884c\u684c\u9762\u7248\u7684\u56fe\u5f62\u5e94\u7528\u3002 \u53c2\u8003\uff1a 1\u3001 https://www.jianshu.com/p/806485990aea Docker\u6587\u4ef6\u76ee\u5f55 - \u7b80\u4e66 2\u3001 https://hub.docker.com/_/mysql mysql - Docker Hub 3\u3001\u674e\u9e4f\u8d85, \u5468\u51ef. \u57fa\u4e8eDocker\u5bb9\u5668\u7684\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u65b9\u6cd5[J]. \u5409\u6797\u5927\u5b66\u5b66\u62a5(\u7406\u5b66\u7248), 2019, 57(06): 1485-1490. 4\u3001","title":"Linux\u5e94\u7528\u7a0b\u5e8f"},{"location":"linux2/#linux-program-analysis","text":"","title":"Linux Program Analysis"},{"location":"linux2/#linux-docker","text":"\u6211\u4eec\u53ef\u4ee5\u628aDocker \u5f53\u4f5c\u591a\u529f\u80fd\u6c99\u76d2\uff0c\u53ef\u4ee5\u5c06\u9700\u8981\u7684\u8f6f\u4ef6\u653e\u5728\u4e00\u4e2a\u5bb9\u5668\u5185\u8fd0\u884c\uff0c\u800c\u4e0d\u5e72\u6270\u5bb9\u5668\u5916\u7684\u7cfb\u7edf\u3002\u4f8b\u5982\uff0c\u5728\u4e24\u4e2a\u4e2a\u5bb9\u5668\u5185\u5206\u522b\u8fd0\u884cnginx\u670d\u52a1\u5668\uff0c\u5bb9\u5668\u4e00\u5bf9\u5916\u5f00\u653e\u7aef\u53e310801\uff0c\u5bb9\u5668\u4e8c\u5bf9\u5916\u5f00\u653e\u7aef\u53e310802\uff0c\u8fd9\u6837\uff0c\u5728\u540c\u4e00\u53f0\u4e3b\u673a\u5185\uff0c\u4e24\u4e2aweb\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u540c\u65f6\u4e92\u4e0d\u5e72\u6270\u5730\u8fd0\u884c\u3002","title":"\u4e00\u3001Linux \u4e0b\u7684Docker \u5bb9\u5668"},{"location":"linux2/#docker","text":"1\u3001Docker\u955c\u50cf image 2\u3001\u5bb9\u5668 Container \u6211\u4eec\u53ef\u4ee5\u5728Docker Hub\u4e0a\u4e0b\u8f7d\u5404\u79cdimages\uff0c\u4f8b\u5982nginx\uff0cmysql\uff0cubuntu\u7b49\uff0c\u4e5f\u53ef\u4ee5\u5c06\u81ea\u5df1\u7684\u8f6f\u4ef6\u8fd0\u884c\u73af\u5883\u6253\u5305\u6210\u4e00\u4e2aimage \u4f7f\u7528image\u6765\u65b0\u5efa\u4e00\u4e2acontainer","title":"\u4f7f\u7528Docker \u65f6\uff0c\u4e3b\u8981\u533a\u5206\u4ee5\u4e0b\u4e24\u4e2a\u6982\u5ff5\uff1a"},{"location":"linux2/#docker_1","text":"\u4f8b\u5982\uff1a \u67e5\u9605Docker Hub\u5185\u7684 \u5b98\u65b9MySQL \u6587\u6863 \uff0c\u9996\u5148\u4e0b\u8f7dMySQL\u955c\u50cf docker pull mysql \u5982\u679c\u8981\u6307\u5b9a\u67d0\u4e2a\u7248\u672c\u7684MySQL\uff0c\u5728mysql\u540e\u52a0\u5192\u53f7\u6307\u5b9a\u7248\u672c\uff0c\u4f8b\u5982\uff1a docker pull mysql:8.0.10 \u4e0d\u6307\u5b9a\u7248\u672c\u5219\u9ed8\u8ba4\u4e3alatest\uff08\u6700\u65b0\u7248\uff09 \u7b49\u5f85\u4e0b\u8f7d\u5b8c\u6210\uff0c\u4e0b\u8f7d\u5b8c\u6210\u540e\u67e5\u770b\u76ee\u524d\u5df2\u7ecf\u4e0b\u8f7d\u597d\u7684images\uff1a docker images \u786e\u8ba4\u955c\u50cf\u5df2\u7ecf\u4e0b\u8f7d\u6210\u529f\uff0c\u63a5\u4e0b\u6765\u4f7f\u7528\u8fd9\u4e2a\u955c\u50cf\u65b0\u5efa\u4e00\u4e2a\u5bb9\u5668\uff1a docker run --name first_mysql_container -p 23306:3306 -e MYSQL_ROOT_PASSWORD=yourpassword -d mysql \u5176\u4e2d\u7684\u547d\u4ee4\u548c\u53c2\u6570\u5206\u522b\u4e3a\uff1a run\uff1adocker\u64cd\u4f5c\uff0c\u7528\u6765\u65b0\u5efa\u5bb9\u5668\uff1b --name first_mysql_container\uff1a\u7ed9\u5bb9\u5668\u547d\u540d\uff0c\u53ef\u9009\uff1b -p 23306:3306\uff1a\u7aef\u53e3\u6620\u5c04\uff0c\u5c06\u5bb9\u5668\u5185\u76843306\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a\u768423306\u7aef\u53e3 -e MYSQL_ROOT_PASSWORD=yourpassword\uff1a\u8bbe\u7f6eMySQL root\u5bc6\u7801 -d \uff1a\u5bb9\u5668\u521b\u5efa\u540e\u5c06\u4f1a\u5728\u540e\u53f0\u8fd0\u884c\uff0c\u547d\u4ee4\u6267\u884c\u540e\u8fd4\u56de\u4e00\u4e2acontainer id mysql\uff1a\u4f7f\u7528mysql\u955c\u50cf\uff0c\u5982\u679c\u8981\u6307\u5b9a\u7248\u672c\uff0c\u5219\u5199\u4e3a mysql:tag \u4f7f\u7528\u547d\u4ee4 docker ps \u6765\u67e5\u770b\u5df2\u7ecf\u521b\u5efa\u7684\u5bb9\u5668\uff0cDocker\u4f1a\u663e\u793a\u4ee5\u4e0b\u8be6\u60c5\uff1a CONTAINER ID \uff1a\u552f\u4e00\u7684\u5bb9\u5668id\uff0c\u5bf9\u5e94\u6bcf\u4e00\u4e2a\u5355\u72ec\u7684\u5bb9\u5668 IMAGE\uff1a\u8fd9\u4e2a\u5bb9\u5668\u662f\u4f7f\u7528\u4ec0\u4e48\u955c\u50cf\u521b\u5efa\u7684 COMMAND CREATED\uff1a \u5bb9\u5668\u521b\u5efa\u7684\u65f6\u95f4 STATUS\uff1a\u5bb9\u5668\u5df2\u7ecf\u8fd0\u884c\u4e86\u6216\u8005\u505c\u6b62\u4e86\u591a\u957f\u65f6\u95f4 PORTS\uff1a\u7aef\u53e3\u6620\u5c04\u60c5\u51b5 NAMES\uff1a\u5bb9\u5668\u7684\u540d\u5b57 \u521b\u5efa\u597d\u5bb9\u5668\u4e4b\u540e\uff0c\u8fdb\u5165\u5bb9\u5668\uff0c\u4eb2\u624b\u64cd\u4f5cmysql\uff1a docker exec -it first_mysql_container bash exec\uff1adocker\u547d\u4ee4\uff0c\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u4e2d\u6267\u884c\u547d\u4ee4 -it\uff1a\u6211\u4e00\u822c\u90fd\u52a0\u4e0a\u8fd9\u4e24\u4e2a\u53c2\u6570 first_mysql_container\uff1a\u5bb9\u5668\u540d\u5b57\uff0c\u6b64\u5904\u586b\u5bb9\u5668ID\u4ea6\u53ef bash\uff1a\u5728\u8fd9\u4e2a\u5bb9\u5668\u5185\u8fd0\u884cbash \u4e4b\u540e\u8f93\u5165 mysql -u root -p \u5373\u53ef\u4f7f\u7528MySQL","title":"Docker \u5165\u95e8"},{"location":"linux2/#docker_2","text":"1\u3001\u5982\u679c\u7cfb\u7edf\u8fd8\u53ef\u4ee5\u4eff\u771f\u8fd0\u884c\uff0cdocker\u670d\u52a1\u53ef\u4ee5\u542f\u52a8\uff0c\u4f7f\u7528\u4e00\u4e0b\u547d\u4ee4\uff1a docker version \u67e5\u8be2docker client \u548cserver \u7248\u672c\uff0c docker info \u53ef\u4ee5\u8be6\u7ec6\u8c03\u67e5\u6b63\u5728\u8fd0\u884c\u3001\u6682\u505c\u6216\u505c\u6b62\u7684container\u6570\u91cf\uff0c\u662f\u5426\u4f7f\u7528\u4e86docker\u96c6\u7fa4\u9700\u8981\u7684swarm\u7f51\u7edc\u6a21\u5f0f\uff0cdocker\u955c\u50cf\u6e90\u5730\u5740\u7b49 docker sespect ImageID \u67e5\u8be2\u67d0\u4e2a\u955c\u50cf\u7684\u8be6\u7ec6\u4fe1\u606f 2\u3001\u5982\u679c\u7cfb\u7edf\u4e0d\u80fd\u4eff\u771f\uff0c\u6216\u662f\u4eff\u771f\u4e4b\u540e\u65e0\u6cd5\u542f\u52a8docker\u670d\u52a1\uff0c\u5e94\u8be5\u9996\u5148\u8003\u8651\u4fee\u590d\u7cfb\u7edf\u4e22\u5931\u7684\u6587\u4ef6\u6216\u8fdb\u884c\u5408\u7406\u914d\u7f6e\uff0c\u6062\u590ddocker\u670d\u52a1\u3002 3\u3001\u5982\u679c\u53ea\u80fd\u4ece\u786c\u76d8\u5206\u6790\u5165\u624b\uff0c\u5219\u8003\u8651\u4e00\u4e0b\u65b9\u6cd5\uff1a \u8981\u786e\u5b9aDocker Server\u7684\u7248\u672c\uff0c\u53ef\u4ee5\u67e5\u627eapt \u5305\u7ba1\u7406\u7a0b\u5e8f\u7684\u65e5\u5fd7\uff1a/var/log/apt/term.log \u67e5\u770b\u5df2\u7ecf\u4e0b\u8f7d\u4e86\u54ea\u4e9b\u955c\u50cf\uff0c\u68c0\u67e5 /var/lib/docker/image/overlay2/repositories.json \u6587\u4ef6 * \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cdocker image \u4f7f\u7528OverlayFS \u5206\u5c42\u5b58\u50a8\u5728/var/lib/docker/overlay2\uff0c\u4e0d\u597d\u533a\u5206 \u67e5\u770bcontainer\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5728/var/lib/docker/containers\u627e\u5230\u5bf9\u5e94containerID \u7684\u6587\u4ef6\u5939\uff0c\u67e5\u770bconfig.v2.json \u4e2d\u7684\u5185\u5bb9\uff0c\u5176\u4e2d\u5305\u542b\uff1a\u5f53\u524d\u5bb9\u5668\u662f\u5426\u5728\u8fd0\u884c\u3001\u6682\u505c\u6216\u8005\u505c\u6b62\uff0c\u5bb9\u5668\u8fd0\u884c\u7684\u865a\u62df\u4e3b\u673a\u540d\u79f0Hostname\uff0c\u5728\u5bb9\u5668\u5185\u4f7f\u7528\u7684\u7aef\u53e3ExposedPorts\uff0c\u5bb9\u5668\u5185\u7684\u73af\u5883\u53d8\u91cfEnv\uff0c\u5bb9\u5668\u6240\u4f7f\u7528\u7684\u955c\u50cfID\uff0c\u5bb9\u5668\u6620\u5c04\u7684\u7aef\u53e3Network Settings.Ports \u7b49\u7b49","title":"Docker \u7684\u914d\u7f6e\u76ee\u5f55\u4e0e\u6587\u4ef6\u5206\u6790"},{"location":"linux2/#docker_3","text":"//TODO: \u7b49\u5f85\u5b8c\u6210","title":"Docker \u7f51\u7edc"},{"location":"linux2/#firefox","text":"\u5bf9\u4e8e\u5b89\u88c5\u4e86Xserver\uff0cgnome\u5957\u4ef6\uff0c\u6216\u8005Xfce \u7b49\u684c\u9762\u7684Linux \u7cfb\u7edf\uff0c\u53ef\u4ee5\u8fd0\u884c\u684c\u9762\u7248\u7684\u56fe\u5f62\u5e94\u7528\u3002 \u53c2\u8003\uff1a 1\u3001 https://www.jianshu.com/p/806485990aea Docker\u6587\u4ef6\u76ee\u5f55 - \u7b80\u4e66 2\u3001 https://hub.docker.com/_/mysql mysql - Docker Hub 3\u3001\u674e\u9e4f\u8d85, \u5468\u51ef. \u57fa\u4e8eDocker\u5bb9\u5668\u7684\u7535\u5b50\u6570\u636e\u53d6\u8bc1\u65b9\u6cd5[J]. \u5409\u6797\u5927\u5b66\u5b66\u62a5(\u7406\u5b66\u7248), 2019, 57(06): 1485-1490. 4\u3001","title":"\u4e8c\u3001Firefox"},{"location":"linux3/","text":"Linux Server Analysis \u00b6 \u4e00\u3001Mysql \u6570\u636e\u5e93 \u00b6 \u9664\u4e86\u4f7f\u7528\u5bb9\u5668\u8fd0\u884c\u6570\u636e\u5e93\u5916\uff0cMySQL \u8fd8\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5\u5728\u4e3b\u673a\u4e0a\uff0c\u76f4\u63a5\u5728Linux \u6587\u4ef6\u76ee\u5f55\u4e2d\u7559\u4e0b\u75d5\u8ff9\u3002 \u6570\u636e\u5e93\u53d6\u8bc1\u4e00\u822c\u9075\u5faa\u4ee5\u4e0b\u6b65\u9aa4\uff1a 1\u3001\u7cfb\u7edf\u955c\u50cf\u53ef\u4ee5\u4eff\u771f\uff0c\u5e76\u4e14\u80fd\u591f\u76f4\u63a5\u4f7f\u7528MySQL \u8fdb\u884c\u4ea4\u4e92\u7684\uff0c\u8003\u8651\u53bb\u9664root \u7528\u6237\u5bc6\u7801\uff0c\u4f7f\u7528SQL\u8bed\u53e5\u68c0\u67e5\u6574\u4e2a\u6570\u636e\u5e93\u7684\u5185\u5bb9 2\u3001\u7cfb\u7edf\u65e0\u6cd5\u4eff\u771f\u7684\uff0c\u6216\u8005\u4eff\u771f\u4e4b\u540e\u65e0\u6cd5\u8fd0\u884cMySQL \u7684\uff0c\u8003\u8651\u5728\u4e0d\u635f\u574f\u6216\u8005\u5df2\u5907\u4efdMySQL\u76f8\u5173\u76ee\u5f55\u7684\u524d\u63d0\u4e0b\uff0c\u4fee\u590d\u8fd0\u884c\u73af\u5883\uff0c\u8fd0\u884cMySQL 3\u3001\u7cfb\u7edf\u65e0\u6cd5\u4eff\u771f\u6216\u8005MySQL \u6587\u4ef6\u76ee\u5f55\u4e0d\u5b8c\u6574\uff0c\u5355\u72ec\u6392\u67e5MySQL \u914d\u7f6e\u548c\u6570\u636e\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6 \u786e\u5b9aMySQL \u6570\u636e\u6587\u4ef6\u7684\u5b58\u653e\u8def\u5f84\uff1a \u641c\u7d22ibdata1 \u6587\u4ef6\uff1a find / -name ibdata1 \u786e\u5b9aMySQL \u7248\u672c\uff1a\u752816\u8fdb\u5236\u7f16\u8f91\u5668\u6253\u5f00\u4efb\u610f\u4e00\u4e2a.frm \u6587\u4ef6\uff0c\u68c0\u67e50x34 \u548c0x33 \u7684\u4f4d\u7f6e\uff0c\u4f8b\u59820x34 \u4e3a0xC6\uff0c0x33 \u4e3a0x29 \uff0c\u5219MySQL \u7248\u672c\u4e3a0xC629\uff0c\u53735.07.29 \u590d\u5236\u6574\u4e2aMySQL \u6570\u636e\u76ee\u5f55\uff0c\u5220\u9664ib_logfile \u6587\u4ef6\uff0c\u8f6c\u79fb\u5230\u65b0\u5b89\u88c5\u7684MySQL \u73af\u5883\u4e2d\uff0c\u68c0\u7d22\u5176\u4e2d\u7684\u6570\u636e \u8df3\u8fc7root \u5bc6\u7801\uff1a\u5728 /etc/mysql/mysql.conf.d/mysqld.cnf \u6587\u4ef6\u4e2d[mysqld] \u4e0b\u6dfb\u52a0 skip-grant-tables \u91cd\u542fMySQL \u670d\u52a1\uff0c\u4f7f\u7528root \u767b\u5f55 \u4e8c\u3001\u6587\u4ef6\u670d\u52a1\u5668\uff08FTP\uff0cSMB\uff0cNAS\uff09 \u00b6 FTP \u00b6 \u53ef\u4ee5\u5728CentOS \u6216Ubuntu \u4f7f\u7528vsftpd \u914d\u7f6eFTP \u670d\u52a1\u3002FTP\u670d\u52a1\u4f7f\u7528TCP 21\u7aef\u53e3\u9a8c\u8bc1\u8eab\u4efd\u4fe1\u606f\uff0c\u4f7f\u7528TCP 20\u7aef\u53e3\u4f20\u8f93\u6570\u636e\u3002 /etc/vsftpd/vsftpd.conf vsftpd \u7684\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6 /etc/vsftpd/ftpusers \u9ed1\u540d\u5355\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u91cc\u7684\u7528\u6237\u4e0d\u5141\u8bb8\u8bbf\u95ee FTP \u670d\u52a1\u5668 /etc/vsftpd/user_list \u767d\u540d\u5355\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u91cc\u7684\u7528\u6237\u5141\u8bb8\u8bbf\u95ee FTP \u670d\u52a1\u5668 /etc/vsftpd.chroot_list \u5141\u8bb8\u8bbf\u95eeFTP \u670d\u52a1\u5668\u7684\u7528\u6237\u5217\u8868 ** \u914d\u7f6e\u6587\u4ef6\u4e5f\u53ef\u80fd\u76f4\u63a5\u5b58\u653e\u5728/etc \u76ee\u5f55\u4e0b vsftpd.conf \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u76f8\u5173\u8bbe\u7f6e\u6709\uff1a \u914d\u7f6e\u53d8\u91cf \u914d\u7f6e\u8bf4\u660e local_root \u767b\u5f55FTP \u670d\u52a1\u5668\u540e\u6240\u5728\u76ee\u5f55 xferlog_enable Yes: \u542f\u7528\u65e5\u5fd7 pasv_address \u670d\u52a1\u5668\u6240\u5728IP\u5730\u5740 vsftp\u7684\u65e5\u5fd7\u6587\u4ef6\u4fdd\u5b58\u5728 /var/log/vsftpd.log\uff0c\u5176\u4e2d\u5305\u542b\u7684\u4fe1\u606f\u6709\u5c1d\u8bd5\u767b\u5f55\u6b64FTP \u670d\u52a1\u5668\u7684IP\u5730\u5740\u7b49 Samba \u00b6 Samba \u662f\u4f7f\u7528SMB \u534f\u8bae\u7684\u4e00\u6b3e\u8f6f\u4ef6\u3002SMB \u534f\u8bae\u7528\u6765\u5728Linux \u4e0eWindows \u7cfb\u7edf\u4e4b\u95f4\u65e0\u75db\u5171\u4eab\u5b58\u50a8\u4e0e\u6253\u5370\u673a NAS \u00b6 NAS \u901a\u5e38\u7528\u6765\u5c06\u5927\u5bb9\u91cf\u78c1\u76d8\u6302\u8f7d\u5728\u7f51\u7edc\u4e0a\uff0c\u5f62\u6210\u7f51\u7edc\u5b58\u50a8\u3002\u5728\u7535\u5b50\u53d6\u8bc1\u9886\u57df\uff0c\u65f6\u5e38\u9700\u8981\u5206\u6790\u5927\u5bb9\u91cf\u78c1\u76d8\uff0c\u4f46\u5176\u5b9eNAS \u672c\u8eab\u7684\u914d\u7f6e\u7b49\u5185\u5bb9\u4e0d\u5e38\u51fa\u73b0\u3002 NAS \u672c\u8eab\u4e0d\u4ee3\u8868\u4efb\u4f55\u534f\u8bae\uff0c\u5b83\u53ef\u4ee5\u4f7f\u7528FTP\uff0cSamba\uff0c\u751a\u81f3HTTP \u7b49\u534f\u8bae\u4f20\u9001\u6587\u4ef6\u3002 //TODO: \u8003\u8651\u662f\u5426\u6709\u8865\u5145\u7684\u5fc5\u8981 \u4e09\u3001\u9632\u706b\u5899\uff08iptables\uff09 \u00b6 \u56db\u3001SSH \u4e0eTelnet \u00b6 \u53c2\u8003\uff1a 1\u3001 http://www.xlysoft.net/detail/7-314-1194.html \u6548\u7387\u6e90\u79d1\u6280 \u5982\u4f55\u5bf9\u6709\u8bbf\u95ee\u5bc6\u7801\u7684MySQL\u6570\u636e\u5e93\u8fdb\u884c\u53d6\u8bc1 2\u3001 https://blog.csdn.net/hancoder/article/details/100988807 ubuntu\u4e0bftp\u7684\u914d\u7f6e","title":"Linux\u670d\u52a1\u5668"},{"location":"linux3/#linux-server-analysis","text":"","title":"Linux Server Analysis"},{"location":"linux3/#mysql","text":"\u9664\u4e86\u4f7f\u7528\u5bb9\u5668\u8fd0\u884c\u6570\u636e\u5e93\u5916\uff0cMySQL \u8fd8\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5\u5728\u4e3b\u673a\u4e0a\uff0c\u76f4\u63a5\u5728Linux \u6587\u4ef6\u76ee\u5f55\u4e2d\u7559\u4e0b\u75d5\u8ff9\u3002 \u6570\u636e\u5e93\u53d6\u8bc1\u4e00\u822c\u9075\u5faa\u4ee5\u4e0b\u6b65\u9aa4\uff1a 1\u3001\u7cfb\u7edf\u955c\u50cf\u53ef\u4ee5\u4eff\u771f\uff0c\u5e76\u4e14\u80fd\u591f\u76f4\u63a5\u4f7f\u7528MySQL \u8fdb\u884c\u4ea4\u4e92\u7684\uff0c\u8003\u8651\u53bb\u9664root \u7528\u6237\u5bc6\u7801\uff0c\u4f7f\u7528SQL\u8bed\u53e5\u68c0\u67e5\u6574\u4e2a\u6570\u636e\u5e93\u7684\u5185\u5bb9 2\u3001\u7cfb\u7edf\u65e0\u6cd5\u4eff\u771f\u7684\uff0c\u6216\u8005\u4eff\u771f\u4e4b\u540e\u65e0\u6cd5\u8fd0\u884cMySQL \u7684\uff0c\u8003\u8651\u5728\u4e0d\u635f\u574f\u6216\u8005\u5df2\u5907\u4efdMySQL\u76f8\u5173\u76ee\u5f55\u7684\u524d\u63d0\u4e0b\uff0c\u4fee\u590d\u8fd0\u884c\u73af\u5883\uff0c\u8fd0\u884cMySQL 3\u3001\u7cfb\u7edf\u65e0\u6cd5\u4eff\u771f\u6216\u8005MySQL \u6587\u4ef6\u76ee\u5f55\u4e0d\u5b8c\u6574\uff0c\u5355\u72ec\u6392\u67e5MySQL \u914d\u7f6e\u548c\u6570\u636e\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6 \u786e\u5b9aMySQL \u6570\u636e\u6587\u4ef6\u7684\u5b58\u653e\u8def\u5f84\uff1a \u641c\u7d22ibdata1 \u6587\u4ef6\uff1a find / -name ibdata1 \u786e\u5b9aMySQL \u7248\u672c\uff1a\u752816\u8fdb\u5236\u7f16\u8f91\u5668\u6253\u5f00\u4efb\u610f\u4e00\u4e2a.frm \u6587\u4ef6\uff0c\u68c0\u67e50x34 \u548c0x33 \u7684\u4f4d\u7f6e\uff0c\u4f8b\u59820x34 \u4e3a0xC6\uff0c0x33 \u4e3a0x29 \uff0c\u5219MySQL \u7248\u672c\u4e3a0xC629\uff0c\u53735.07.29 \u590d\u5236\u6574\u4e2aMySQL \u6570\u636e\u76ee\u5f55\uff0c\u5220\u9664ib_logfile \u6587\u4ef6\uff0c\u8f6c\u79fb\u5230\u65b0\u5b89\u88c5\u7684MySQL \u73af\u5883\u4e2d\uff0c\u68c0\u7d22\u5176\u4e2d\u7684\u6570\u636e \u8df3\u8fc7root \u5bc6\u7801\uff1a\u5728 /etc/mysql/mysql.conf.d/mysqld.cnf \u6587\u4ef6\u4e2d[mysqld] \u4e0b\u6dfb\u52a0 skip-grant-tables \u91cd\u542fMySQL \u670d\u52a1\uff0c\u4f7f\u7528root \u767b\u5f55","title":"\u4e00\u3001Mysql \u6570\u636e\u5e93"},{"location":"linux3/#ftpsmbnas","text":"","title":"\u4e8c\u3001\u6587\u4ef6\u670d\u52a1\u5668\uff08FTP\uff0cSMB\uff0cNAS\uff09"},{"location":"linux3/#ftp","text":"\u53ef\u4ee5\u5728CentOS \u6216Ubuntu \u4f7f\u7528vsftpd \u914d\u7f6eFTP \u670d\u52a1\u3002FTP\u670d\u52a1\u4f7f\u7528TCP 21\u7aef\u53e3\u9a8c\u8bc1\u8eab\u4efd\u4fe1\u606f\uff0c\u4f7f\u7528TCP 20\u7aef\u53e3\u4f20\u8f93\u6570\u636e\u3002 /etc/vsftpd/vsftpd.conf vsftpd \u7684\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6 /etc/vsftpd/ftpusers \u9ed1\u540d\u5355\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u91cc\u7684\u7528\u6237\u4e0d\u5141\u8bb8\u8bbf\u95ee FTP \u670d\u52a1\u5668 /etc/vsftpd/user_list \u767d\u540d\u5355\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u91cc\u7684\u7528\u6237\u5141\u8bb8\u8bbf\u95ee FTP \u670d\u52a1\u5668 /etc/vsftpd.chroot_list \u5141\u8bb8\u8bbf\u95eeFTP \u670d\u52a1\u5668\u7684\u7528\u6237\u5217\u8868 ** \u914d\u7f6e\u6587\u4ef6\u4e5f\u53ef\u80fd\u76f4\u63a5\u5b58\u653e\u5728/etc \u76ee\u5f55\u4e0b vsftpd.conf \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u76f8\u5173\u8bbe\u7f6e\u6709\uff1a \u914d\u7f6e\u53d8\u91cf \u914d\u7f6e\u8bf4\u660e local_root \u767b\u5f55FTP \u670d\u52a1\u5668\u540e\u6240\u5728\u76ee\u5f55 xferlog_enable Yes: \u542f\u7528\u65e5\u5fd7 pasv_address \u670d\u52a1\u5668\u6240\u5728IP\u5730\u5740 vsftp\u7684\u65e5\u5fd7\u6587\u4ef6\u4fdd\u5b58\u5728 /var/log/vsftpd.log\uff0c\u5176\u4e2d\u5305\u542b\u7684\u4fe1\u606f\u6709\u5c1d\u8bd5\u767b\u5f55\u6b64FTP \u670d\u52a1\u5668\u7684IP\u5730\u5740\u7b49","title":"FTP"},{"location":"linux3/#samba","text":"Samba \u662f\u4f7f\u7528SMB \u534f\u8bae\u7684\u4e00\u6b3e\u8f6f\u4ef6\u3002SMB \u534f\u8bae\u7528\u6765\u5728Linux \u4e0eWindows \u7cfb\u7edf\u4e4b\u95f4\u65e0\u75db\u5171\u4eab\u5b58\u50a8\u4e0e\u6253\u5370\u673a","title":"Samba"},{"location":"linux3/#nas","text":"NAS \u901a\u5e38\u7528\u6765\u5c06\u5927\u5bb9\u91cf\u78c1\u76d8\u6302\u8f7d\u5728\u7f51\u7edc\u4e0a\uff0c\u5f62\u6210\u7f51\u7edc\u5b58\u50a8\u3002\u5728\u7535\u5b50\u53d6\u8bc1\u9886\u57df\uff0c\u65f6\u5e38\u9700\u8981\u5206\u6790\u5927\u5bb9\u91cf\u78c1\u76d8\uff0c\u4f46\u5176\u5b9eNAS \u672c\u8eab\u7684\u914d\u7f6e\u7b49\u5185\u5bb9\u4e0d\u5e38\u51fa\u73b0\u3002 NAS \u672c\u8eab\u4e0d\u4ee3\u8868\u4efb\u4f55\u534f\u8bae\uff0c\u5b83\u53ef\u4ee5\u4f7f\u7528FTP\uff0cSamba\uff0c\u751a\u81f3HTTP \u7b49\u534f\u8bae\u4f20\u9001\u6587\u4ef6\u3002 //TODO: \u8003\u8651\u662f\u5426\u6709\u8865\u5145\u7684\u5fc5\u8981","title":"NAS"},{"location":"linux3/#iptables","text":"","title":"\u4e09\u3001\u9632\u706b\u5899\uff08iptables\uff09"},{"location":"linux3/#ssh-telnet","text":"\u53c2\u8003\uff1a 1\u3001 http://www.xlysoft.net/detail/7-314-1194.html \u6548\u7387\u6e90\u79d1\u6280 \u5982\u4f55\u5bf9\u6709\u8bbf\u95ee\u5bc6\u7801\u7684MySQL\u6570\u636e\u5e93\u8fdb\u884c\u53d6\u8bc1 2\u3001 https://blog.csdn.net/hancoder/article/details/100988807 ubuntu\u4e0bftp\u7684\u914d\u7f6e","title":"\u56db\u3001SSH \u4e0eTelnet"},{"location":"mac/","text":"MacOS Analysis \u00b6 \u76f8\u5bf9\u4e8e\u7528\u6237\u6570\u91cf\u5e9e\u5927\u7684Windows\u7528\u6237\uff0cMacOS\u7684\u7528\u6237\u91cf\u76f8\u6bd4\u4e4b\u4e0b\u8981\u5c11\u5f88\u591a\u3002\u5e76\u4e14\u5728\u8fd1\u51e0\u5e74\u7684\u53d6\u8bc1\u8d5b\u9898\u4e2d\u5bf9\u4e8eMacOS\u7684\u8003\u5bdf\u8f83\u5c11\uff0c\u9488\u5bf9\u6027\u4e5f\u6bd4\u8f83\u5f31\uff0c\u4e00\u822c\u90fd\u4f9d\u8d56\u4e8e\u5bf9\u53d6\u8bc1\u5de5\u5177\u3001Unix\uff08Linux\uff09\u7cfb\u7edf\u7684\u719f\u6089\u7a0b\u5ea6\uff0c\u603b\u4f53\u6765\u8bf4\u96be\u5ea6\u8f83\u4f4e\u3002\u53ea\u8981\u638c\u63e1\u5de5\u5177\u7684\u7075\u6d3b\u8fd0\u7528\u4e0e\u4e00\u4e9bMacOS\u72ec\u6709\u7684\u5c0f\u6280\u5de7\uff0c\u5c31\u80fd\u591f\u8f7b\u677e\u5e94\u8bd5\u3002 MacOS\u7cfb\u7edf\u7b80\u4ecb \u00b6 \u53c2\u8003\u767e\u5ea6\u767e\u79d1MacOS\u8bcd\u6761 Mac OS MacOS\u4eff\u771f\u4e0e\u5feb\u901f\u4e0a\u624b \u00b6 \u82f9\u679c\u4f5c\u4e3a\u4e00\u5bb6\u751f\u6001\u5708\u8f83\u4e3a\u5c01\u95ed\u7684\u516c\u53f8\uff0cMacOS\u7edd\u5927\u591a\u6570\u9884\u88c5\u5728\u82f9\u679c\u81ea\u5bb6\u8bbe\u5907\u4e0a\uff0c\u5728PC\u673a\u4e0a\u5b89\u88c5\u9ed1\u82f9\u679c\u7cfb\u7edf\u5e76\u4e0d\u662f\u4e00\u4ef6\u5bb9\u6613\u7684\u4e8b\u60c5\u3002\u56e0\u6b64\u63a8\u8350\u5728\u865a\u62df\u673a\u4e0a\u5b89\u88c5MacOS\u5e76\u8fdb\u884c\u65e5\u5e38\u64cd\u4f5c\u7684\u719f\u6089\u3002\u540c\u65f6\u8981\u5bf9Linux\u6587\u4ef6\u76ee\u5f55\u7ed3\u6784\u6709\u826f\u597d\u7684\u8ba4\u8bc6\uff0c\u53ef\u4ee5\u5728\u8d44\u6599\u67e5\u627e\u8fc7\u7a0b\u4e2d\u6709\u66f4\u52a0\u660e\u786e\u7684\u76ee\u7684\u6027\u3002 \u73b0\u5728\u5927\u591a\u6570\u7684\u4eff\u771f\u8f6f\u4ef6\u5df2\u7ecf\u52a0\u5165\u4e86\u5bf9MacOS\u7684\u652f\u6301\uff0c\u4f46\u662f\u51fa\u4e8e\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u673a\u5668\u90fd\u80fd\u6b63\u5e38\u5bf9\u8d5b\u9898\u955c\u50cf\u5b8c\u6210\u4eff\u771f\u5f15\u5bfc\uff0c\u5982\u679c\u51fa\u73b0\u5f15\u5bfc\u5931\u8d25\u6216\u5f00\u673a\u5bc6\u7801\u65e0\u6cd5\u7ed5\u8fc7\u7684\u60c5\u51b5\uff0c\u5c31\u53ea\u80fd\u5728\u53d6\u8bc1\u5927\u5e08\u4e2d\u8fdb\u884c\u8bc1\u636e\u67e5\u627e\u3002 MacOS\u53d6\u8bc1\u76f8\u5173\u5de5\u5177 \u00b6 \u7f8e\u4e9a\u53d6\u8bc1\u5927\u5e08 \u4eff\u771f\u5de5\u5177 osxcollector\uff08\u5f00\u6e90\u7684MacOS\u53d6\u8bc1\u811a\u672c\uff0c\u914d\u5408\u4eff\u771f\u8fdb\u884c\u4f7f\u7528\uff09 \u771f\u9898\u89e3\u6790\u4e0e\u5c0f\u6280\u5de7 \u00b6 MacOS\u76f8\u5173\u8bd5\u9898\u8f83\u5c11\uff0c\u56e0\u6b64\u4ee5\u7f8e\u4e9a\u676f2019\u5e74\u8d5b\u9898\u4e3e\u4f8b\u3002 1\u3001\u8003\u5bdf\u955c\u50cf\u4fe1\u606f 55\u300157\u300158\u4e09\u4e2a\u9898\u76ee\u7684\u7b54\u6848\u5747\u53ef\u7528\u53d6\u8bc1\u5927\u5e08\u8f7b\u677e\u83b7\u53d6\uff0c\u96be\u70b9\u5c31\u5728\u4e8e56\u9898\u7684\u786c\u4ef6\u4fe1\u606f\u7684\u83b7\u53d6\u3002\u6b64\u65f6\u4e0d\u53ef\u4ee5\u7528\u4eff\u771f+\u547d\u4ee4\u7684\u65b9\u5f0f\u8bfb\u53d6\u914d\u7f6e\uff0c\u90a3\u6837\u53ea\u80fd\u83b7\u53d6\u5230\u5f53\u524d\u865a\u62df\u673a\u73af\u5883\u4e0b\u5206\u914d\u7684\u786c\u4ef6\u4fe1\u606f\u3002 MacOS\u4e0b\u6709\u4e00\u4e2a\u540d\u4e3aHardwareConfig.json\u7684\u6587\u4ef6\u8bb0\u5f55\u4e86\u6700\u8fd1\u4e00\u6b21\u7684\u8ba1\u7b97\u673a\u786c\u4ef6\u4fe1\u606f\uff0c\u5305\u542bCPU\u3001RAM\u7b49\u7b49\uff0c\u56e0\u6b64\u5728\u53d6\u8bc1\u5927\u5e08\u4e2d\u76f4\u63a5\u641c\u7d22\u8be5\u6587\u4ef6\u5373\u53ef\u83b7\u53d6\u3002 2\u3001\u8003\u5bdf\u8bc1\u636e\u6587\u4ef6\u641c\u96c6 \u53d6\u8bc1\u5927\u5e08\u5e76\u6ca1\u6709OCR\u641c\u7d22\u529f\u80fd\uff0c\u4e14\u955c\u50cf\u4e2d\u65e0\u5173\u56fe\u7247\u5e72\u6270\u4f1a\u975e\u5e38\u5927\uff0c\u8fd9\u65f6\u4e00\u822c\u4f1a\u8003\u5bdf\u5230bash\u547d\u4ee4\u5386\u53f2\u7684\u8003\u5bdf\u3002 \u5728\u53d6\u8bc1\u5927\u5e08\u7ec8\u7aef\u547d\u4ee4\u8bb0\u5f55\u4e2d\u53ef\u4ee5\u770b\u51fa\u4e00\u4e9b\u5bf9\u6307\u5b9a\u8def\u5f84\u4e0b\u56fe\u7247\u6587\u4ef6\u7684\u64cd\u4f5c\uff0c\u5176\u4e2dmodify\u6587\u4ef6\u5341\u5206\u53ef\u7591\uff0c\u5b9a\u4f4d\u5230\u8be5\u6587\u4ef6\u5939\u4e0b\u6613\u5f97\u9898\u76ee\u6240\u627e\u56fe\u7247\u3002 3\u3001\u8003\u5bdf\u6d4f\u89c8\u75d5\u8ff9 \u8fd9\u4e00\u7c7b\u9898\u76ee\u5747\u4e3a\u9001\u5206\u9898\uff0c\u76f4\u63a5\u53d6\u8bc1\u5927\u5e08\u4e00\u628a\u68ad\u5c31\u53ef\u4ee5\u8f7b\u677e\u83b7\u53d6\u7b54\u6848\u3002 \u76f8\u5173\u7f51\u7ad9\u4fe1\u606f\u83b7\u53d6 \u00b6 \u8fdc\u666fMac\u8bba\u575b \u8fdc\u666fHackintosh","title":"MacOS"},{"location":"mac/#macos-analysis","text":"\u76f8\u5bf9\u4e8e\u7528\u6237\u6570\u91cf\u5e9e\u5927\u7684Windows\u7528\u6237\uff0cMacOS\u7684\u7528\u6237\u91cf\u76f8\u6bd4\u4e4b\u4e0b\u8981\u5c11\u5f88\u591a\u3002\u5e76\u4e14\u5728\u8fd1\u51e0\u5e74\u7684\u53d6\u8bc1\u8d5b\u9898\u4e2d\u5bf9\u4e8eMacOS\u7684\u8003\u5bdf\u8f83\u5c11\uff0c\u9488\u5bf9\u6027\u4e5f\u6bd4\u8f83\u5f31\uff0c\u4e00\u822c\u90fd\u4f9d\u8d56\u4e8e\u5bf9\u53d6\u8bc1\u5de5\u5177\u3001Unix\uff08Linux\uff09\u7cfb\u7edf\u7684\u719f\u6089\u7a0b\u5ea6\uff0c\u603b\u4f53\u6765\u8bf4\u96be\u5ea6\u8f83\u4f4e\u3002\u53ea\u8981\u638c\u63e1\u5de5\u5177\u7684\u7075\u6d3b\u8fd0\u7528\u4e0e\u4e00\u4e9bMacOS\u72ec\u6709\u7684\u5c0f\u6280\u5de7\uff0c\u5c31\u80fd\u591f\u8f7b\u677e\u5e94\u8bd5\u3002","title":"MacOS Analysis"},{"location":"mac/#macos","text":"\u53c2\u8003\u767e\u5ea6\u767e\u79d1MacOS\u8bcd\u6761 Mac OS","title":"MacOS\u7cfb\u7edf\u7b80\u4ecb"},{"location":"mac/#macos_1","text":"\u82f9\u679c\u4f5c\u4e3a\u4e00\u5bb6\u751f\u6001\u5708\u8f83\u4e3a\u5c01\u95ed\u7684\u516c\u53f8\uff0cMacOS\u7edd\u5927\u591a\u6570\u9884\u88c5\u5728\u82f9\u679c\u81ea\u5bb6\u8bbe\u5907\u4e0a\uff0c\u5728PC\u673a\u4e0a\u5b89\u88c5\u9ed1\u82f9\u679c\u7cfb\u7edf\u5e76\u4e0d\u662f\u4e00\u4ef6\u5bb9\u6613\u7684\u4e8b\u60c5\u3002\u56e0\u6b64\u63a8\u8350\u5728\u865a\u62df\u673a\u4e0a\u5b89\u88c5MacOS\u5e76\u8fdb\u884c\u65e5\u5e38\u64cd\u4f5c\u7684\u719f\u6089\u3002\u540c\u65f6\u8981\u5bf9Linux\u6587\u4ef6\u76ee\u5f55\u7ed3\u6784\u6709\u826f\u597d\u7684\u8ba4\u8bc6\uff0c\u53ef\u4ee5\u5728\u8d44\u6599\u67e5\u627e\u8fc7\u7a0b\u4e2d\u6709\u66f4\u52a0\u660e\u786e\u7684\u76ee\u7684\u6027\u3002 \u73b0\u5728\u5927\u591a\u6570\u7684\u4eff\u771f\u8f6f\u4ef6\u5df2\u7ecf\u52a0\u5165\u4e86\u5bf9MacOS\u7684\u652f\u6301\uff0c\u4f46\u662f\u51fa\u4e8e\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u673a\u5668\u90fd\u80fd\u6b63\u5e38\u5bf9\u8d5b\u9898\u955c\u50cf\u5b8c\u6210\u4eff\u771f\u5f15\u5bfc\uff0c\u5982\u679c\u51fa\u73b0\u5f15\u5bfc\u5931\u8d25\u6216\u5f00\u673a\u5bc6\u7801\u65e0\u6cd5\u7ed5\u8fc7\u7684\u60c5\u51b5\uff0c\u5c31\u53ea\u80fd\u5728\u53d6\u8bc1\u5927\u5e08\u4e2d\u8fdb\u884c\u8bc1\u636e\u67e5\u627e\u3002","title":"MacOS\u4eff\u771f\u4e0e\u5feb\u901f\u4e0a\u624b"},{"location":"mac/#macos_2","text":"\u7f8e\u4e9a\u53d6\u8bc1\u5927\u5e08 \u4eff\u771f\u5de5\u5177 osxcollector\uff08\u5f00\u6e90\u7684MacOS\u53d6\u8bc1\u811a\u672c\uff0c\u914d\u5408\u4eff\u771f\u8fdb\u884c\u4f7f\u7528\uff09","title":"MacOS\u53d6\u8bc1\u76f8\u5173\u5de5\u5177"},{"location":"mac/#_1","text":"MacOS\u76f8\u5173\u8bd5\u9898\u8f83\u5c11\uff0c\u56e0\u6b64\u4ee5\u7f8e\u4e9a\u676f2019\u5e74\u8d5b\u9898\u4e3e\u4f8b\u3002 1\u3001\u8003\u5bdf\u955c\u50cf\u4fe1\u606f 55\u300157\u300158\u4e09\u4e2a\u9898\u76ee\u7684\u7b54\u6848\u5747\u53ef\u7528\u53d6\u8bc1\u5927\u5e08\u8f7b\u677e\u83b7\u53d6\uff0c\u96be\u70b9\u5c31\u5728\u4e8e56\u9898\u7684\u786c\u4ef6\u4fe1\u606f\u7684\u83b7\u53d6\u3002\u6b64\u65f6\u4e0d\u53ef\u4ee5\u7528\u4eff\u771f+\u547d\u4ee4\u7684\u65b9\u5f0f\u8bfb\u53d6\u914d\u7f6e\uff0c\u90a3\u6837\u53ea\u80fd\u83b7\u53d6\u5230\u5f53\u524d\u865a\u62df\u673a\u73af\u5883\u4e0b\u5206\u914d\u7684\u786c\u4ef6\u4fe1\u606f\u3002 MacOS\u4e0b\u6709\u4e00\u4e2a\u540d\u4e3aHardwareConfig.json\u7684\u6587\u4ef6\u8bb0\u5f55\u4e86\u6700\u8fd1\u4e00\u6b21\u7684\u8ba1\u7b97\u673a\u786c\u4ef6\u4fe1\u606f\uff0c\u5305\u542bCPU\u3001RAM\u7b49\u7b49\uff0c\u56e0\u6b64\u5728\u53d6\u8bc1\u5927\u5e08\u4e2d\u76f4\u63a5\u641c\u7d22\u8be5\u6587\u4ef6\u5373\u53ef\u83b7\u53d6\u3002 2\u3001\u8003\u5bdf\u8bc1\u636e\u6587\u4ef6\u641c\u96c6 \u53d6\u8bc1\u5927\u5e08\u5e76\u6ca1\u6709OCR\u641c\u7d22\u529f\u80fd\uff0c\u4e14\u955c\u50cf\u4e2d\u65e0\u5173\u56fe\u7247\u5e72\u6270\u4f1a\u975e\u5e38\u5927\uff0c\u8fd9\u65f6\u4e00\u822c\u4f1a\u8003\u5bdf\u5230bash\u547d\u4ee4\u5386\u53f2\u7684\u8003\u5bdf\u3002 \u5728\u53d6\u8bc1\u5927\u5e08\u7ec8\u7aef\u547d\u4ee4\u8bb0\u5f55\u4e2d\u53ef\u4ee5\u770b\u51fa\u4e00\u4e9b\u5bf9\u6307\u5b9a\u8def\u5f84\u4e0b\u56fe\u7247\u6587\u4ef6\u7684\u64cd\u4f5c\uff0c\u5176\u4e2dmodify\u6587\u4ef6\u5341\u5206\u53ef\u7591\uff0c\u5b9a\u4f4d\u5230\u8be5\u6587\u4ef6\u5939\u4e0b\u6613\u5f97\u9898\u76ee\u6240\u627e\u56fe\u7247\u3002 3\u3001\u8003\u5bdf\u6d4f\u89c8\u75d5\u8ff9 \u8fd9\u4e00\u7c7b\u9898\u76ee\u5747\u4e3a\u9001\u5206\u9898\uff0c\u76f4\u63a5\u53d6\u8bc1\u5927\u5e08\u4e00\u628a\u68ad\u5c31\u53ef\u4ee5\u8f7b\u677e\u83b7\u53d6\u7b54\u6848\u3002","title":"\u771f\u9898\u89e3\u6790\u4e0e\u5c0f\u6280\u5de7"},{"location":"mac/#_2","text":"\u8fdc\u666fMac\u8bba\u575b \u8fdc\u666fHackintosh","title":"\u76f8\u5173\u7f51\u7ad9\u4fe1\u606f\u83b7\u53d6"},{"location":"mobile/","text":"Mobile Devices Analysis \u00b6","title":"Mobile Devices"},{"location":"mobile/#mobile-devices-analysis","text":"","title":"Mobile Devices Analysis"},{"location":"pac/","text":"Packet Analysis \u00b6 \u7f51\u7edc\u6d41\u91cf\u5206\u6790\u662f\u6307\u6355\u6349\u7f51\u7edc\u4e2d\u6d41\u52a8\u7684\u6570\u636e\u5305\uff0c\u5e76\u901a\u8fc7\u67e5\u770b\u5305\u5185\u90e8\u6570\u636e\u4ee5\u53ca\u8fdb\u884c\u76f8\u5173\u7684\u534f\u8bae\u3001\u6d41\u91cf\u5206\u6790\u3001\u7edf\u8ba1\u7b49\u6765\u53d1\u73b0\u7f51\u7edc\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684\u95ee\u9898\u3002 \u5728\u5e94\u6025\u54cd\u5e94\u4e0e\u65e5\u5e38\u8fd0\u7ef4\u4e2d\u90fd\u662f\u81f3\u5173\u91cd\u8981\u7684\u6b65\u9aa4\u3002 \u5bf9\u4e8e\u53d6\u8bc1\u5206\u6790\uff0c\u5728 CTF\u4e2d\u7684\u6d41\u91cf\u5305\u5206\u6790 \u4e2d\u6709\u4e00\u4e9b\u7b80\u5355\u7684\u4ecb\u7ecd\u3002\u4e8c\u8005\u57fa\u672c\u4e0a\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u5728CTF\u4e2d\u5bf9\u6570\u636e\u5305\u7684\u5206\u6790\u6bd4\u8f83\u6ce8\u91cd\u7ec6\u8282\u548c\u8f83\u9ad8\u96be\u5ea6\u7684\u5904\u7406\uff1b\u5728\u7f8e\u4e9a\u676f\u7684\u6bd4\u8d5b\u4e2d\u66f4\u6ce8\u91cd\u6d41\u91cf\u5305\u7684\u884c\u4e3a\u548c\u7ed3\u679c\uff0c\u4ece\u800c\u5bf9\u5176\u4ed6\u955c\u50cf\u7684\u5206\u6790\u7ed3\u679c\u8fdb\u884c\u4f50\u8bc1\u3002 Wireshark\u4f7f\u7528 \u00b6 pcap\u6d41\u91cf\u5305\u7684\u5206\u6790\u901a\u5e38\u90fd\u662f\u901a\u8fc7\u56fe\u5f62\u5316\u7684\u7f51\u7edc\u55c5\u63a2\u5668\u2014\u2014Wireshark\u8fdb\u884c\u7684\uff0c\u8fd9\u6b3e\u55c5\u63a2\u5668\u7ecf\u8fc7\u4f17\u591a\u5f00\u53d1\u8005\u7684\u4e0d\u65ad\u5b8c\u5584\uff0c\u73b0\u5728\u5df2\u7ecf\u6210\u4e3a\u4e86\u4f7f\u7528\u6700\u4e3a\u5e7f\u6cdb\u7684\u5b89\u5168\u5de5\u5177\u4e4b\u4e00\u3002 Wireshark\u7684\u57fa\u672c\u4f7f\u7528\u5206\u4e3a\u6570\u636e\u5305\u7b5b\u9009\u3001\u6570\u636e\u5305\u641c\u7d22\u3001\u6570\u636e\u5305\u8fd8\u539f\u3001\u6570\u636e\u63d0\u53d6\u56db\u4e2a\u90e8\u5206\u3002 \u6570\u636e\u5305\u7b5b\u9009 \u00b6 \u6570\u636e\u5305\u7b5b\u9009\u529f\u80fd\u662fWireshark\u7684\u6838\u5fc3\u529f\u80fd\uff0c\u6bd4\u5982\u9700\u8981\u7b5b\u9009\u51fa\u7279\u5b9a\u7684\u534f\u8bae\u5982HTTP\uff0cTelnet\u7b49\uff0c\u4e5f\u53ef\u80fd\u9700\u8981\u7b5b\u9009\u51faip\u5730\u5740\uff0c\u7aef\u53e3\u7b49\u3002 \u6570\u636e\u5305\u641c\u7d22 \u00b6 \u5728Wireshark\u754c\u9762\u6309\u201cCtrl+F\u201d\uff0c\u53ef\u4ee5\u8fdb\u884c\u5173\u952e\u5b57\u641c\u7d22\u3002Wireshark\u7684\u641c\u7d22\u529f\u80fd\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u3001\u5b57\u7b26\u4e32\u3001\u5341\u516d\u8fdb\u5236\u7b49\u65b9\u5f0f\u8fdb\u884c\u641c\u7d22\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u76f4\u63a5\u4f7f\u7528\u5b57\u7b26\u4e32\u65b9\u5f0f\u8fdb\u884c\u641c\u7d22\u3002 \u6570\u636e\u5305\u8fd8\u539f \u00b6 \u5728Wireshark\u4e2d\uff0c\u5b58\u5728\u4e00\u4e2a\u4ea4\u8ffd\u8e2a\u6d41\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u5c06HTTP\u6216TCP\u6d41\u91cf\u96c6\u5408\u5728\u4e00\u8d77\u5e76\u8fd8\u539f\u6210\u539f\u59cb\u6570\u636e\uff0c\u5177\u4f53\u64cd\u4f5c\u65b9\u5f0f\uff1a\u9009\u4e2d\u60f3\u8981\u8fd8\u539f\u7684\u6d41\u91cf\u5305\uff0c\u53f3\u952e\u9009\u4e2d\uff0c\u9009\u62e9\u8ffd\u8e2a\u6d41 \u2013 TCP\u6d41/UPD\u6d41/SSL\u6d41/HTTP\u6d41\u3002 \u6570\u636e\u63d0\u53d6 \u00b6 Wireshark\u652f\u6301\u63d0\u53d6\u901a\u8fc7http\u4f20\u8f93\uff08\u4e0a\u4f20/\u4e0b\u8f7d\uff09\u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u65b9\u6cd5\uff1a\u9009\u4e2dhttp\u6587\u4ef6\u4f20\u8f93\u6d41\u91cf\u5305\uff0c\u5728\u5206\u7ec4\u8be6\u60c5\u4e2d\u627e\u5230data\u6216\u8005Line-based text data:text/html\u5c42\uff0c\u9f20\u6807\u53f3\u952e\u70b9\u51fb \u2013 \u9009\u4e2d \u5bfc\u51fa\u5206\u7ec4\u5b57\u8282\u6d41\u3002 \u7b2c\u4e94\u5c4a\u7f8e\u4e9a\u676f\u9898\u89e3 \u00b6 \u9898\u76ee\uff1a \u00b6 \u89e3\u6790\uff1a \u00b6 106\u3001\u6587\u4ef6\u7684MD5\u503c\uff1a \u8fd9\u662f\u7f8e\u4e9a\u676f\u4e00\u4e2a\u7279\u70b9\uff0c\u75af\u72c2\u6c42\u5404\u79cd\u6587\u4ef6\u7684MD5\u503c\u3002 Windows\u7ec8\u7aef\u547d\u4ee4\u5982\u4e0b\uff1a certutil -hashfile filename MD5/SHA1/SHA256 \u4e0d\u8fc7\u6b64\u9898\u51fa\u4e86\u4e00\u4e9b\u95ee\u9898\uff0c\u8ddf\u7b54\u6848\u5bf9\u4e0d\u4e0a\uff0c\u6700\u7ec8\u4f5c\u5e9f\u4e86\u3002 107\u3001Dos\u653b\u51fb\uff1a \u4ece\u5f88\u591a\u5730\u65b9\u53ef\u4ee5\u770b\u51fa\u6765\u653b\u51fb\u65b9\u5f0f\uff1a Slowhttptest \u662f\u4f9d\u8d56HTTP\u534f\u8bae\u7684\u6162\u901f\u653b\u51fbDoS\u653b\u51fb\u5de5\u5177\uff0c\u8bbe\u8ba1\u7684\u57fa\u672c\u539f\u7406\u662f\u670d\u52a1\u5668\u5728\u8bf7\u6c42\u5b8c\u5168\u63a5\u6536\u540e\u624d\u4f1a\u8fdb\u884c\u5904\u7406\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u7684\u53d1\u9001\u901f\u5ea6\u7f13\u6162\u6216\u8005\u53d1\u9001\u4e0d\u5b8c\u6574\uff0c\u670d\u52a1\u7aef\u4e3a\u5176\u4fdd\u7559\u8fde\u63a5\u8d44\u6e90\u6c60\u5360\u7528\uff0c\u5927\u91cf\u6b64\u7c7b\u8bf7\u6c42\u5e76\u53d1\u5c06\u5bfc\u81f4DoS\u3002 108\u3001\u6293\u5305\u65f6\u95f4\uff1a \u6309\u65f6\u95f4\u6392\u5e8f\u540e\uff0c\u67e5\u770b\u6700\u540e\u4e00\u4e2a\u5305\u7684Arrival Time\u3002 109\u3001\u76ee\u6807\u5730\u5740\uff1a \u5728107\u3001\u4e2d\u7684\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230Host\u4fe1\u606f\uff0c\u5305\u62ec\u4e86\u53d1\u9001\u7684\u76ee\u7684\u57df\u540d\u548c\u7aef\u53e3\u53f7\u3002 110\u3001\u76ee\u6807IP\uff1a \u57df\u540d\u6b63\u786e\u540e\uff0c\u76f4\u63a5\u770b\u5efa\u7acb\u8fde\u63a5\u7684Destination\u3002 111\u3001\u534f\u8bae\u7edf\u8ba1\uff1a \u5229\u7528Wireshark\u7684\u7edf\u8ba1\u529f\u80fd\uff1a\u7edf\u8ba1 \u2192 \u534f\u8bae\u5206\u7ea7 \u5f97\u51faHTTP\u53600.3% 112\u3001\u6570\u636e\u5305\u4e2a\u6570\uff1a \u6bd4\u8f83\u7b80\u5355\uff0c\u53c2\u7167108\u3001\u6700\u4e0b\u65b9\u5305\u7684\u5e8f\u53f7\u3002 \u6839\u636e\u4e0b\u56fe\u89e3\u51b3\u6700\u540e\u4e24\u9898\uff1a 115\u3001\u534f\u8bae\u8ba4\u5b9a\uff1a \u901a\u8fc7111\u3001\u534f\u8bae\u7edf\u8ba1\uff0cHTTP\u7684\u5305\u53ea\u5360\u4e860.3%\uff0c\u4e0d\u8db3\u4ee5\u5b9e\u73b0Slow HTTP Attack\u3002\u6545\u5f88\u660e\u786e\u88ab\u8bc6\u522b\u6210\u4e86\u4e0a\u5c42\u7684TCP\u3002 116\u3001\u6570\u636e\u5305\u4fe1\u606f\uff1a \u6839\u636eSlow HTTP Attack\u6a21\u5f0f\u4e2d\u7684Slow Header\uff1a HTTP Header\u4ee5\u4e24\u4e2aCLRF\u7ed3\u5c3e\uff0c\u901a\u8fc7\u53d1\u9001\u53ea\u5305\u542b\u4e00\u4e2aCLRF\u7684\u7578\u5f62Header\u8bf7\u6c42\uff0c\u5360\u7528Web\u670d\u52a1\u5668\u8fde\u63a5\uff0c\u6d88\u8017\u6389\u6240\u6709\u7684\u8fde\u63a5\u6570\uff0c\u800c\u9020\u6210Web\u670d\u52a1\u5668\u62d2\u7edd\u65b0\u7684\u670d\u52a1\u3002 \u4e5f\u5c31\u662f\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684\u4e24\u4e2a\\r\\n\uff0c\u73b0\u5728\u53ea\u53d1\u4e86\u4e00\u4e2a\uff0c\u6765\u5b9e\u73b0\u653b\u51fb\u3002","title":"Packet Analysis"},{"location":"pac/#packet-analysis","text":"\u7f51\u7edc\u6d41\u91cf\u5206\u6790\u662f\u6307\u6355\u6349\u7f51\u7edc\u4e2d\u6d41\u52a8\u7684\u6570\u636e\u5305\uff0c\u5e76\u901a\u8fc7\u67e5\u770b\u5305\u5185\u90e8\u6570\u636e\u4ee5\u53ca\u8fdb\u884c\u76f8\u5173\u7684\u534f\u8bae\u3001\u6d41\u91cf\u5206\u6790\u3001\u7edf\u8ba1\u7b49\u6765\u53d1\u73b0\u7f51\u7edc\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684\u95ee\u9898\u3002 \u5728\u5e94\u6025\u54cd\u5e94\u4e0e\u65e5\u5e38\u8fd0\u7ef4\u4e2d\u90fd\u662f\u81f3\u5173\u91cd\u8981\u7684\u6b65\u9aa4\u3002 \u5bf9\u4e8e\u53d6\u8bc1\u5206\u6790\uff0c\u5728 CTF\u4e2d\u7684\u6d41\u91cf\u5305\u5206\u6790 \u4e2d\u6709\u4e00\u4e9b\u7b80\u5355\u7684\u4ecb\u7ecd\u3002\u4e8c\u8005\u57fa\u672c\u4e0a\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u5728CTF\u4e2d\u5bf9\u6570\u636e\u5305\u7684\u5206\u6790\u6bd4\u8f83\u6ce8\u91cd\u7ec6\u8282\u548c\u8f83\u9ad8\u96be\u5ea6\u7684\u5904\u7406\uff1b\u5728\u7f8e\u4e9a\u676f\u7684\u6bd4\u8d5b\u4e2d\u66f4\u6ce8\u91cd\u6d41\u91cf\u5305\u7684\u884c\u4e3a\u548c\u7ed3\u679c\uff0c\u4ece\u800c\u5bf9\u5176\u4ed6\u955c\u50cf\u7684\u5206\u6790\u7ed3\u679c\u8fdb\u884c\u4f50\u8bc1\u3002","title":"Packet Analysis"},{"location":"pac/#wireshark","text":"pcap\u6d41\u91cf\u5305\u7684\u5206\u6790\u901a\u5e38\u90fd\u662f\u901a\u8fc7\u56fe\u5f62\u5316\u7684\u7f51\u7edc\u55c5\u63a2\u5668\u2014\u2014Wireshark\u8fdb\u884c\u7684\uff0c\u8fd9\u6b3e\u55c5\u63a2\u5668\u7ecf\u8fc7\u4f17\u591a\u5f00\u53d1\u8005\u7684\u4e0d\u65ad\u5b8c\u5584\uff0c\u73b0\u5728\u5df2\u7ecf\u6210\u4e3a\u4e86\u4f7f\u7528\u6700\u4e3a\u5e7f\u6cdb\u7684\u5b89\u5168\u5de5\u5177\u4e4b\u4e00\u3002 Wireshark\u7684\u57fa\u672c\u4f7f\u7528\u5206\u4e3a\u6570\u636e\u5305\u7b5b\u9009\u3001\u6570\u636e\u5305\u641c\u7d22\u3001\u6570\u636e\u5305\u8fd8\u539f\u3001\u6570\u636e\u63d0\u53d6\u56db\u4e2a\u90e8\u5206\u3002","title":"Wireshark\u4f7f\u7528"},{"location":"pac/#_1","text":"\u6570\u636e\u5305\u7b5b\u9009\u529f\u80fd\u662fWireshark\u7684\u6838\u5fc3\u529f\u80fd\uff0c\u6bd4\u5982\u9700\u8981\u7b5b\u9009\u51fa\u7279\u5b9a\u7684\u534f\u8bae\u5982HTTP\uff0cTelnet\u7b49\uff0c\u4e5f\u53ef\u80fd\u9700\u8981\u7b5b\u9009\u51faip\u5730\u5740\uff0c\u7aef\u53e3\u7b49\u3002","title":"\u6570\u636e\u5305\u7b5b\u9009"},{"location":"pac/#_2","text":"\u5728Wireshark\u754c\u9762\u6309\u201cCtrl+F\u201d\uff0c\u53ef\u4ee5\u8fdb\u884c\u5173\u952e\u5b57\u641c\u7d22\u3002Wireshark\u7684\u641c\u7d22\u529f\u80fd\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u3001\u5b57\u7b26\u4e32\u3001\u5341\u516d\u8fdb\u5236\u7b49\u65b9\u5f0f\u8fdb\u884c\u641c\u7d22\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u76f4\u63a5\u4f7f\u7528\u5b57\u7b26\u4e32\u65b9\u5f0f\u8fdb\u884c\u641c\u7d22\u3002","title":"\u6570\u636e\u5305\u641c\u7d22"},{"location":"pac/#_3","text":"\u5728Wireshark\u4e2d\uff0c\u5b58\u5728\u4e00\u4e2a\u4ea4\u8ffd\u8e2a\u6d41\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u5c06HTTP\u6216TCP\u6d41\u91cf\u96c6\u5408\u5728\u4e00\u8d77\u5e76\u8fd8\u539f\u6210\u539f\u59cb\u6570\u636e\uff0c\u5177\u4f53\u64cd\u4f5c\u65b9\u5f0f\uff1a\u9009\u4e2d\u60f3\u8981\u8fd8\u539f\u7684\u6d41\u91cf\u5305\uff0c\u53f3\u952e\u9009\u4e2d\uff0c\u9009\u62e9\u8ffd\u8e2a\u6d41 \u2013 TCP\u6d41/UPD\u6d41/SSL\u6d41/HTTP\u6d41\u3002","title":"\u6570\u636e\u5305\u8fd8\u539f"},{"location":"pac/#_4","text":"Wireshark\u652f\u6301\u63d0\u53d6\u901a\u8fc7http\u4f20\u8f93\uff08\u4e0a\u4f20/\u4e0b\u8f7d\uff09\u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u65b9\u6cd5\uff1a\u9009\u4e2dhttp\u6587\u4ef6\u4f20\u8f93\u6d41\u91cf\u5305\uff0c\u5728\u5206\u7ec4\u8be6\u60c5\u4e2d\u627e\u5230data\u6216\u8005Line-based text data:text/html\u5c42\uff0c\u9f20\u6807\u53f3\u952e\u70b9\u51fb \u2013 \u9009\u4e2d \u5bfc\u51fa\u5206\u7ec4\u5b57\u8282\u6d41\u3002","title":"\u6570\u636e\u63d0\u53d6"},{"location":"pac/#_5","text":"","title":"\u7b2c\u4e94\u5c4a\u7f8e\u4e9a\u676f\u9898\u89e3"},{"location":"pac/#_6","text":"","title":"\u9898\u76ee\uff1a"},{"location":"pac/#_7","text":"106\u3001\u6587\u4ef6\u7684MD5\u503c\uff1a \u8fd9\u662f\u7f8e\u4e9a\u676f\u4e00\u4e2a\u7279\u70b9\uff0c\u75af\u72c2\u6c42\u5404\u79cd\u6587\u4ef6\u7684MD5\u503c\u3002 Windows\u7ec8\u7aef\u547d\u4ee4\u5982\u4e0b\uff1a certutil -hashfile filename MD5/SHA1/SHA256 \u4e0d\u8fc7\u6b64\u9898\u51fa\u4e86\u4e00\u4e9b\u95ee\u9898\uff0c\u8ddf\u7b54\u6848\u5bf9\u4e0d\u4e0a\uff0c\u6700\u7ec8\u4f5c\u5e9f\u4e86\u3002 107\u3001Dos\u653b\u51fb\uff1a \u4ece\u5f88\u591a\u5730\u65b9\u53ef\u4ee5\u770b\u51fa\u6765\u653b\u51fb\u65b9\u5f0f\uff1a Slowhttptest \u662f\u4f9d\u8d56HTTP\u534f\u8bae\u7684\u6162\u901f\u653b\u51fbDoS\u653b\u51fb\u5de5\u5177\uff0c\u8bbe\u8ba1\u7684\u57fa\u672c\u539f\u7406\u662f\u670d\u52a1\u5668\u5728\u8bf7\u6c42\u5b8c\u5168\u63a5\u6536\u540e\u624d\u4f1a\u8fdb\u884c\u5904\u7406\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u7684\u53d1\u9001\u901f\u5ea6\u7f13\u6162\u6216\u8005\u53d1\u9001\u4e0d\u5b8c\u6574\uff0c\u670d\u52a1\u7aef\u4e3a\u5176\u4fdd\u7559\u8fde\u63a5\u8d44\u6e90\u6c60\u5360\u7528\uff0c\u5927\u91cf\u6b64\u7c7b\u8bf7\u6c42\u5e76\u53d1\u5c06\u5bfc\u81f4DoS\u3002 108\u3001\u6293\u5305\u65f6\u95f4\uff1a \u6309\u65f6\u95f4\u6392\u5e8f\u540e\uff0c\u67e5\u770b\u6700\u540e\u4e00\u4e2a\u5305\u7684Arrival Time\u3002 109\u3001\u76ee\u6807\u5730\u5740\uff1a \u5728107\u3001\u4e2d\u7684\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230Host\u4fe1\u606f\uff0c\u5305\u62ec\u4e86\u53d1\u9001\u7684\u76ee\u7684\u57df\u540d\u548c\u7aef\u53e3\u53f7\u3002 110\u3001\u76ee\u6807IP\uff1a \u57df\u540d\u6b63\u786e\u540e\uff0c\u76f4\u63a5\u770b\u5efa\u7acb\u8fde\u63a5\u7684Destination\u3002 111\u3001\u534f\u8bae\u7edf\u8ba1\uff1a \u5229\u7528Wireshark\u7684\u7edf\u8ba1\u529f\u80fd\uff1a\u7edf\u8ba1 \u2192 \u534f\u8bae\u5206\u7ea7 \u5f97\u51faHTTP\u53600.3% 112\u3001\u6570\u636e\u5305\u4e2a\u6570\uff1a \u6bd4\u8f83\u7b80\u5355\uff0c\u53c2\u7167108\u3001\u6700\u4e0b\u65b9\u5305\u7684\u5e8f\u53f7\u3002 \u6839\u636e\u4e0b\u56fe\u89e3\u51b3\u6700\u540e\u4e24\u9898\uff1a 115\u3001\u534f\u8bae\u8ba4\u5b9a\uff1a \u901a\u8fc7111\u3001\u534f\u8bae\u7edf\u8ba1\uff0cHTTP\u7684\u5305\u53ea\u5360\u4e860.3%\uff0c\u4e0d\u8db3\u4ee5\u5b9e\u73b0Slow HTTP Attack\u3002\u6545\u5f88\u660e\u786e\u88ab\u8bc6\u522b\u6210\u4e86\u4e0a\u5c42\u7684TCP\u3002 116\u3001\u6570\u636e\u5305\u4fe1\u606f\uff1a \u6839\u636eSlow HTTP Attack\u6a21\u5f0f\u4e2d\u7684Slow Header\uff1a HTTP Header\u4ee5\u4e24\u4e2aCLRF\u7ed3\u5c3e\uff0c\u901a\u8fc7\u53d1\u9001\u53ea\u5305\u542b\u4e00\u4e2aCLRF\u7684\u7578\u5f62Header\u8bf7\u6c42\uff0c\u5360\u7528Web\u670d\u52a1\u5668\u8fde\u63a5\uff0c\u6d88\u8017\u6389\u6240\u6709\u7684\u8fde\u63a5\u6570\uff0c\u800c\u9020\u6210Web\u670d\u52a1\u5668\u62d2\u7edd\u65b0\u7684\u670d\u52a1\u3002 \u4e5f\u5c31\u662f\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684\u4e24\u4e2a\\r\\n\uff0c\u73b0\u5728\u53ea\u53d1\u4e86\u4e00\u4e2a\uff0c\u6765\u5b9e\u73b0\u653b\u51fb\u3002","title":"\u89e3\u6790\uff1a"},{"location":"preparation/","text":"Preparation \u00b6 \u8fd9\u91cc\u6709\u8d5b\u524d\u51c6\u5907\u7684\u5de5\u5177\u4e0e\u7ec3\u4e60\u7684\u65b9\u6cd5\uff0c\u4ee5\u53ca\u53ef\u80fd\u4f1a\u9047\u5230\u7684\u4e00\u4e9b\u95ee\u9898\u3002 Hardware Tools \u00b6 \u9ad8\u6027\u80fd\u5927SSD\u53d6\u8bc1\u7b14\u8bb0\u672c\u7535\u8111\uff08\u53d6\u8bc1\u5854\uff09\u2014\u2014\u2014\u2014\u897f\u7535\u53d6\u8bc1\u5b9e\u9a8c\u5ba4\u914d\u5907\u8054\u60f3Y9000X\u4e0e\u6234\u5c14\u53f0\u5f0f\u5de5\u4f5c\u7ad9 \u5927\u5bb9\u91cf\u79fb\u52a8SSD\u2014\u2014\u2014\u2014\u4e09\u661f1TB SSD USB\u6269\u5c55\u575e Software Tools \u00b6 \u4ee5\u4e0b\u8f6f\u4ef6\u4f5c\u4e3a\u53c2\u8003\uff0c\u5747\u53ef\u7528\u540c\u7c7b\u578b\u8f6f\u4ef6\u66ff\u4ee3\uff1a \u798f\u6615PDF\u9605\u8bfb\u5668 \u7f8e\u4e9a\u53d6\u8bc1\u5927\u5e08 \u7f8e\u4e9a\u624b\u673a\u5927\u5e08 \u706b\u773c\u4eff\u771f\u8f6f\u4ef6 Vmware Workstation\uff08\u5efa\u8baeWin\u548clinux\u7cfb\u7edf\u90fd\u5b89\u88c5\uff09 IDA Pro Wireshark Winhex 010 Editor SQLite\u7b49\u6570\u636e\u5e93\u7ba1\u7406\u8f6f\u4ef6 \u4ee5\u53ca\u5176\u4ed6\u5404\u79cdCTF\u5e38\u7528\u5206\u6790\u5de5\u5177 \u6ce8\u610f\u4e8b\u9879 \u00b6 \uff08\u672a\u5b8c\u5f85\u7eed\uff09","title":"Preparation"},{"location":"preparation/#preparation","text":"\u8fd9\u91cc\u6709\u8d5b\u524d\u51c6\u5907\u7684\u5de5\u5177\u4e0e\u7ec3\u4e60\u7684\u65b9\u6cd5\uff0c\u4ee5\u53ca\u53ef\u80fd\u4f1a\u9047\u5230\u7684\u4e00\u4e9b\u95ee\u9898\u3002","title":"Preparation"},{"location":"preparation/#hardware-tools","text":"\u9ad8\u6027\u80fd\u5927SSD\u53d6\u8bc1\u7b14\u8bb0\u672c\u7535\u8111\uff08\u53d6\u8bc1\u5854\uff09\u2014\u2014\u2014\u2014\u897f\u7535\u53d6\u8bc1\u5b9e\u9a8c\u5ba4\u914d\u5907\u8054\u60f3Y9000X\u4e0e\u6234\u5c14\u53f0\u5f0f\u5de5\u4f5c\u7ad9 \u5927\u5bb9\u91cf\u79fb\u52a8SSD\u2014\u2014\u2014\u2014\u4e09\u661f1TB SSD USB\u6269\u5c55\u575e","title":"Hardware Tools"},{"location":"preparation/#software-tools","text":"\u4ee5\u4e0b\u8f6f\u4ef6\u4f5c\u4e3a\u53c2\u8003\uff0c\u5747\u53ef\u7528\u540c\u7c7b\u578b\u8f6f\u4ef6\u66ff\u4ee3\uff1a \u798f\u6615PDF\u9605\u8bfb\u5668 \u7f8e\u4e9a\u53d6\u8bc1\u5927\u5e08 \u7f8e\u4e9a\u624b\u673a\u5927\u5e08 \u706b\u773c\u4eff\u771f\u8f6f\u4ef6 Vmware Workstation\uff08\u5efa\u8baeWin\u548clinux\u7cfb\u7edf\u90fd\u5b89\u88c5\uff09 IDA Pro Wireshark Winhex 010 Editor SQLite\u7b49\u6570\u636e\u5e93\u7ba1\u7406\u8f6f\u4ef6 \u4ee5\u53ca\u5176\u4ed6\u5404\u79cdCTF\u5e38\u7528\u5206\u6790\u5de5\u5177","title":"Software Tools"},{"location":"preparation/#_1","text":"\uff08\u672a\u5b8c\u5f85\u7eed\uff09","title":"\u6ce8\u610f\u4e8b\u9879"},{"location":"ram/","text":"\u7f51\u7edc\u653b\u51fb\u5185\u5b58\u5316\u548c\u7f51\u7edc\u72af\u7f6a\u9690\u9041\u5316,\u4f7f\u90e8\u5206\u5173\u952e\u6570\u5b57\u8bc1\u636e\u53ea\u5b58\u5728\u4e8e\u7269\u7406\u5185\u5b58\u6216\u6682\u5b58\u4e8e\u9875\u9762\u4ea4\u6362\u6587\u4ef6\u4e2d,\u8fd9\u4f7f\u5f97\u4f20\u7edf\u7684\u57fa\u4e8e\u6587\u4ef6\u7cfb\u7edf\u7684\u8ba1\u7b97\u673a\u53d6\u8bc1\u4e0d\u80fd\u6709\u6548\u5e94\u5bf9\u3002 \u5185\u5b58\u53d6\u8bc1\u5b9a\u4e49\u53ca\u5176\u7279\u70b9 \u00b6 \u5148\u7ed9\u51fa\u5b98\u65b9\u7684\u6307\u5bfc\u6307\u5357 \u300aThe Art Of Memeory Forensics\u300b \u4e00\u4e66\u4e2d\u7ed9\u51fa\u7684\u4ecb\u7ecd(\u540e\u9762\u4f1a\u7ed9\u51fa\u4e0b\u8f7d\u5730\u5740)\uff0c\u4e2a\u4eba\u8ba4\u4e3a\u975e\u5e38\u6e05\u6670\uff1a Memory forensics is arguably the most fruitful, interesting, and provocative realm of digital forensics. Each function performed by an operating system or applica- tion results in specific modifications to the computer\u2019s memory (RAM), which can often persist a long time after the action, essentially preserving them. Additionally, memory forensics provides unprecedented visibility into the runtime state of the system, such as which processes were running, open network connections, and recently executed com- mands. You can extract these artifacts in a manner that is completely independent of the system you are investigating, reducing the chance that malware or rootkits can interfere with your results. Critical data often exists exclusively in memory, such as disk encryp- tion keys, memory-resident injected code fragments, off-the-record chat messages, unen- crypted e-mail messages, and non-cacheable Internet history records. \u3000\u3000\u4ece\u4f60\u6309\u4e0b\u8ba1\u7b97\u673a\u7535\u6e90\u7684\u90a3\u4e00\u523b\u8d77\uff0c\u5185\u5b58\u5c31\u5f00\u59cb\u5de5\u4f5c\u4e86\uff0c\u5f53\u7136\u5176\u4ed6\u786c\u4ef6\u4e5f\u5728\u5de5\u4f5c\uff0c\u4f46\u662f\u5185\u5b58\u4f1a\u52a0\u8f7d\u5f88\u591a\u7684\u91cd\u8981\u6570\u636e\uff0c\u5982\u64cd\u4f5c\u7cfb\u7edf\u7684\u52a0\u8f7d\u3001\u9884\u542f\u52a8\u7a0b\u5e8f\u7684\u52a0\u8f7d\u3001\u6b63\u5e38\u8fd0\u884c\u65f6\u7a0b\u5e8f\u7a0b\u5e8f\u7684\u52a0\u8f7d\u7b49\u7b49\u3002 \u3000\u3000 \u5185\u5b58\u53d6\u8bc1\u7684\u4e00\u4e2a\u7279\u70b9\u5c31\u662f\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u6e05\u6670\u7684\u9014\u5f84\u6765\u8ba9\u4eba\u4eec\u5bf9\u8ba1\u7b97\u673a\u5b9e\u65f6\u7684\u72b6\u6001\u8fdb\u884c\u53d6\u8bc1\uff0c\u5982\u5f53\u65f6\u7684\u8fdb\u7a0b\u60c5\u51b5\u3001\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5\u3001\u6267\u884c\u8fc7\u7684\u547d\u4ee4\u7b49\u7b49 \uff0c\u8fd9\u5bf9\u63d0\u53d6\u4e00\u4e9b\u6728\u9a6c\u7a0b\u5e8f\u7b49\u6076\u610f\u7a0b\u5e8f\u662f\u6709\u5f88\u5927\u5e2e\u52a9\u7684\uff0c\u9664\u6b64\u4e4b\u5916\uff0c\u4f60\u751a\u81f3\u53ef\u4ee5\u4ece\u5185\u5b58\u4e2d\u53d6\u51fa\u4e00\u4e9b\u5bc6\u7801\u4fe1\u606f\uff0c\u5982mimikatz\u5c31\u662f\u8fd9\u4e48\u5e72\u7684\u3002 \u3000\u3000 Volatility\u7b80\u4ecb \u00b6 Volatility\u662f\u4e00\u4e2a\u7528\u4e8e\u5185\u5b58\u53d6\u8bc1\u7684\u6846\u67b6\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u591a\u79cd\u6a21\u5757\uff0c\u652f\u6301\u5e02\u9762\u5e38\u89c1\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002 \u3000\u3000\u4e0b\u9762\u7b80\u5355\u6d4f\u89c8\u4e00\u4e0b\u5927\u6982\u754c\u9762\u548c\u5e38\u7528\u6a21\u5757\uff1a \u3000\u3000 \u3000\u3000\u8fd9\u662fvolatility\u7684\u4e3b\u9875\u9762\uff0c\u4e5f\u6709GUI\u7684exe\u7248\u672c\uff0c\u4f46\u662f\u6ca1\u6709Python\u7248\u7684\u6269\u5c55\u6027\u5f3a(\u5982\u96c6\u6210mimikatz) \u3000\u3000\u4e0b\u9762\u5217\u51fa\u5e38\u7528\u7684\u6a21\u5757\uff1a imageinfo\uff1a\u663e\u793a\u76ee\u6807\u955c\u50cf\u7684\u6458\u8981\u4fe1\u606f\uff0c\u8fd9\u5e38\u5e38\u662f\u7b2c\u4e00\u6b65---\u83b7\u53d6\u5185\u5b58\u7684\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u53ca\u7248\u672c\uff0c\u4e4b\u540e\u53ef\u4ee5\u5728 \u2013profile \u4e2d\u5e26\u4e0a\u5bf9\u5e94\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u540e\u7eed\u64cd\u4f5c\u90fd\u8981\u5e26\u4e0a\u8fd9\u4e00\u53c2\u6570 pslist\uff1a\u8be5\u63d2\u4ef6\u5217\u4e3e\u51fa\u7cfb\u7edf\u8fdb\u7a0b\uff0c\u4f46\u5b83\u4e0d\u80fd\u68c0\u6d4b\u5230\u9690\u85cf\u6216\u8005\u89e3\u94fe\u7684\u8fdb\u7a0b\uff0cpsscan\u53ef\u4ee5 psscan\uff1a\u53ef\u4ee5\u627e\u5230\u5148\u524d\u5df2\u7ec8\u6b62(\u4e0d\u6d3b\u52a8)\u7684\u8fdb\u7a0b\u4ee5\u53ca\u88abrootkit\u9690\u85cf\u6216\u89e3\u94fe\u7684\u8fdb\u7a0b pstree\uff1a\u4ee5\u6811\u7684\u5f62\u5f0f\u67e5\u770b\u8fdb\u7a0b\u5217\u8868\uff0c\u548cpslist\u4e00\u6837\uff0c\u4e5f\u65e0\u6cd5\u68c0\u6d4b\u9690\u85cf\u6216\u89e3\u94fe\u7684\u8fdb\u7a0b mendump\uff1a\u63d0\u53d6\u51fa\u6307\u5b9a\u8fdb\u7a0b\uff0c\u5e38\u7528foremost \u6765\u5206\u79bb\u91cc\u9762\u7684\u6587\u4ef6(\u5386\u5e74\u7f8e\u4e9a\u676f\u6709\u6b64\u9898) filescan\uff1a\u626b\u63cf\u6240\u6709\u7684\u6587\u4ef6\u5217\u8868 hashdump\uff1a\u67e5\u770b\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684 password hash\uff0c\u4f8b\u5982 Windows \u7684 SAM \u6587\u4ef6\u5185\u5bb9(\u5b9e\u9645\u4e2d\u6ca1\u6709mimikatz\u6548\u679c\u597d) svcscan\uff1a\u626b\u63cf Windows \u7684\u670d\u52a1 connscan\uff1a\u67e5\u770b\u7f51\u7edc\u8fde\u63a5 cmdscan\uff1a\u53ef\u7528\u4e8e\u67e5\u770b\u7ec8\u7aef\u8bb0\u5f55 dlllist: \u5217\u51fa\u67d0\u4e00\u8fdb\u7a0b\u52a0\u8f7d\u7684\u6240\u6709dll\u6587\u4ef6 dumpfiles\uff1a\u5bfc\u51fa\u67d0\u4e00\u6587\u4ef6(\u6307\u5b9a\u865a\u62df\u5730\u5740) hivelist: \u5217\u51fa\u6240\u6709\u7684\u6ce8\u518c\u8868\u9879\u53ca\u5176\u865a\u62df\u5730\u5740\u548c\u7269\u7406\u5730\u5740 timeliner: \u5c06\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\u4e8b\u4ef6\u4ee5\u65f6\u95f4\u7ebf\u7684\u65b9\u5f0f\u5c55\u5f00 2019\u7f8e\u4e9a\u676f\u5185\u5b58\u53d6\u8bc1\u90e8\u4f8b\u9898 \u00b6 \u8fd9\u91cc\u6211\u9009\u4e86\u51e0\u4e2a\u7b80\u5355\u7684\u548c\u51e0\u4e2a\u793a\u4f8b\u6027\u7684\u4f8b\u9898\uff0c\u4f5c\u4e3a\u53c2\u8003\uff0c\u9898\u76ee\u6765\u6e90\u4e3a2019\u5e74\u7684\u7f8e\u4e9a\u676f\u4e2a\u4eba\u8d5b\u3002 \u3000\u3000 \u3000\u30001. \u4f8b\u98981 \u3000\u3000 \u3000\u3000\u8fd9\u9053\u9898\u51fa\u4e86\u57fa\u672c\u5c31\u662f\u7b2c\u4e00\u9898\uff0c\u56e0\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u53ca\u786c\u4ef6\u67b6\u6784\u8fd9\u4e00\u4fe1\u606f\u662f\u5fc5\u8981\u7684\u3002\u4f7f\u7528 imageinfo \u6a21\u5757\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e4b\u540evolatility\u4f1a\u7ed9\u51fa\u51e0\u4e2a\u7ed3\u679c\uff0c\u5176\u4e2d\u4e00\u822c\u7b2c\u4e00\u4e2a\u5c31\u662f\u5bf9\u7684\uff0c\u4e0d\u5bf9\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u5c1d\u8bd5\u5176\u4ed6\u53ef\u80fd\uff0c\u6b63\u786e\u7684\u6807\u5fd7\u5c31\u662f\u4f60\u4f7f\u7528\u8fd9\u4e2a profile \u53ef\u4ee5\u8c03\u7528\u6a21\u5757\u4e86\uff0c\u9519\u8bef\u7684 profile \u662f\u4e0d\u80fd\u6b63\u5e38\u4f7f\u7528\u6a21\u5757\u7684\u3002\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000 \u3000\u30002. \u4f8b\u98982 \u3000\u3000 \u3000\u3000\u67e5\u8be2\u8fdb\u7a0b\u4fe1\u606f\u4f7f\u7528 pslist \u6a21\u5757\uff0c\u8fd9\u91cc\u4f1a\u5217\u51fa\u7cfb\u7edf\u8fdb\u7a0b\u7684PID\u3001PPID\u3001\u65f6\u95f4\u7b49\u7b49\u4fe1\u606f\u3002\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000 \u3000\u30003. \u4f8b\u98983 \u3000\u3000 \u3000\u3000\u67e5\u770b\u5f53\u524d\u7684\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5\u53ef\u4ee5\u4f7f\u7528 netscan \u6a21\u5757\uff0c\u8be5\u6a21\u5757\u4f1a\u5217\u51fa\u6240\u6709\u5b9e\u65f6\u7684\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f\uff0c\u5305\u62ec\u4f7f\u7528\u7684\u534f\u8bae\u7c7b\u578b\u3001\u6e90\u5730\u5740\u3001\u76ee\u7684\u5730\u5740\u3001\u53cc\u65b9\u7684\u7aef\u53e3\u53f7\u3001\u8fde\u63a5\u72b6\u6001(LISTENING\u3001CLOSED\u7b49)\u3002\u7ed3\u679c\uff1a \u3000\u3000 4. \u4f8b\u98984 \u3000\u3000 \u3000\u3000\u5185\u5b58\u53d6\u8bc1\u4e2d\u7684\u4e00\u4e2a\u91cd\u8981\u6b65\u9aa4\u5c31\u662f\u89e3\u6790\u6ce8\u518c\u8868\uff0cWindos\u6ce8\u518c\u8868\u4f1a\u5e2e\u52a9\u4f60\u83b7\u5f97\u5f88\u591a\u9690\u85cf\u7684\u4fe1\u606f\u4ee5\u53ca\u4e00\u4e9b\u91cd\u8981\u7684\u4fe1\u606f(\u5982\u8f6f\u4ef6\u4fe1\u606f\u3001\u7cfb\u7edf\u4fe1\u606f\u3001\u786c\u4ef6\u4fe1\u606f\u7b49\u7b49)\uff0c\u5982\u8fd9\u4e2a\u9898\u4e2d\u7684 SAM \u6587\u4ef6\u4e2d\u5c31\u50a8\u5b58\u7740\u52a0\u5bc6\u7684\u8d26\u6237\u5bc6\u7801\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6ce8\u518c\u8868\u9879\u6709\u52a9\u4e8e\u6211\u4eec\u83b7\u53d6\u5bc6\u7801(\u5982hashdump\u6a21\u5757)\u3002\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000 \u3000\u30005. \u4f8b\u98985 \u3000\u3000 \u3000\u3000\u56e0\u4e3a\u5728\u4f8b\u9898\u4e09\u4e2d\u6211\u4eec\u770b\u5230\u4ed6\u8bbf\u95ee\u4e86\u540c\u4e00\u7f51\u6bb5\u4e0a\u7684\u4e00\u53f0\u673a\u5668\u4e0a\u7684SMB\u670d\u52a1(445\u7aef\u53e3)\uff0c\u6240\u4ee5\u731c\u6d4b\u76d8\u7b26E\u5b9e\u9645\u4e0a\u4f4d\u4e8e\u90a3\u53f0\u673a\u5668\u4e0a\uff0c\u5e76\u4e14\u8003\u8651\u5230\u7275\u626f\u65f6\u95f4\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u4f7f\u7528 timeliner \u6a21\u5757\uff0c\u8be5\u6a21\u5757\u4f1a\u4ee5\u65f6\u95f4\u7ebf\u7684\u65b9\u5f0f\uff0c\u5217\u51fa\u8ba1\u7b97\u673a\u6240\u6709\u6d3b\u52a8\u3002 \u3000\u3000\u53ef\u4ee5\u770b\u52302019-10-31 06:59:45\u65f6\uff0c\u4f7f\u7528\u4e86explorer.exe\u6587\u4ef6\u7ba1\u7406\u5668\uff0c\u4ee5TMP_User\u7684\u8eab\u4efd\u8bbf\u95ee\u4e86E\u76d8\u4e0a \u7684Personal Information.xlsx\u3002 \u3000\u3000 \u3000\u3000 \u3000\u30006. \u4f8b\u98986 \u3000\u3000 \u3000\u3000 \u672c\u9898\u662f\u7f8e\u4e9a\u676f\u7b2c\u4e00\u6b21\u5728\u5185\u5b58\u53d6\u8bc1\u90e8\u5206\u6d89\u53ca\u786c\u4ef6\u4fe1\u606f\u7684\u641c\u5bfb\uff0c\u4ee5\u540e\u5e94\u591a\u52a0\u8bad\u7ec3 \uff0c\u5b9e\u9645\u4e0a\u672c\u9898\u662f\u5bf9\u6ce8\u518c\u8868\u7684\u89e3\u6790\uff0c\u56e0\u4e3aUSB\u8bbe\u5907\u7684\u4fe1\u606f\u5b9e\u9645\u4e0a\u4f1a\u5728\u9996\u6b21\u4f7f\u7528\u65f6\u88ab\u8bb0\u5f55\u81f3\u6ce8\u518c\u8868\u4e2d\uff0c\u4e0b\u9762\u65f6\u5206\u6790\u8fc7\u7a0b\uff1a \u3000\u3000\u5148\u4f7f\u7528 svcscan \u6a21\u5757\u8fdb\u884c\u670d\u52a1\u7684\u626b\u63cf\uff1a \u3000\u3000 \u3000\u3000\u53ef\u4ee5\u770b\u5230USB\u7684\u76f8\u5173\u670d\u52a1\uff0c\u53ef\u4ee5\u786e\u5b9a\u6709USB\u8bbe\u5907\u3002 \u3000\u3000 \u3000\u3000\u4f7f\u7528 hivelist \u6a21\u5757\u7ed3\u5408 printKey \u6a21\u5757\u8fdb\u884c\u6ce8\u518c\u8868\u9879\u7684\u67e5\u627e\uff0c\u5728\u4e0b\u5217\u8868\u9879\u4e2d\u53ef\u4ee5\u770b\u5230USB\u8bbe\u5907\u7684\u8be6\u7ec6\u4fe1\u606f\u4e3a\u5e0c\u6377\u7684\u8bbe\u5907\uff1a \u3000\u3000 \u6700\u7ec8\u53ef\u4ee5\u5728\u6ce8\u518c\u8868\u4e2d\u770b\u5927\u8be5\u8bbe\u5907\u7684GUID\uff0c\u6700\u7ec8\u6392\u9664\u6539\u8be5\u9009\u9879\u5f97\u51fa\u7b54\u6848\u4e3aE\u9009\u9879: \u3000\u3000 \u3000\u3000 \u7ed3\u675f\u8bed \u00b6 \u672c\u7bc7\u53ea\u662f\u5bf9\u5185\u5b58\u53d6\u8bc1\u505a\u7b80\u5355\u4ecb\u7ecd\uff0c\u4ee5\u53ca2019\u7f8e\u4e9a\u676f\u5185\u5b58\u53d6\u8bc1\u90e8\u5206\u4f8b\u9898\u7684\u4e00\u4e2a\u7b80\u5355\u6d4f\u89c8\uff0c\u540e\u7eed\u4f1a\u66f4\u65b0\u8be6\u7ec6\u7684\u5173\u4e8e\u5185\u5b58\u53d6\u8bc1\u65b9\u9762\u7684\u535a\u5ba2\u3002 \u3000\u3000 \u53c2\u8003\u5b66\u4e60\u94fe\u63a5 \u00b6 \u6d45\u8c08\u5185\u5b58\u53d6\u8bc1 \u300aThe Art Of Memeory Forensics\u300b","title":"\u5185\u5b58\u53d6\u8bc1\u539f\u7406\u5b66\u4e60\u53caVolatility - \u7bc7\u4e00"},{"location":"ram/#_1","text":"\u5148\u7ed9\u51fa\u5b98\u65b9\u7684\u6307\u5bfc\u6307\u5357 \u300aThe Art Of Memeory Forensics\u300b \u4e00\u4e66\u4e2d\u7ed9\u51fa\u7684\u4ecb\u7ecd(\u540e\u9762\u4f1a\u7ed9\u51fa\u4e0b\u8f7d\u5730\u5740)\uff0c\u4e2a\u4eba\u8ba4\u4e3a\u975e\u5e38\u6e05\u6670\uff1a Memory forensics is arguably the most fruitful, interesting, and provocative realm of digital forensics. Each function performed by an operating system or applica- tion results in specific modifications to the computer\u2019s memory (RAM), which can often persist a long time after the action, essentially preserving them. Additionally, memory forensics provides unprecedented visibility into the runtime state of the system, such as which processes were running, open network connections, and recently executed com- mands. You can extract these artifacts in a manner that is completely independent of the system you are investigating, reducing the chance that malware or rootkits can interfere with your results. Critical data often exists exclusively in memory, such as disk encryp- tion keys, memory-resident injected code fragments, off-the-record chat messages, unen- crypted e-mail messages, and non-cacheable Internet history records. \u3000\u3000\u4ece\u4f60\u6309\u4e0b\u8ba1\u7b97\u673a\u7535\u6e90\u7684\u90a3\u4e00\u523b\u8d77\uff0c\u5185\u5b58\u5c31\u5f00\u59cb\u5de5\u4f5c\u4e86\uff0c\u5f53\u7136\u5176\u4ed6\u786c\u4ef6\u4e5f\u5728\u5de5\u4f5c\uff0c\u4f46\u662f\u5185\u5b58\u4f1a\u52a0\u8f7d\u5f88\u591a\u7684\u91cd\u8981\u6570\u636e\uff0c\u5982\u64cd\u4f5c\u7cfb\u7edf\u7684\u52a0\u8f7d\u3001\u9884\u542f\u52a8\u7a0b\u5e8f\u7684\u52a0\u8f7d\u3001\u6b63\u5e38\u8fd0\u884c\u65f6\u7a0b\u5e8f\u7a0b\u5e8f\u7684\u52a0\u8f7d\u7b49\u7b49\u3002 \u3000\u3000 \u5185\u5b58\u53d6\u8bc1\u7684\u4e00\u4e2a\u7279\u70b9\u5c31\u662f\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u6e05\u6670\u7684\u9014\u5f84\u6765\u8ba9\u4eba\u4eec\u5bf9\u8ba1\u7b97\u673a\u5b9e\u65f6\u7684\u72b6\u6001\u8fdb\u884c\u53d6\u8bc1\uff0c\u5982\u5f53\u65f6\u7684\u8fdb\u7a0b\u60c5\u51b5\u3001\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5\u3001\u6267\u884c\u8fc7\u7684\u547d\u4ee4\u7b49\u7b49 \uff0c\u8fd9\u5bf9\u63d0\u53d6\u4e00\u4e9b\u6728\u9a6c\u7a0b\u5e8f\u7b49\u6076\u610f\u7a0b\u5e8f\u662f\u6709\u5f88\u5927\u5e2e\u52a9\u7684\uff0c\u9664\u6b64\u4e4b\u5916\uff0c\u4f60\u751a\u81f3\u53ef\u4ee5\u4ece\u5185\u5b58\u4e2d\u53d6\u51fa\u4e00\u4e9b\u5bc6\u7801\u4fe1\u606f\uff0c\u5982mimikatz\u5c31\u662f\u8fd9\u4e48\u5e72\u7684\u3002","title":"\u5185\u5b58\u53d6\u8bc1\u5b9a\u4e49\u53ca\u5176\u7279\u70b9"},{"location":"ram/#volatility","text":"Volatility\u662f\u4e00\u4e2a\u7528\u4e8e\u5185\u5b58\u53d6\u8bc1\u7684\u6846\u67b6\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u591a\u79cd\u6a21\u5757\uff0c\u652f\u6301\u5e02\u9762\u5e38\u89c1\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002 \u3000\u3000\u4e0b\u9762\u7b80\u5355\u6d4f\u89c8\u4e00\u4e0b\u5927\u6982\u754c\u9762\u548c\u5e38\u7528\u6a21\u5757\uff1a \u3000\u3000 \u3000\u3000\u8fd9\u662fvolatility\u7684\u4e3b\u9875\u9762\uff0c\u4e5f\u6709GUI\u7684exe\u7248\u672c\uff0c\u4f46\u662f\u6ca1\u6709Python\u7248\u7684\u6269\u5c55\u6027\u5f3a(\u5982\u96c6\u6210mimikatz) \u3000\u3000\u4e0b\u9762\u5217\u51fa\u5e38\u7528\u7684\u6a21\u5757\uff1a imageinfo\uff1a\u663e\u793a\u76ee\u6807\u955c\u50cf\u7684\u6458\u8981\u4fe1\u606f\uff0c\u8fd9\u5e38\u5e38\u662f\u7b2c\u4e00\u6b65---\u83b7\u53d6\u5185\u5b58\u7684\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u53ca\u7248\u672c\uff0c\u4e4b\u540e\u53ef\u4ee5\u5728 \u2013profile \u4e2d\u5e26\u4e0a\u5bf9\u5e94\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u540e\u7eed\u64cd\u4f5c\u90fd\u8981\u5e26\u4e0a\u8fd9\u4e00\u53c2\u6570 pslist\uff1a\u8be5\u63d2\u4ef6\u5217\u4e3e\u51fa\u7cfb\u7edf\u8fdb\u7a0b\uff0c\u4f46\u5b83\u4e0d\u80fd\u68c0\u6d4b\u5230\u9690\u85cf\u6216\u8005\u89e3\u94fe\u7684\u8fdb\u7a0b\uff0cpsscan\u53ef\u4ee5 psscan\uff1a\u53ef\u4ee5\u627e\u5230\u5148\u524d\u5df2\u7ec8\u6b62(\u4e0d\u6d3b\u52a8)\u7684\u8fdb\u7a0b\u4ee5\u53ca\u88abrootkit\u9690\u85cf\u6216\u89e3\u94fe\u7684\u8fdb\u7a0b pstree\uff1a\u4ee5\u6811\u7684\u5f62\u5f0f\u67e5\u770b\u8fdb\u7a0b\u5217\u8868\uff0c\u548cpslist\u4e00\u6837\uff0c\u4e5f\u65e0\u6cd5\u68c0\u6d4b\u9690\u85cf\u6216\u89e3\u94fe\u7684\u8fdb\u7a0b mendump\uff1a\u63d0\u53d6\u51fa\u6307\u5b9a\u8fdb\u7a0b\uff0c\u5e38\u7528foremost \u6765\u5206\u79bb\u91cc\u9762\u7684\u6587\u4ef6(\u5386\u5e74\u7f8e\u4e9a\u676f\u6709\u6b64\u9898) filescan\uff1a\u626b\u63cf\u6240\u6709\u7684\u6587\u4ef6\u5217\u8868 hashdump\uff1a\u67e5\u770b\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684 password hash\uff0c\u4f8b\u5982 Windows \u7684 SAM \u6587\u4ef6\u5185\u5bb9(\u5b9e\u9645\u4e2d\u6ca1\u6709mimikatz\u6548\u679c\u597d) svcscan\uff1a\u626b\u63cf Windows \u7684\u670d\u52a1 connscan\uff1a\u67e5\u770b\u7f51\u7edc\u8fde\u63a5 cmdscan\uff1a\u53ef\u7528\u4e8e\u67e5\u770b\u7ec8\u7aef\u8bb0\u5f55 dlllist: \u5217\u51fa\u67d0\u4e00\u8fdb\u7a0b\u52a0\u8f7d\u7684\u6240\u6709dll\u6587\u4ef6 dumpfiles\uff1a\u5bfc\u51fa\u67d0\u4e00\u6587\u4ef6(\u6307\u5b9a\u865a\u62df\u5730\u5740) hivelist: \u5217\u51fa\u6240\u6709\u7684\u6ce8\u518c\u8868\u9879\u53ca\u5176\u865a\u62df\u5730\u5740\u548c\u7269\u7406\u5730\u5740 timeliner: \u5c06\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\u4e8b\u4ef6\u4ee5\u65f6\u95f4\u7ebf\u7684\u65b9\u5f0f\u5c55\u5f00","title":"Volatility\u7b80\u4ecb"},{"location":"ram/#2019","text":"\u8fd9\u91cc\u6211\u9009\u4e86\u51e0\u4e2a\u7b80\u5355\u7684\u548c\u51e0\u4e2a\u793a\u4f8b\u6027\u7684\u4f8b\u9898\uff0c\u4f5c\u4e3a\u53c2\u8003\uff0c\u9898\u76ee\u6765\u6e90\u4e3a2019\u5e74\u7684\u7f8e\u4e9a\u676f\u4e2a\u4eba\u8d5b\u3002 \u3000\u3000 \u3000\u30001. \u4f8b\u98981 \u3000\u3000 \u3000\u3000\u8fd9\u9053\u9898\u51fa\u4e86\u57fa\u672c\u5c31\u662f\u7b2c\u4e00\u9898\uff0c\u56e0\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u53ca\u786c\u4ef6\u67b6\u6784\u8fd9\u4e00\u4fe1\u606f\u662f\u5fc5\u8981\u7684\u3002\u4f7f\u7528 imageinfo \u6a21\u5757\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e4b\u540evolatility\u4f1a\u7ed9\u51fa\u51e0\u4e2a\u7ed3\u679c\uff0c\u5176\u4e2d\u4e00\u822c\u7b2c\u4e00\u4e2a\u5c31\u662f\u5bf9\u7684\uff0c\u4e0d\u5bf9\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u5c1d\u8bd5\u5176\u4ed6\u53ef\u80fd\uff0c\u6b63\u786e\u7684\u6807\u5fd7\u5c31\u662f\u4f60\u4f7f\u7528\u8fd9\u4e2a profile \u53ef\u4ee5\u8c03\u7528\u6a21\u5757\u4e86\uff0c\u9519\u8bef\u7684 profile \u662f\u4e0d\u80fd\u6b63\u5e38\u4f7f\u7528\u6a21\u5757\u7684\u3002\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000 \u3000\u30002. \u4f8b\u98982 \u3000\u3000 \u3000\u3000\u67e5\u8be2\u8fdb\u7a0b\u4fe1\u606f\u4f7f\u7528 pslist \u6a21\u5757\uff0c\u8fd9\u91cc\u4f1a\u5217\u51fa\u7cfb\u7edf\u8fdb\u7a0b\u7684PID\u3001PPID\u3001\u65f6\u95f4\u7b49\u7b49\u4fe1\u606f\u3002\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000 \u3000\u30003. \u4f8b\u98983 \u3000\u3000 \u3000\u3000\u67e5\u770b\u5f53\u524d\u7684\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5\u53ef\u4ee5\u4f7f\u7528 netscan \u6a21\u5757\uff0c\u8be5\u6a21\u5757\u4f1a\u5217\u51fa\u6240\u6709\u5b9e\u65f6\u7684\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f\uff0c\u5305\u62ec\u4f7f\u7528\u7684\u534f\u8bae\u7c7b\u578b\u3001\u6e90\u5730\u5740\u3001\u76ee\u7684\u5730\u5740\u3001\u53cc\u65b9\u7684\u7aef\u53e3\u53f7\u3001\u8fde\u63a5\u72b6\u6001(LISTENING\u3001CLOSED\u7b49)\u3002\u7ed3\u679c\uff1a \u3000\u3000 4. \u4f8b\u98984 \u3000\u3000 \u3000\u3000\u5185\u5b58\u53d6\u8bc1\u4e2d\u7684\u4e00\u4e2a\u91cd\u8981\u6b65\u9aa4\u5c31\u662f\u89e3\u6790\u6ce8\u518c\u8868\uff0cWindos\u6ce8\u518c\u8868\u4f1a\u5e2e\u52a9\u4f60\u83b7\u5f97\u5f88\u591a\u9690\u85cf\u7684\u4fe1\u606f\u4ee5\u53ca\u4e00\u4e9b\u91cd\u8981\u7684\u4fe1\u606f(\u5982\u8f6f\u4ef6\u4fe1\u606f\u3001\u7cfb\u7edf\u4fe1\u606f\u3001\u786c\u4ef6\u4fe1\u606f\u7b49\u7b49)\uff0c\u5982\u8fd9\u4e2a\u9898\u4e2d\u7684 SAM \u6587\u4ef6\u4e2d\u5c31\u50a8\u5b58\u7740\u52a0\u5bc6\u7684\u8d26\u6237\u5bc6\u7801\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6ce8\u518c\u8868\u9879\u6709\u52a9\u4e8e\u6211\u4eec\u83b7\u53d6\u5bc6\u7801(\u5982hashdump\u6a21\u5757)\u3002\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000 \u3000\u30005. \u4f8b\u98985 \u3000\u3000 \u3000\u3000\u56e0\u4e3a\u5728\u4f8b\u9898\u4e09\u4e2d\u6211\u4eec\u770b\u5230\u4ed6\u8bbf\u95ee\u4e86\u540c\u4e00\u7f51\u6bb5\u4e0a\u7684\u4e00\u53f0\u673a\u5668\u4e0a\u7684SMB\u670d\u52a1(445\u7aef\u53e3)\uff0c\u6240\u4ee5\u731c\u6d4b\u76d8\u7b26E\u5b9e\u9645\u4e0a\u4f4d\u4e8e\u90a3\u53f0\u673a\u5668\u4e0a\uff0c\u5e76\u4e14\u8003\u8651\u5230\u7275\u626f\u65f6\u95f4\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u4f7f\u7528 timeliner \u6a21\u5757\uff0c\u8be5\u6a21\u5757\u4f1a\u4ee5\u65f6\u95f4\u7ebf\u7684\u65b9\u5f0f\uff0c\u5217\u51fa\u8ba1\u7b97\u673a\u6240\u6709\u6d3b\u52a8\u3002 \u3000\u3000\u53ef\u4ee5\u770b\u52302019-10-31 06:59:45\u65f6\uff0c\u4f7f\u7528\u4e86explorer.exe\u6587\u4ef6\u7ba1\u7406\u5668\uff0c\u4ee5TMP_User\u7684\u8eab\u4efd\u8bbf\u95ee\u4e86E\u76d8\u4e0a \u7684Personal Information.xlsx\u3002 \u3000\u3000 \u3000\u3000 \u3000\u30006. \u4f8b\u98986 \u3000\u3000 \u3000\u3000 \u672c\u9898\u662f\u7f8e\u4e9a\u676f\u7b2c\u4e00\u6b21\u5728\u5185\u5b58\u53d6\u8bc1\u90e8\u5206\u6d89\u53ca\u786c\u4ef6\u4fe1\u606f\u7684\u641c\u5bfb\uff0c\u4ee5\u540e\u5e94\u591a\u52a0\u8bad\u7ec3 \uff0c\u5b9e\u9645\u4e0a\u672c\u9898\u662f\u5bf9\u6ce8\u518c\u8868\u7684\u89e3\u6790\uff0c\u56e0\u4e3aUSB\u8bbe\u5907\u7684\u4fe1\u606f\u5b9e\u9645\u4e0a\u4f1a\u5728\u9996\u6b21\u4f7f\u7528\u65f6\u88ab\u8bb0\u5f55\u81f3\u6ce8\u518c\u8868\u4e2d\uff0c\u4e0b\u9762\u65f6\u5206\u6790\u8fc7\u7a0b\uff1a \u3000\u3000\u5148\u4f7f\u7528 svcscan \u6a21\u5757\u8fdb\u884c\u670d\u52a1\u7684\u626b\u63cf\uff1a \u3000\u3000 \u3000\u3000\u53ef\u4ee5\u770b\u5230USB\u7684\u76f8\u5173\u670d\u52a1\uff0c\u53ef\u4ee5\u786e\u5b9a\u6709USB\u8bbe\u5907\u3002 \u3000\u3000 \u3000\u3000\u4f7f\u7528 hivelist \u6a21\u5757\u7ed3\u5408 printKey \u6a21\u5757\u8fdb\u884c\u6ce8\u518c\u8868\u9879\u7684\u67e5\u627e\uff0c\u5728\u4e0b\u5217\u8868\u9879\u4e2d\u53ef\u4ee5\u770b\u5230USB\u8bbe\u5907\u7684\u8be6\u7ec6\u4fe1\u606f\u4e3a\u5e0c\u6377\u7684\u8bbe\u5907\uff1a \u3000\u3000 \u6700\u7ec8\u53ef\u4ee5\u5728\u6ce8\u518c\u8868\u4e2d\u770b\u5927\u8be5\u8bbe\u5907\u7684GUID\uff0c\u6700\u7ec8\u6392\u9664\u6539\u8be5\u9009\u9879\u5f97\u51fa\u7b54\u6848\u4e3aE\u9009\u9879:","title":"2019\u7f8e\u4e9a\u676f\u5185\u5b58\u53d6\u8bc1\u90e8\u4f8b\u9898"},{"location":"ram/#_2","text":"\u672c\u7bc7\u53ea\u662f\u5bf9\u5185\u5b58\u53d6\u8bc1\u505a\u7b80\u5355\u4ecb\u7ecd\uff0c\u4ee5\u53ca2019\u7f8e\u4e9a\u676f\u5185\u5b58\u53d6\u8bc1\u90e8\u5206\u4f8b\u9898\u7684\u4e00\u4e2a\u7b80\u5355\u6d4f\u89c8\uff0c\u540e\u7eed\u4f1a\u66f4\u65b0\u8be6\u7ec6\u7684\u5173\u4e8e\u5185\u5b58\u53d6\u8bc1\u65b9\u9762\u7684\u535a\u5ba2\u3002","title":"\u7ed3\u675f\u8bed"},{"location":"ram/#_3","text":"\u6d45\u8c08\u5185\u5b58\u53d6\u8bc1 \u300aThe Art Of Memeory Forensics\u300b","title":"\u53c2\u8003\u5b66\u4e60\u94fe\u63a5"},{"location":"ram2/","text":"Windows\u5185\u5b58\u53d6\u8bc1\u90e8\u5206 (\u4e00) \u51c6\u5907\u5de5\u4f5c \u00b6 \u4e0a\u4e00\u7bc7\u4e2d\u5927\u6982\u4ecb\u7ecd\u4e86\u4e00\u4e0bVolatility\u7684\u7528\u6cd5\uff0c\u56e0\u4e3a\u76ee\u524d\u8f83\u4e3a\u6210\u719f\u7684\u5185\u5b58\u53d6\u8bc1\u4e66\u5c31\u53ea\u6709\u90a3\u672c*The Art Of Memory Forensics*\uff0c\u6240\u4ee5\u8fd9\u4e00\u7bc7\u5f00\u59cb\u4f1a\u8ddf\u7740\u8bfe\u672c\uff0c\u4ee5\u5b66\u4e60\u4e3a\u7b2c\u4e00\u76ee\u7684\uff0c\u7cfb\u7edf\u6027\u7684\u5b66\u4e60\u5185\u5b58\u53d6\u8bc1\u3002 \u3000\u3000\u5b98\u65b9\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u8f85\u52a9\u5b66\u4e60\u7684\u8d44\u6599\uff0c\u4e0b\u9762\u662f\u6211\u6536\u96c6\u5230\u7684\u8d44\u6e90\uff0c\u81ea\u884c\u4e0b\u8f7d\u5b66\u4e60\u3002 \u3000\u3000 \u6240\u9700\u4e66\u672c \u3000\u3000 \u5b98\u65b9\u5185\u5b58\u6837\u672c\u4ee5\u53ca\u8d44\u6599 \uff0c\u63d0\u53d6\u7801\uff1ay2mu \u3000\u3000 Windbg\u4e0b\u8f7d\u5730\u5740 \u3000\u3000\u6b64\u5916\u6700\u597d\u81ea\u5df1\u88c5\u4e00\u4e2awindows\u865a\u62df\u673a\uff0c\u6bd4\u5982win7\u7b49\uff0c\u5e76\u914d\u7f6e\u6240\u9700\u5de5\u5177\u3002 \u600e\u4e48\u6293\u53d6\u5185\u5b58 \u00b6 \u4f60\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u5f0f\u4ece\u81ea\u5df1\u7684\u5b9e\u4f53\u673a\u6216\u865a\u62df\u673a\u4e2d\u6293\u53d6\u5185\u5b58\u6765\u81ea\u5df1\u5206\u6790\uff0c\u6216\u8005\u7528\u4e0a\u9762\u6211\u63d0\u4f9b\u7684\u94fe\u63a5\u6765\u4e0b\u8f7d\u5b98\u65b9\u7684\u955c\u50cf\u6837\u672c\u3002\u5de5\u5177\u5f88\u591a\uff0c\u8fd9\u91cc\u63d0\u4f9b\u5e38\u7528\u7684\u4e09\u79cd\u65b9\u6cd5\uff1a \u4f7f\u7528VMWare \u00b6 \u5982\u679c\u4f60\u4f7f\u7528\u7684\u662fVmware\u6765\u505a\u8bd5\u9a8c\u7684\u8bdd\uff0c\u53ea\u9700\u8981\u5c06\u865a\u62df\u673a\u6682\u505c\uff0c\u6216\u8005\u521b\u5efa\u5feb\u7167\uff0c\u5c31\u53ef\u4ee5\u5728\u5bf9\u5e94\u76ee\u5f55\u4e0b\u627e\u5230vmem\u6587\u4ef6\u4e86(\u865a\u62df\u5185\u5b58\u6587\u4ef6)\u3002\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u3000\u3000 \u4f7f\u7528DumpIt \u00b6 \u8fd9\u4e2a\u66f4\u65e0\u8111\uff0c\u514d\u5b89\u88c5\uff0c\u76f4\u63a5\u653e\u5230\u5bf9\u65b9\u673a\u5668\uff0c\u6572\u4e2ay\u5b8c\u4e8b\u4e86\u3002\u5f97\u5230\u7684\u7ed3\u679c\u662f\u4e00\u4e2araw\u6587\u4ef6\uff0c\u5177\u4f53\u7528\u6cd5\u548c\u4e0b\u8f7d\u5730\u5740 \u770b\u8fd9\u91cc \uff0c\u5982\u56fe\u5c31\u662f\u6293\u53d6\u5b8c\u6210\uff1a \u3000\u3000 \u3000\u3000 \u4f7f\u7528AccessData FTK Imager \u00b6 \u6253\u5f00FTK\uff0cFile\u9009\u9879\u4e2d\u6709\u6293\u53d6\u5185\u5b58\u7684\u529f\u80fd\uff1a \u3000\u3000 Windows Object And Pool Allocation (Windows\u5bf9\u8c61\u548c\u6c60\u5206\u914d) \u00b6 Windows Executive Objects (Windows \u6267\u884c\u4f53\u5bf9\u8c61) \u00b6 \u5f88\u591a\u5185\u5b58\u5206\u6790\u6848\u4f8b\u4e2d\u90fd\u4f1a\u7275\u626f\u5230\u5206\u6790\u6267\u884c\u4f53\u5bf9\u8c61\uff0c\u5728windows\u4e2d\u4f1a\u6709\u5927\u91cf\u7684C\u8bed\u8a00\u7684\u6570\u636e\u7ed3\u6784\uff0c executive objects \u662f**\u5176\u4e2d\u4e00\u7c7b**\u7684\u540d\u79f0\uff0c\u6765\u6e90\u662f\u56e0\u4e3a\u4ed6\u4eec\u90fd\u88ab Windows Object Manager \u6765\u7ba1\u7406(\u521b\u5efa\u3001\u7ef4\u62a4\u3001\u5220\u9664\u7b49)\uff0c Windows Object Manager \u662fWindows NT\u5185\u6838\u7684\u4e00\u4e2a\u5185\u6838\u7ec4\u4ef6\u3002 \u6ce8\u610f\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6570\u636e\u7ed3\u6784\u90fd\u662f\u6267\u884c\u4f53\u5bf9\u8c61(executive objects) \uff0c\u6267\u884c\u4f53\u5bf9\u8c61\u662f\u6709\u4ed6\u81ea\u5df1\u7279\u6b8a\u7684\u6587\u4ef6\u5934\u7684\uff0c\u5176\u4ed6\u6570\u636e\u7ed3\u6784\u662f\u6ca1\u6709\u7684\uff1b\u5e76\u4e14\u6267\u884c\u4f53\u5bf9\u8c61\u662f\u7531\u5bf9\u8c61\u7ba1\u7406\u5668(Object Manager)\u751f\u6210\u7684\uff0c\u800c\u5176\u4ed6\u7684\u662f\u7531\u5176\u4ed6\u5b50\u7cfb\u7edf\u751f\u6210\u7684\uff0c\u5982\u7531TCP/IP\u6808(tcpip.sys)\u751f\u6210\u7684\u3002 \u3000\u3000\u4e0b\u9762\u662f\u4e00\u4e9b\u4e0e\u53d6\u8bc1\u6709\u5173\u7684\u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b(executive object types)\uff0c\u5728Volatility\u4e2d\u6709\u76f8\u5e94\u7684\u5206\u6790\u8fd9\u4e9b\u5bf9\u8c61\u7684\u63d2\u4ef6\uff1a \u3000\u3000 \u3000\u3000 \u3000\u3000\u4e0d\u540c\u7248\u672c\u7684Windows\u7684\u5bf9\u8c61\u7c7b\u578b\u4f1a\u53d1\u751f\u53d8\u5316\u6765\u652f\u6301\u65b0\u7684\u7279\u6027\uff0c\u53ef\u4ee5\u4f7f\u7528 Sysinternals Suite \u5de5\u5177\u5305\u4e2d\u7684 winObj \u6765\u67e5\u770b(\u5b89\u5229\u4e00\u4e0bMark Russinovich\u5927\u795e\u5199\u7684windows\u5de5\u5177\u5305\u3002\u5982\u4e0b\u56fe\uff1a \u3000\u3000 Object Header (windos \u5bf9\u8c61\u5934\u90e8) \u00b6 \u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b\u7684\u4e00\u4e2a\u7279\u70b9\u5c31\u662f\u6709**\u4e00\u4e2a** object header (_OBJECT_HEADER\u7c7b\u578b)\uff0c\u4ee5\u53ca\u96f6\u4e2a\u6216\u591a\u4e2a\u53ef\u9009\u7684\u5176\u4ed6\u5934\u90e8\u4fe1\u606f(optional headers)\u3002\u5bf9\u8c61\u7684\u5934\u90e8(Object header)\u4f1a\u5148\u4e8e\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u6570\u636e\u7ed3\u6784\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u540c\u6837\u5730\uff0c\u53ef\u9009\u7684\u5934\u90e8\u4fe1\u606f(optional headers)\u4e5f\u4f1a\u4e00\u79cd\u65b9\u5f0f(in a fixed order)\uff0c\u5148\u4e8e\u4e00\u822c\u5934\u90e8\u4fe1\u606f(object header)\u52a0\u8f7d\u3002\u8fd9\u6837\u7684\u7279\u70b9\u7684\u7ed3\u679c\u662f\u4ec0\u4e48\u5462\uff1f\u5c31\u662f\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u683c\u5f0f\u662f\u53ef\u9884\u77e5\u7684(predictable)\uff0c\u5982\u4e0b\u56fe\uff1a \u3000\u3000 \u3000\u3000\u6240\u4ee5\u7efc\u4e0a\u8fd9\u79cd\u52a0\u8f7d\u7684\u7279\u70b9\uff0c\u4e3e\u4e00\u4e2a\u6817\u5b50\uff0c\u6bd4\u5982\u4e00\u4e2aFile\u7c7b\u578b\uff0c\u5b83\u62e5\u6709\u4e00\u4e2a _FILE_OIBJECT \u7c7b\u578b\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\u83b7\u53d6\u5230\u5b83\u7684 _OBJECT_HEADER \u6570\u636e\u7ed3\u6784\uff0c\u6216\u8005\u53cd\u4e4b\u4ea6\u7136\uff0c\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u7ed3\u6784\u4f53\u5728\u5934\u90e8\u4e2d\u662f\u76f8\u90bb\u7684(\u4e0a\u56fe)\uff0c\u800c\u5bf9\u4e8e _OBJECT_HEADER \u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u7684\u5927\u5c0f\u4e0d\u4f1a\u5e94\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e0d\u540c\u800c\u53d8\u5316\u3002 \u3000\u3000\u90a3\u4e48\u5982\u4f55\u786e\u5b9a\u54ea\u4e00\u4e2a\u53ef\u9009\u7684\u5934\u90e8\u4fe1\u606f\u662f\u5b58\u5728\u7684\u5462\uff1f\u53ef\u4ee5\u4f9d\u9760\u5bf9\u8c61\u5934\u90e8\u7684 InfoMask \u4fe1\u606f\u3002\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2aWin7\u4e0a\u7684\u5bf9\u8c61\u5934\u90e8\u7684\u5b9e\u4f8b(\u81ea\u5df1\u53ef\u4ee5\u5728volshell\u4e2d\u770b\uff0c\u547d\u4ee4\u5982\u4e0b)\u3002 In [3]: dt(\"_OBJECT_HEADER\") '_OBJECT_HEADER' (56 bytes) 0x0 : PointerCount ['long long'] //\u6307\u9488\u6570\u91cf\uff0c\u5305\u542b\u5185\u6838\u6a21\u5f0f\u7684 0x8 : HandleCount ['long long'] //\u5f53\u524d\u5bf9\u8c61\u6301\u6709\u7684\u53e5\u67c4\u6570 0x8 : NextToFree ['pointer64', ['void']] 0x10 : Lock ['_EX_PUSH_LOCK'] 0x18 : TypeIndex ['unsigned char'] //\u5bf9\u8c61\u7684\u7c7b\u578b 0x19 : TraceFlags ['unsigned char'] 0x1a : InfoMask ['unsigned char'] 0x1b : Flags ['unsigned char'] 0x20 : ObjectCreateInfo ['pointer64', ['_OBJECT_CREATE_INFORMATION']] 0x20 : QuotaBlockCharged ['pointer64', ['void']] 0x28 : SecurityDescriptor ['pointer64', ['void']] //\u50a8\u5b58\u5b89\u5168\u9650\u5236\u4fe1\u606f(\u5982\u54ea\u4e9b\u7528\u6237\u53ef\u8bfb) 0x30 : Body ['_QUAD'] //\u4e00\u4e2a\u5360\u4f4d\u7b26\uff0c\u4ee3\u8868\u5bf9\u8c61\u6570\u636e\u7ed3\u6784\u4f53\u7684\u5f00\u59cb\uff0c\u5bf9\u8c61\u5934\u90e8\u7684\u7ed3\u675f \u3000\u3000 Optional Headers (windos \u53ef\u9009\u5bf9\u8c61\u5934\u90e8) \u00b6 \u53ef\u9009\u5934\u90e8\u4fe1\u606f\u4e2d\u5305\u542b\u4e86\u5f88\u591a\u7528\u4e8e\u63cf\u8ff0\u5bf9\u8c61\u7684\u5143\u4fe1\u606f(metadata)\uff0c\u56e0\u4e3a\u662f\u53ef\u9009\uff0c\u6240\u4ee5\u4e0d\u662f\u6240\u6709\u7684\u5bf9\u8c61\u90fd\u62e5\u6709\u5b83\uff0c\u5e76\u4e14**\u4e0d\u540c\u5bf9\u8c61\u7c7b\u578b\u7684\u5b9e\u4f8b\u4e5f\u53ef\u80fd\u5305\u542b\u4e0d\u540c\u7684\u53ef\u9009\u5934\u90e8\u4fe1\u606f**\uff0c\u4e3e\u4e00\u4e2a\u6817\u5b50\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e0d\u4f1a\u8ddf\u8e2a\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u7684\u8d1f\u8f7d\u60c5\u51b5(quota stats)\uff0c\u6240\u4ee5\u7a7a\u95f2(Idle)\u548c\u7cfb\u7edf(system)\u7684\u8fdb\u7a0b\u867d\u7136\u90fd\u5c5e\u4e8e _EPRROCESS \u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4f46\u662f\u4ed6\u4eec\u4e24\u4e2a\u662f\u6ca1\u6709 _OBJECT_HEADER_NAME_INFO \u8fd9\u4e2a\u53ef\u9009\u5934\u90e8\u7684\u3002\u4f46\u662f\u533f\u540d\u4e92\u65a5\u9501\u662f\u6709\u8fd9\u4e2a\u5934\u90e8\u7684\u3002 \u3000\u3000\u867d\u7136\u53ef\u9009\u5934\u90e8\u4fe1\u606f\u5f88\u591a\uff0c\u4f46\u662f\u5e38\u5206\u6790\u7684\u8fd8\u662f\u5b83\u7684Name\u5c5e\u6027(\u89c1\u4e0b\u56feName Info)\u3002\u4e0b\u9762\u7684\u8868\u662f64\u4f4dwin7\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u53ef\u9009\u5934\u90e8\u4fe1\u606f\uff0c\u5982\u679cBit Mask\u5217\u7684\u67d0\u4e00\u4e2a\u503c\u5c31\u662f\u5bf9\u8c61\u5934\u90e8\u4e2d\u7684 InfoMask \u7684\u503c\u7684\u8bdd\uff0c\u5c31\u8bf4\u660e\u8fd9\u4e2a\u5934\u662f\u6709\u7684\u3002 \u3000\u3000 \u3000\u3000 Object Type Objects (windows \u5bf9\u8c61\u7c7b\u578b\u5bf9\u8c61) \u00b6 \u5728\u4e0a\u9762\u7684\u5bf9\u8c61\u5934\u90e8\u5206\u6790\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\u6709\u4e00\u4e2a\u53c2\u6570 TypeIndex \uff0c\u4ed6\u4ee3\u8868\u4e86\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u8fd9\u4e2a\u53c2\u6570\u662f\u5728nt!ObTypeIndexTable(\u4e00\u4e2a_OBJECT_TYPE\u7684\u6570\u7ec4\u96c6\u5408)\u4e2d\u67e5\u627e\u7684\u7d22\u5f15(\u6240\u4ee5\u53ebTypeIndex)\uff0c\u8fd9\u4e2a\u53c2\u6570\u5bf9\u5185\u5b58\u53d6\u8bc1\u6709\u5f88\u5927\u7528\u5904\uff0c\u7531\u8fd9\u4e2a\u53c2\u6570(_OBJECT_HEADER.TypeIndex)\u4f60\u5c31\u53ef\u4ee5\u5224\u5b9a\u8fd9\u4e2a\u5bf9\u8c61\u7684\u7c7b\u578b\u662f\u4ec0\u4e48\u3002\u4e3e\u4e00\u4e2a\u6817\u5b50\uff1a\u52a0\u5165\u5728\u4e00\u4e2a\u8fdb\u7a0b\u53e5\u67c4\u8868\u4e2d\u6307\u5411\u591a\u4e2a\u5bf9\u8c61\u5934\u90e8\uff0c\u4e3a\u4e86\u786e\u5b9a\u8fd9\u4e9b\u5bf9\u8c61\u90fd\u662f\u4ec0\u4e48\u7c7b\u578b\uff0c\u672c\u6765\u4f60\u9700\u8981\u53bb\u904d\u5386\u4e0a\u9762\u8bf4\u7684\u8868\u624d\u80fd\u786e\u5b9a\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u4f46\u662f\u73b0\u5728\u4f60\u53ea\u9700\u8981\u67e5\u770b\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u7684 _OBJECT_HEADER.TypeIndex \u503c\u5c31\u53ef\u4ee5\u4e86\uff0c\u901a\u8fc7\u8fd9\u4e2a\u7d22\u5f15\u4f60\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa _OBJECT_TYPE \u7684 Name \u5c5e\u6027(\u89c1\u4e0b\u9762\u8fd9\u5f20Win7x64\u7684_OBJECT_TYPE\u7684\u8868)\uff1a In [4]: dt(\"_OBJECT_TYPE\") '_OBJECT_TYPE' (208 bytes) 0x0 : TypeList ['_LIST_ENTRY'] 0x10 : Name ['_UNICODE_STRING'] //\u8fd9\u4e2aName\u5c5e\u6027\u7684\u503c\u5c31\u662f\u8fd9\u4e2a\u5bf9\u8c61\u7684\u7c7b\u578b\u7684\u540d\u79f0(Proces,File,Key\u7b49) 0x20 : DefaultObject ['pointer64', ['void']] 0x28 : Index ['unsigned char'] 0x2c : TotalNumberOfObjects ['unsigned long'] //\u672c\u5bf9\u8c61\u7c7b\u578b\u7684\u5bf9\u8c61\u603b\u6570 0x30 : TotalNumberOfHandles ['unsigned long'] //\u672c\u5bf9\u8c61\u7c7b\u578b\u7684\u5bf9\u8c61\u7684\u53e5\u67c4\u7684\u603b\u6570 0x34 : HighWaterNumberOfObjects ['unsigned long'] 0x38 : HighWaterNumberOfHandles ['unsigned long'] 0x40 : TypeInfo ['_OBJECT_TYPE_INITIALIZER'] //\u4e00\u4e2a_OBJECT_TYPE_INITIALIZER\u7c7b\u578b\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5185\u5bb9\u4e3a\u5185\u5b58\u4e3a\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5b9e\u4f8b\u5206\u914d\u5185\u5b58\u7684\u65b9\u5f0f(\u5206\u9875\uff1f\u4e0d\u5206\u9875\uff1f) 0xb0 : TypeLock ['_EX_PUSH_LOCK'] 0xb8 : Key ['unsigned long'] //\u4e00\u4e2a\u56db\u5b57\u8282\u7684\u3001\u7528\u4e8e\u552f\u4e00\u6807\u8bc6\u672c\u5bf9\u8c61\u7c7b\u578b\u7684\u3001\u5bf9\u8c61\u7684\u6807\u7b7e 0xc0 : CallbackList ['_LIST_ENTRY'] \u3000\u3000\u4e0a\u8ff0\u7684\u8fd9\u4e9b\u5c5e\u6027\u4e2d\uff0c TypeInfo \u548c Key \u4e24\u4e2a\u5c5e\u6027\u63d0\u4f9b\u7684\u7ebf\u7d22\u53ef\u4ee5\u544a\u8bc9\u4f60\u4e24\u4e2aW\uff1aWhere(\u53bb\u54ea\u91cc\u5bfb\u627e\uff0c\u662f\u5206\u9875\u7684\u5185\u5b58\u8fd8\u662f\u6ca1\u5206\u9875\u7684)\u548cWhat(\u4e00\u4e2a\u7279\u6b8a\u7684\u56db\u5b57\u8282\u7684\u6807\u7b7etag)\u3002\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u955c\u50cf\u4e3a\u4f7f\u7528DumpIt\u83b7\u53d6\u7684\u5185\u5b58\u6587\u4ef6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e3aWin7x64SP1\uff0c\u5185\u5b58\u683c\u5f0f\u4e3araw\u3002\u4f7f\u7528volatility\u7684volshell\u8fdb\u884c\u8bf4\u660e\uff0c\u9700\u8981windbg\u5de5\u5177((\u6ca1\u6709windbg\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u540e\u9762\u6211\u4f1a\u63d0\u5230))\u3002 \u3000\u3000\u9996\u5148\u6765\u770b\u770bvolshell\u600e\u4e48\u4f7f\u7528\uff1a \u3000\u3000\u4f7f\u7528 hh() \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u7528\u6cd5 # root @ kali in ~/Desktop [14:30:31] $ volatility -f FLOAT-WIN7-20200130-055210.raw --profile Win7SP1x64 volshell Volatility Foundation Volatility Framework 2 .6 Current context: System @ 0xfffffa8018d45740, pid = 4 , ppid = 0 DTB = 0x187000 Python 2 .7.17 ( default, Oct 19 2019 , 23 :36:22 ) Type \"copyright\" , \"credits\" or \"license\" for more information. IPython 5 .8.0 -- An enhanced Interactive Python. ? -> Introduction and overview of IPython 's features. %quickref -> Quick reference. help -> Python' s own help system. object? -> Details about 'object' , use 'object??' for extra details. In [ 1 ] : hh () Use addrspace () for Kernel/Virtual AS Use addrspace () .base for Physical AS Use proc () to get the current process object and proc () .get_process_address_space () for the current process AS and proc () .get_load_modules () for the current process DLLs addrspace () : Get the current kernel/virtual address space. cc ( offset = None, pid = None, name = None, physical = False ) : Change current shell context. db ( address, length = 128 , space = None ) : Print bytes as canonical hexdump. dd ( address, length = 128 , space = None ) : Print dwords at address. dis ( address, length = 128 , space = None, mode = None ) : Disassemble code at a given address. dq ( address, length = 128 , space = None ) : Print qwords at address. dt ( objct, address = None, space = None, recursive = False, depth = 0 ) : Describe an object or show type info. find ( needle, max = 1 , shift = 0 , skip = 0 , count = False, length = 128 ) : getmods () : Generator for kernel modules ( scripting ) . getprocs () : Generator of process objects ( scripting ) . hh ( cmd = None ) : Get help on a command. list_entry ( head, objname, offset = -1, fieldname = None, forward = True, space = None ) : Traverse a _LIST_ENTRY. modules () : Print loaded modules in a table view. proc () : Get the current process object. ps () : Print active processes in a table view. sc () : Show the current context. For help on a specific command, type 'hh(<command>)' \u3000\u3000\u4e0b\u9762\u662f\u6bcf\u4e00\u4e2a\u63d2\u4ef6\u7684\u7528\u6cd5\uff1a \u4f7f\u7528 addrspace() \u83b7\u53d6\u865a\u62df\u6216\u7269\u7406\u5730\u5740\u7684\u6570\u636e\u7ed3\u6784 \u4f7f\u7528 addrspace().base \u83b7\u53d6\u7269\u7406\u5730\u5740\u7684\u6570\u636e\u7ed3\u6784 \u4f7f\u7528 proc() \u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u5bf9\u8c61 proc().get_process_address_space() \u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u5bf9\u8c61\u7684\u5730\u5740 proc().get_load_modules() \u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u5bf9\u8c61\u52a0\u8f7d\u7684dll addrspace(): \u83b7\u53d6\u5f53\u524d\u5185\u6838\u6216\u8005\u865a\u62df\u5730\u5740\u7a7a\u95f4 cc(offset=None, pid=None, name=None, physical=False):\u7528\u4e8e\u6539\u53d8\u5f53\u524dshell\u7684\u4e0a\u4e0b\u6587 db(address, length=128, space=None): \u4ee516\u8fdb\u5236dump\u7684\u5f62\u5f0f\u6253\u5370\u8be5\u5730\u5740\u5904\u7684\u5b57\u8282 dd(address, length=128, space=None): \u4ee5\u53cc\u5b57\u7684\u683c\u5f0f\u6253\u5370\u6b64\u5730\u5740\u5185\u5bb9 dis(address, length=128, space=None, mode=None) : \u53cd\u6c47\u7f16\u6b64\u5904\u7684\u4ee3\u7801 dq(address, length=128, space=None): \u4ee5\u56db\u5b57\u7684\u683c\u5f0f\u6253\u5370\u6b64\u5730\u5740\u5185\u5bb9 dt(objct, address=None, space=None, recursive=False, depth=0): \u63cf\u8ff0\u6b64\u5bf9\u8c61\u6216\u8005\u663e\u793a\u5b83\u7684\u7c7b\u578b find(needle, max=1, shift=0, skip=0, count=False, length=128): getmods(): \u5185\u6838\u6a21\u5757\u751f\u6210\u5668(\u811a\u672c\u5316) getprocs(): \u8fdb\u7a0b\u5bf9\u8c61\u751f\u6210\u5668(\u811a\u672c\u5316) hh(cmd=None): \u83b7\u53d6\u4e00\u4e2a\u547d\u4ee4\u7684\u5e2e\u52a9 list_entry(head, objname, offset=-1, fieldname=None, forward=True, space=None) : \u904d\u5386\u4e00\u4e2a_LIST_ENTRY\u6570\u636e\u7ed3\u6784\u4f53 modules(): \u4ee5\u8868\u683c\u5f62\u5f0f\u6253\u5370\u52a0\u8f7d\u7684\u6a21\u5757 proc(): \u83b7\u5f97\u5f53\u524d\u8fdb\u7a0b\u5bf9\u8c61 ps(): \u4ee5\u8868\u683c\u7684\u5f62\u5f0f\u6253\u5370\u5f53\u524d\u7684\u6d3b\u52a8\u8fdb\u7a0b sc(): \u663e\u793a\u5f53\u524d\u4e0a\u4e0b\u6587 \u3000\u3000\u5728\u5f00\u59cb\u5b9e\u9a8c\u524d\u4f60\u9700\u8981\u5728\u4f60\u81ea\u5df1\u7684windows\u865a\u62df\u673a\u4e0a\u5b89\u88c5Windbg\uff0c\u8fd9\u91cc\u63d0\u4f9b \u4e00\u7bc7\u6559\u7a0b \u6211\u8fd9\u91cc\u865a\u62df\u673a\u662fWin7x64SP1\uff0c\u4e3b\u673a\u662fWin10\u3002\u914d\u7f6e\u597d\u4ee5\u540e\uff0c\u91cd\u542f\u4f60\u7684\u865a\u62df\u673a\uff0c\u4f7f\u7528\u8c03\u8bd5\u7684\u542f\u52a8\u9879\uff0c\u7136\u540e\u5f00\u542fwindbg\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u4e0b\u9762\u7684\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000 \u3000\u3000\u4e0a\u8ff0\u914d\u7f6e\u597d\u4e86\u4ee5\u540e\uff0c\u518d\u5f00\u59cb\u6211\u4eec\u7684\u793a\u4f8b\uff1a \u3000\u3000\u4e0b\u9762\u6211\u4eec\u904d\u5386\u4e00\u4e0b\u5185\u6838\u7a7a\u95f4\u5185100\u4e2a\u5bf9\u8c61\u7684\u5bf9\u8c61\u7c7b\u578b\uff0c\u770b\u770b\u90fd\u662f\u4ec0\u4e48\u7c7b\u578b\u7684\u3002\u8fd9\u91cc\u4e3b\u8981\u76ee\u7684\u662f\u719f\u6089volshell\u7684\u4f7f\u7528\u4ee5\u53ca\u6f84\u6e05\u51e0\u4e2a\u6982\u5ff5\uff1a kernel_space = addrspace () ObjectTypeIndexTable = 0xfffff80004039340 // \u4e0b\u9762\u4f1a\u8bf4\u660e\u8fd9\u4e2a\u503c\u600e\u4e48\u6765\u7684 ptrs = obj . Object ( \"Array\" , targetType = \"Pointer\" , offset = ObjectTypeIndexTable , cout = 100 , vm = kernel_space ) for i , ptr in enumerate ( ptrs ): objType = ptr . dereference_as ( \"_OBJECT_TYPE\" ) if objType . is_valid (): print i , str ( objtype . Name ), \"in\" , str ( objtype . TypeInfo . PoolType ), \"with key\" , str ( objtype . Key ) \u3000\u3000\u8fd9\u6bb5\u4ee3\u7801\u7684\u542b\u4e49\u662f\u9996\u5148\u83b7\u53d6\u5185\u6838\u7684\u5730\u5740\uff1b\u7b2c\u4e8c\u884c\u8bbe\u7f6e\u4e86\u7c7b\u578b\u7d22\u5f15\u8868\u7684\u5730\u5740\uff0c\u540e\u9762\u8981\u4f7f\u7528\u5230\u8be5\u8868\uff1b\u7b2c\u4e09\u884c\u5b9e\u4f8b\u5316\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u7c7b\u578b\u4e3a\u6570\u7ec4\uff0c\u50a8\u5b58\u5185\u5bb9\u7c7b\u578b\u4e3a\u6307\u9488\uff0c\u6570\u7ec4\u5927\u5c0f\u4e3a100\uff1b\u7b2c\u56db\u884c\u5f00\u59cb\u904d\u5386\u8fd9\u4e00\u767e\u4e2a\u5143\u7d20\uff0c\u5c06\u6bcf\u4e2a\u6307\u9488\u89e3\u91ca\u4e3a\u4e00\u4e2a_OBJECT_TYPE\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u5982\u679c\u4ed6\u662f\u6709\u6548\u7684\u8bdd\u5c31\u5c06\u5b83\u7684\u540d\u79f0\u3001\u7c7b\u578b\u4fe1\u606f\u3001Key\u503c(\u8fd9\u4e9b\u90fd\u662f\u5bf9\u8c61\u7c7b\u578b\u5bf9\u8c61\u7684\u5c5e\u6027)\u6253\u5370\u51fa\u6765\uff0c\u5177\u4f53\u8fd9\u4e9b\u503c\u7684\u542b\u4e49\u5728\u672c\u8282\u5f00\u5934\u6211\u4eec\u5df2\u7ecf\u63d0\u5230\u4e86\u3002 \u3000\u3000 ObjectTypeIndexTable \u8fd9\u4e2a\u53d8\u91cf\u7684\u503c\u662f\u7c7b\u578b\u7d22\u5f15\u8868\uff0c\u5b83\u5728windows\u5185\u6838\u662f\u4ee5\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u5bfc\u51fa\u7684\u3002\u6253\u5f00windbg\uff0c\u67e5\u770b\u8fd9\u4e2a\u53d8\u91cf\u7684\u503c\u3002 \u3000\u3000\u56e0\u4e3a\u6211\u6ca1\u6709\u5b66\u8fc7windbg\u4f7f\u7528\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u662f\u7b80\u5355\u4f7f\u7528\uff0c\u5982\u679c\u4e0d\u80fd\u4e0b\u8f7d\u7b26\u53f7\u8868\u7684\u8bdd\uff0c\u53ef\u4ee5\u6302\u4ee3\u7406\u4e0b\u8f7d\u3002\u4f7f\u7528 dd ObTypeIndexTable \u547d\u4ee4\u5c31\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u503c\u4e86\uff1a \u3000\u3000 \u3000\u3000\u8fd9\u91cc\u6211\u7684\u503c\u662f 0xfffff80004039340 \uff0c\u4e0b\u9762\u5728volshell\u4e2d\u8fd0\u884c\u8fd9\u4e2a\u811a\u672c\uff1a \u3000\u3000\u5148\u8bbe\u7f6e\u5185\u6838\u7a7a\u95f4\u7684\u5730\u5740\u4ee5\u53ca\u53d8\u91cf\u7684\u503c\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u8868\u662f\u6709\u5185\u5bb9\u7684(\u5982\u679c\u662f\u7a7a\u7684\u5c31\u8bf4\u660e\u4f60\u53ef\u80fd\u627e\u9519\u4e86\uff0c\u6211\u7b2c\u4e00\u6b21\u5c31\u662f\u8fd9\u6837)\uff1a \u3000\u3000 \u3000\u3000 \u3000\u3000\u4e4b\u540e\u8fdb\u884c\u904d\u5386\u5faa\u73af\uff1a \u3000\u3000 \u3000\u3000\u5728\u7ed3\u679c\u4e2d\u53ef\u4ee5\u770b\u5230\u8fd9\u51e0\u4e2a\u7279\u70b9\uff1a 1. \u7b2c\u4e00\u5217\u603b\u6570\u4e0d\u662f100\uff0c\u8bf4\u660e\u4e0d\u662f\u6bcf\u4e00\u4e2a\u53d8\u91cf\u90fd\u662f_OBJECT_TYPE\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u5373\uff0c\u4ed6\u4e0d\u662f\u4e00\u4e2a\u5bf9\u8c61\u7c7b\u578b\u7684\u5bf9\u8c61 2. \u7b2c\u4e8c\u5217\u4e2d\u6253\u5370\u51fa\u6765\u7684\u5bf9\u8c61\u7c7b\u578b\u7684\u540d\u79f0\u5c31\u662f\u8fd9\u4e2a\u6307\u9488\u6240\u6307\u7684\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u5728\u4e0a\u9762\u7684\u8868\u4e2d\u90fd\u53ef\u4ee5\u627e\u5230 3. \u7b2c\u56db\u5217\u53ef\u4ee5\u770b\u5230\u53ea\u6709\u4e24\u4e2a\u503c\uff0c\u5373\u50a8\u5b58\u5728\u5206\u9875\u7684\u5185\u5b58\u4e2d\u8fd8\u662f\u6ca1\u5206\u9875\u7684\u5185\u5b58\u4e2d 4. \u6700\u540e\u4e00\u5217\u7684key\u503c\u53ef\u4ee5\u770b\u5230\u90fd\u662f4\u5b57\u8282\u7684\uff0c\u8fd9\u4e5f\u543b\u5408\u4e86\u672c\u8282\u5f00\u5934\u6240\u63cf\u8ff0\u7684\u5bf9\u8c61\u7c7b\u578b\u5bf9\u8c61\u7684\u7ed3\u6784 \u3000\u3000\u5982\u679c\u6ca1\u6709windbg\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528volatility\u7684 objtypescan \u63d2\u4ef6\u6765\u5f97\u51fa\u4e0a\u8ff0\u811a\u672c\u7684\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000\u8fd9\u4e2a\u63d2\u4ef6\u7684\u7ed3\u679c\u548c\u4e0a\u9762\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\uff0c\u4e8c\u8005\u7684\u533a\u522b\u662f\uff0c\u4f7f\u7528nt!ObTytpeIndexTable\u662f\u5f00\u59cb\u7684\u5730\u5740\u5f00\u59cb\u8fdb\u884c\u626b\u63cf\u7684\uff0c\u800cvolatility\u4e2d\u7684objtypescan\u63d2\u4ef6\u7ed3\u679c\u7684\u987a\u5e8f\u662f\u6309\u7167\u88ab\u53d1\u73b0\u7684\u987a\u5e8f\u51fa\u73b0\u7684\u3002 \u3000\u3000 Kernel Pool Allocations (\u5185\u6838\u6c60\u5206\u914d) \u00b6 \u5185\u6838\u6c60(kernel pool)\u662f\u4e00\u6bb5\u53ef\u5206\u7684\u5185\u5b58\uff0c\u53ef\u4ee5\u5206\u4e3a\u4e0d\u540c\u7684\u5c0f\u7684\u5757\u6765\u50a8\u5b58\u5185\u6838\u6a21\u5f0f\u7684\u7ec4\u4ef6(NT\u3001\u7b2c\u4e09\u65b9\u9a71\u52a8\u7b49)\u6240\u9700\u8981\u7684\u4efb\u4f55\u7c7b\u578b\u7684\u6570\u636e \u548c\u5806\u7c7b\u4f3c\uff0c\u6bcf\u4e00\u4e2a\u5206\u914d\u7684\u5757\u90fd\u6709\u4e00\u4e2a\u5934 --- _POOL_HEADER \uff0c\u5b83\u5305\u542b\u7740\u8ba1\u6570\u548c\u8c03\u8bd5\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5e2e\u52a9\u4f60\u627e\u5230\u4e0d\u540c\u5757\u7684\u5185\u5b58\u6240\u5f52\u5c5e\u7684\u9a71\u52a8\uff0c\u800c\u4e14\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u53ef\u4ee5\u5e2e\u52a9\u4f60\u63a8\u65ad\u6570\u636e\u7ed3\u6784\u7684\u7c7b\u578b\u6216\u8005\u5305\u542b\u8fd9\u4e9b\u5185\u5b58\u7684\u5bf9\u8c61\u3002\u5b66\u4e60\u8fd9\u90e8\u5206\u9664\u4e86\u5bf9\u5185\u5b58\u53d6\u8bc1\u6709\u5f88\u5927\u5e2e\u52a9\uff0c\u5728\u653b\u51fb\u65b9\u9762\u4e5f\u6709\u5e2e\u52a9\uff0c\u5982\u8fd9\u7bc7\u6587\u7ae0 Kernel Pool Exploitation on Windows.7 \u6240\u8ff0\u3002 \u3000\u3000\u4e0b\u9762\u8fd9\u5f20\u56fe\u662f\u5728Object Header\u7684\u7ed3\u6784\u56fe\u7684\u57fa\u7840\u4e0a\u589e\u6539\u7684(\u7ea2\u6846\u662f\u589e\u52a0\u7684)\uff1a \u3000\u3000 \u3000\u3000\u53ef\u4ee5\u770b\u5230\u5728\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u5934\u90e8\u4fe1\u606f\u4e2d\u9664\u4e86\u53ef\u9009\u5934\u90e8\u4fe1\u606f\u5916\u8fd8\u6709\u4e00\u4e2a _POOL_HEADER \u7684\u6570\u636e\u7ed3\u6784\u4fe1\u606f\u3002\u5728Win7\u4e2d _POOL_HEADER \u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u7ed3\u6784\u662f\u8fd9\u6837\u7684\uff1a In [2]: dt(\"_POOL_HEADER\") '_POOL_HEADER' (16 bytes) 0x0 : BlockSize ['BitField', {'end_bit': 24, 'start_bit': 16, 'native_type': 'unsigned long'}] 0x0 : PoolIndex ['BitField', {'end_bit': 16, 'start_bit': 8, 'native_type': 'unsigned long'}] 0x0 : PoolType ['BitField', {'end_bit': 32, 'start_bit': 24, 'native_type': 'unsigned long'}] 0x0 : PreviousSize ['BitField', {'end_bit': 8, 'start_bit': 0, 'native_type': 'unsigned long'}] 0x0 : Ulong1 ['unsigned long'] 0x4 : PoolTag ['unsigned long'] 0x8 : AllocatorBackTraceIndex ['unsigned short'] 0x8 : ProcessBilled ['pointer64', ['_EPROCESS']] 0xa : PoolTagHash ['unsigned short'] \u3000\u3000\u5173\u952e\u7684\u53d8\u91cf\u503c\u6709\u8fd9\u4e09\u4e2a\uff1a 1. BlockSize: \u5757\u5927\u5c0f\uff0c\u4ee3\u8868\u4e86\u5206\u914d\u7684\u5bf9\u8c61\u5927\u5c0f\uff0c\u5305\u62ec\u4e86\u6c60\u5934\u90e8(pool header)\u3001\u5bf9\u8c61\u5934\u90e8\u3001\u548c\u53ef\u9009\u5934\u90e8\u4fe1\u606f 2. PoolType: \u8fd9\u4e2a\u6c60\u7684\u7cfb\u7edf\u5185\u5b58\u7684\u7c7b\u578b(\u5206\u9875\uff1f\u4e0d\u5206\u9875\uff1f) 3. PoolTag: \u4e00\u4e2a4\u5b57\u8282\u7684\u3001\u7531ASCII\u5b57\u7b26\u7ec4\u6210\u7684\u3001\u552f\u4e00\u6807\u8bc6\u7684\u3001\u53d1\u751f\u5185\u5b58\u5206\u914d\u7684\u4ee3\u7801\u8def\u5f84(\u53ef\u4ee5\u5e2e\u52a9\u5c06\u4e00\u4e9b\u9ebb\u70e6\u7684\u5757\u5f52\u5c5e\u5230\u5b83\u4eec\u7684\u6e90)\u3002\u5728Win8\u548cWin2012\u4e2d,\u5176\u4e2d\u4e00\u4e2a\u5b57\u7b26\u53ef\u80fd\u4f1a\u88ab\u4fee\u6539\u4e3a\u4fdd\u62a4\u4f4d \u3000\u3000 Allocation API (\u5206\u914dAPI) \u00b6 \u5728\u5b9e\u4f8b\u5316\u4e00\u4e2a\u6267\u884c\u4f53\u5bf9\u8c61(\u6216\u8005\u5176\u4ed6\u5bf9\u8c61)\u65f6\uff0c\u4e00\u4e2a\u8db3\u591f\u5bb9\u7eb3\u8fd9\u4e2a\u5b9e\u4f8b\u5316\u7684\u5bf9\u8c61\u7684\u3001\u4ee5\u53ca\u4ed6\u7684\u5934\u90e8\u4fe1\u606f\u7684\u5185\u5b58\u5757\u4f1a\u4ece\u64cd\u4f5c\u7cfb\u7edf\u6c60\u4e2d\u88ab\u5206\u914d\u3002 \u5b9e\u73b0\u8fd9\u4e2a\u5206\u914d\u7684API\u662f ExAllocatePoolWithTag \uff0c\u4ed6\u7684\u51fd\u6570\u539f\u578b\u662f\u8fd9\u6837\u7684\uff1a PVOID ExAllocatePoolWithTag ( _In_ POOL_TYPE PoolType , //\u8981\u5206\u914d\u7684\u7cfb\u7edf\u5185\u5b58\u7684\u7c7b\u578b\uff0c0\u4ee3\u8868\u4e0d\u5206\u9875\uff0c1\u4ee3\u8868\u5206\u9875 _In_ SIZE_T NumberOfBytes , //\u8981\u5206\u914d\u7684\u5927\u5c0f\uff0c\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d _In_ ULONG Tag ); \u3000\u3000\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u4e0a\u9762\u5b9e\u9a8c\u4e5f\u53ef\u4ee5\u770b\u5230\u5927\u90e8\u5206\u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b\u90fd\u88ab\u5206\u914d\u5728\u4e0d\u5206\u9875\u5185\u5b58\uff0c\u4f60\u53ef\u4ee5\u67e5\u770b _OBJECT_TYPE.Typeinfo.PoolType \u8fd9\u4e2a\u503c\u6765\u67e5\u770b\u5177\u4f53\u3002 \u3000\u3000\u4e5f\u6709\u5176\u4ed6\u7684\u6807\u5fd7\u4f4d(_POOL_TYPE\u6570\u636e\u7ed3\u6784)\u6765\u67e5\u770b\u4e00\u6bb5\u5185\u5b58\u5230\u5e95\u662f\u53ef\u6267\u884c\u7684\uff0c\u8fd8\u662f\u7f13\u5b58\u5bf9\u9f50\u7684\uff0c\u8fd8\u662f\u5176\u4ed6\u7684\uff0c \u5b66\u4e60\u94fe\u63a5 \u3002 \u3000\u3000\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u5b83\u51b3\u5b9a\u4e86\u8c03\u7528 ExAllocatePoolWithTag \u8fd9\u4e2a\u51fd\u6570\u7684\u9a71\u52a8\u8981\u6c42\u5206\u914d\u7684\u6570\u636e\u5927\u5c0f\u3002\u5185\u6838\u4e2d\u7684\u51fd\u6570 ObCreateObject \u4f1a\u6700\u7ec8\u6765\u6267\u884c\u6240\u6709\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u521b\u5efa\u3002\u4e3e\u4e2a\u6817\u5b50\u5427\uff0c\u5047\u5982\u8bf4\u4f60\u8981\u7533\u8bf7\u4e00\u4e2a EPROCESS \u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4ed6\u7684\u5927\u5c0f\u662f1232\u5b57\u8282(win7x64)\uff0c\u7136\u540e\u4f60\u5728\u52a0\u4e0a _OBJECT_HEADER \u548c\u5176\u4ed6\u53ef\u9009\u5934\u90e8\u4fe1\u606f\u7684\u5927\u5c0f\uff0c\u6700\u7ec8\u7684**\u5b57\u8282\u6570**\u5c31\u662f\u4f60\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u503c\u3002 \u3000\u3000\u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u4ed6\u662f\u4e00\u4e2a4\u5b57\u8282\u7684\u3001\u7531ASCII\u5b57\u7b26\u7ec4\u6210\u7684\u3001\u552f\u4e00\u6807\u8bc6\u7684\u3001\u53d1\u751f\u5185\u5b58\u5206\u914d\u7684\u4ee3\u7801\u8def\u5f84\u3002 \u5bf9\u4e8e\u6267\u884c\u4f53\u5bf9\u8c61\u6765\u8bf4\u7684\u8bdd \uff0c\u8fd9\u4e2a\u6807\u7b7e\u662f\u7531 _OBJECT_TYPE.Key \u8fd9\u4e2a\u5c5e\u6027\u6d3e\u751f\u7684\uff0c\u4e8c\u8005\u90fd\u662f4\u5b57\u8282\uff0c\u6240\u4ee5\u540c\u4e00\u4e2a\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4ed6\u4eec\u7684Tag\u53c2\u6570\u662f\u4e00\u6837\u7684\u3002 \u4e00\u4e2a\u5206\u914d\u5b9e\u4f8b \u00b6 \u4e0b\u9762\u4e3e\u4e00\u4e2a\u6817\u5b50\uff0c\u770b\u770b\u4e00\u4e2a\u8fdb\u7a0b\u5728\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u65f6\u662f\u600e\u4e48\u8fdb\u884c\u7684\uff1a 1. \u5f53\u524d\u8fdb\u7a0b\u8c03\u7528CreateFileA(ASCII\u683c\u5f0f)\u6216\u8005CreateFileW(Unicode\u683c\u5f0f)\uff0c\u8fd9\u4e24\u4e2a\u51fd\u6570\u90fd\u662fkernel32.dll\u4e2d\u7684\u51fd\u6570\u3002 2. CreateFileA\u6216\u8005CreateFileW\u51fd\u6570\u4f7f\u7528\u4e86ntdll.dll\u5e93\uff0c\u8fd9\u4e2a\u5e93\u968f\u540e\u4f1a\u8c03\u7528\u5185\u6838\u51fd\u6570NtCreateFile\u3002 3. NtCreateFile\u51fd\u6570\u4f1a\u8c03\u7528ObCreateObject\u51fd\u6570\u6765\u7533\u8bf7\u4e00\u4e2a\u65b0\u7684FIle\u7c7b\u578b\u7684\u5bf9\u8c61\u3002 4. ObCreateObject\u51fd\u6570\u4f1a\u8ba1\u7b97_FILE_OBJECT\u7ed3\u6784\u4f53\u7684\u5927\u5c0f\uff0c\u5305\u62ec\u5bf9\u8c61\u7684\u53ef\u9009\u5934\u90e8\u4fe1\u606f\u7684\u7a7a\u95f4\u7a7a\u95f4\u3002 5. ObCreateObject\u51fd\u6570\u67e5\u627eFile\u5bf9\u8c61\u7684_OBJECT_TYPE\u6570\u636e\u7ed3\u6784\uff0c\u5e76\u51b3\u5b9a\u662f\u653e\u5728\u5206\u9875\u5185\u5b58\u8fd8\u662f\u4e0d\u8981\u5206\u9875\u5185\u5b58\uff0c\u4ee5\u53ca\u786e\u5b9a4\u5b57\u8282\u7684tag 6. \u8c03\u7528ExAllocatePoolWithTag\u51fd\u6570\uff0c\u4f7f\u7528\u4e0a\u9762\u8ba1\u7b97\u51fa\u7684\u4e09\u4e2a\u53c2\u6570\uff1a\u5bf9\u8c61\u5927\u5c0f\u3001\u5185\u5b58\u7c7b\u578b\u3001tag \u3000\u3000\u4e0a\u8ff0\u6b65\u9aa4\u7ed3\u675f\u540e\uff0c\u4f1a\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u4e00\u4e2a _FILE_OBJECT \u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5e76\u4e14\u8fd9\u6b21\u5206\u914d\u4f1a\u88ab\u4e00\u4e2a4\u5b57\u8282\u7684tag\u6765\u552f\u4e00\u6807\u8bc6\u3002\u5f53\u7136\u4e4b\u540e\u8fd8\u4f1a\u6709\u4e00\u4e2a\u6307\u5411\u8be5\u5bf9\u8c61\u7684\u6307\u9488\u88ab\u6dfb\u52a0\u5230\u8be5\u8fdb\u7a0b\u7684\u53e5\u67c4\u8868\u4e2d\u3001\u64cd\u4f5c\u7cfb\u7edf\u5168\u5c40\u7684\u6c60\u4e2d\u6807\u7b7e\u8ddf\u8e2a\u6570\u636e\u5e93(tag tracking database)\u4e5f\u4f1a\u8fdb\u884c\u76f8\u5e94\u7684\u66f4\u65b0\u3001\u8be5\u5bf9\u8c61\u4e2d\u5176\u4ed6\u7684\u5c5e\u6027\u4e5f\u4f1a\u88ab\u521d\u59cb\u5316\uff0c\u5982\uff1a\u6743\u9650(\u8bfb\u3001\u5199\u3001shan)\uff0c\u6587\u4ef6\u7684\u521b\u5efa\u8def\u5f84\u3002 \u3000\u3000\u53e6\u5916\u8865\u5145\u4e00\u70b9\uff1a\u5e76\u975e\u4f7f\u7528\u76f8\u540c\u5927\u5c0f\u3001tag\u503c\u3001\u5185\u5b58\u7c7b\u578b\u7684\u5bf9\u8c61jiu\u5c31\u4f1a\u88ab\u5206\u914d\u5230\u8fde\u7eed\u7684\u5185\u5b58\u4e2d\uff0c\u8fd9\u4e48\u8bf4\u662f\u56e0\u4e3awindows\u4f1a\u5c1d\u8bd5\u5c06\u5927\u5c0f\u8fd1\u4f3c\u7684\u5bf9\u8c61\u653e\u5728\u4e00\u8d77\uff0c\u524d\u63d0\u662f\u6ca1\u6709\u53ef\u7528\u7684\u7a7a\u95f2\u5757\u6765\u6ee1\u8db3\u8bf7\u6c42\u7684\u5927\u5c0f\u4e86\uff0c\u5185\u6838\u4f1a\u4ece\u4e0b\u4e00\u4e2a\u5927\u7684\u7ec4\u4e2d\u6765\u9009\u62e9\u4e00\u4e2a\u5757\u7528\u4e8e\u5206\u914d\u3002\u8fd9\u6837\u7684\u7ed3\u679c\u5c31\u662f\u4f60\u4f1a\u770b\u5230\u540c\u4e00\u7c7b\u578b\u7684\u5bf9\u8c61\u5206\u6563\u5728windows\u7684\u6c60\u4e2d\u3002\u6b64\u5916\uff0c\u8fd9\u6837\u7684\u5206\u914d\u7279\u70b9\u4f1a\u5bfc\u81f4\u5c0f\u7684\u6570\u636e\u7ed3\u6784\u5360\u7528\u4e86\u4e00\u4e2a\u7528\u4e8e\u50a8\u5b58\u5927\u7684\u6570\u636e\u7ed3\u6784\u7684\u5185\u5b58\u5757\uff0c\u5f62\u6210\u4e86\u4e00\u79cd\u677e\u6563\u7684\u7ed3\u6784(slack space)\uff0c\u5982\u679c\u6ca1\u6709\u9002\u5f53\u7684\u6e05\u7406\u5185\u5b58\u7684\u8bdd\u3002\u8be6\u7ec6\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0 The Impact of Windows Pool Allocation Strategies on Memory Forensics De-allocation and Reuse (\u91ca\u653e\u548c\u91cd\u7528) \u00b6 \u5728\u4e0a\u8ff0\u7684\u8fdb\u7a0b\u521b\u5efa\u6587\u4ef6\u7684\u4f8b\u5b50\u4e2d\uff0c\u8fd9\u4e2a\u88ab\u521b\u5efa\u7684\u6587\u4ef6\u7684\u76f8\u5173\u6570\u636e\u7ed3\u6784_FILE_OBJECT\u7684\u751f\u5b58\u65f6\u95f4(\u5728\u5185\u5b58\u4e2d\u7684\u5b58\u5728\u65f6\u95f4)\uff0c\u53d6\u51b3\u4e8e\u5f88\u591a\u56e0\u7d20\u3002\u8fd9\u91cc\u8ba8\u8bba\u4e0b\u91ca\u653e\u548c\u91cd\u7528(De-allocation and Reuse) \u5728\u8fd9\u4e9b\u56e0\u7d20\u4e2d\uff0c\u552f\u4e00\u7684\u3001\u6700\u91cd\u8981\u7684\u56e0\u7d20\u662f\u8fd9\u4e2a\u8fdb\u7a0b\u7ed3\u675f\u8bfb\u6216\u5199\u65b0\u6587\u4ef6\u65f6(\u901a\u8fc7\u8c03\u7528CloseHandle)\u65f6\uff0c\u7528\u4e86\u591a\u4e45\u7684\u65f6\u95f4\uff0c\u539f\u6587\uff1a how soon the process indicates (by calling CloseHandle ) that it is finished reading or writing the new file. \uff0c\u6b64\u65f6\uff0c \u5982\u679c\u6216\u6ca1\u6709\u5176\u4ed6\u7684\u8fdb\u7a0b\u4f7f\u7528\u8fd9\u4e2a\u6587\u4ef6\u5bf9\u8c61 \uff0c\u90a3\u4e48\u8fd9\u5757\u5185\u5b58\u5c31\u4f1a\u88ab\u91ca\u653e\u4f1a\u6c60\u4e2d\u7684**\u7a7a\u95f2\u5217\u8868**(free list)\uff0c\u8fd9\u6837\u8fd9\u5757\u5185\u5b58\u5c31\u53ef\u4ee5\u88ab\u91cd\u65b0\u5206\u914d\u4ee5\u4f9b\u4ed6\u7528\u3002\u5728\u7b49\u5f85\u88ab\u91cd\u65b0\u5206\u914d\u7684\u65f6\u5019\u6216\u8005\u7b49\u5f85\u5199\u5165\u65b0\u6570\u636e\u5230\u5185\u5b58\u65f6\uff0c\u5927\u90e8\u5206\u539f\u5148\u7684(\u91ca\u653e\u524d)\u7684_FILE_OBJECT\u7684\u5185\u5bb9\u4f1a\u4fdd\u6301\u5b8c\u6574(will remain intact)\u3002 \u3000\u3000\u7a76\u7adf\u8fd9\u5757\u5185\u5b58\u505c\u7559\u5728\u5b8c\u6574\u7684\u72b6\u6001(\u4e0a\u8ff0\u72b6\u6001)\u591a\u4e45\uff0c\u53d6\u51b3\u4e8e\u7cfb\u7edf\u7684\u6d3b\u52a8\u7b49\u7ea7(activity level)\u3002\u5982\u679c\u7cfb\u7edf\u5728\u731b\u70c8\u7684\u6296\u52a8(thrashing)\uff0c\u5e76\u4e14\u540e\u7eed\u8bf7\u6c42\u7684\u5185\u5b58\u5c0f\u4e8e\u6216\u7b49\u540c\u4e8e _FILE_OBJECT (\u8fd9\u4e2a\u4f8b\u5b50\u4e2d)\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u8fc5\u901f\u7684\u590d\u5199\uff1b\u5426\u5219\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u4f1a\u751f\u5b58\u51e0\u5929\u6216\u8005\u51e0\u4e2a\u661f\u671f---\u9664\u975e\u521b\u5efa\u8fd9\u4e2a\u6587\u4ef6\u7684\u8fdb\u7a0b\u7ed3\u675f\u4e86\u3002 \u3000\u3000**\u6ce8\u610f\uff1a**\u5f53\u4e00\u5757\u6c60\u7684\u5185\u5b58\u88ab\u91ca\u653e\u7684\u65f6\u5019\uff0c\u5e76\u4e0d\u662f\u76f4\u63a5\u88ab\u590d\u5199\u4e86\uff0c\u800c\u662f\u7b80\u5355\u7684\u6807\u8bb0\u4e3a\u4e86 free \u3002\u8fd9\u5bf9\u4e8e\u786c\u76d8\u53d6\u8bc1(disk forensics)\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u5f53\u4e00\u4e2aNTFS\u7684\u6587\u4ef6\u88ab\u5220\u9664\u65f6\uff0c\u53ea\u6709\u4e3b\u6587\u4ef6\u8868(Master File Table, MFT)\u4f1a\u76f8\u5e94\u7684\u6539\u53d8\u72b6\u6001\uff0c\u800c\u6587\u4ef6\u7684\u5185\u5bb9\u4f1a\u4fdd\u6301\u4e0d\u53d8---\u76f4\u5230\u8be5\u5206\u914d\u7684\u7c07(sectors\uff0c\u5206\u914d\u662f\u6309\u7c07\u5206\u914d\u7684\uff0c\u5982NTFS\u4e2d\u4e00\u4e2a\u7c07\u662f4096\u5b57\u8282)\u88ab\u91cd\u65b0\u5206\u914d\u7ed9\u4e86\u65b0\u7684\u6587\u4ef6\uff0c\u5e76\u4e14\u53d1\u751f\u4e86\u5199\u4e8b\u4ef6\u3002\u57fa\u4e8e\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5df2\u7ecf\u88ab\u64cd\u4f5c\u7cfb\u7edf\u91ca\u653e\u7684\u5185\u5b58\u4e2d\u627e\u5230\u6267\u884c\u4f53\u5bf9\u8c61\u3002\u8fd9\u6837\u4f60\u5c31\u83b7\u5f97\u4e86\u5728\u5185\u5b58\u4e2d\u67e5\u627e\u4e0d\u4ec5\u662f\u5f53\u524d\u5e38\u7528\u7684\u6267\u884c\u4f53\u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u67e5\u627e\u8fc7\u53bb\u5b58\u5728\u8fc7\u7684\u8d44\u6e90\u3002 \u3000\u3000 Pool-Tag Scanning (\u6c60\u6807\u7b7e\u626b\u63cf) \u00b6 \u6c60\u6807\u7b7e\u626b\u63cf\uff0c\u4e5f\u53eb\u6c60\u626b\u63cf(pool-scanning)\uff0c\u662f\u6839\u636e\u4e0a\u9762\u63d0\u5230\u7684_POOL_HEADER.PoolTag\u6765\u8fdb\u884c\u5206\u914d\u67e5\u627e\u7684\u65b9\u6cd5\u3002 \u4e3e\u4e00\u4e2a\u6817\u5b50\uff0c\u4e3a\u4e86\u5b9a\u4f4d\u4e00\u4e2a\u8fdb\u7a0b\u5bf9\u8c61\uff0c\u4f60\u53ef\u4ee5\u627e**\u5185\u6838\u7b26\u53f7\u8868**(Kernel Symbol)\u4e2d\u7684\u6d3b\u52a8\u8fdb\u7a0b\u94fe\u8868PsAcvtivePeorecssList(\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\uff0c\u4fdd\u5b58\u7740\u7cfb\u7edf\u4e2d\u6240\u6709\u8fdb\u7a0b\u7684EPROCESS\u7ed3\u6784)\uff0c\u7136\u540e\u904d\u5386\u8fd9\u4e2a\u8fdb\u7a0b\u8868\u3002\u6216\u8005\uff0c\u4f7f\u7528\u6c60\u626b\u63cf\u7684\u65b9\u6cd5\uff0c\u4ed6\u4f1a\u7ffb\u6574\u4e2a\u5185\u5b58\u6587\u4ef6\uff0c\u53bb\u67e5\u627eProc\u6807\u8bb0(\u4e0e_EPROCESS\u76f8\u5173\u7684\u56db\u5b57\u8282\u6807\u8bb0)\u3002\u4f7f\u7528\u540e\u8005\u65b9\u5f0f\u7684\u4f18\u70b9\u662f\u4f60\u53ef\u4ee5\u4ece\u8868\u4e2d\u53d1\u73b0\u4e00\u4e9b\u5386\u53f2\u6761\u76ee(\u4e0d\u518d\u8fd0\u884c\u7684\u8fdb\u7a0b)\uff0c\u6216\u8005\u53ef\u4ee5\u627e\u5230\u4e00\u4e9brootkit\u7684\u75d5\u8ff9(\u6bd4\u5982Direct Kernel Object Manipulation \uff0c DKOM ) \u3000\u3000\u4f46\u662f\u4f60\u4e5f\u4e0d\u80fd\u5168\u9760\u4e2atag\u6765\u51b3\u5b9a\uff0c\u5426\u5219\u4f1a\u6709\u5927\u91cf\u7684\u9519\u8bef\u3002\u6240\u4ee5Volatility\u5185\u5efa\u4e86\u4e00\u4e2a\u66f4\u725b\u903c\u7684\"\u7b7e\u540d\"\u6765\u5e2e\u52a9\u4f60\u5206\u8fa8\u5185\u5b58\u4e2d\u4f60\u60f3\u8981\u7684\u5206\u914d\u5355\u5143\uff0c\u539f\u7406\u5c31\u662f\u524d\u9762\u5c0f\u8282\u53d9\u8ff0\u7684\u3002\u6bd4\u5982\u5206\u914d\u5355\u5143\u7684\u5927\u5c0f\u3001\u5185\u5b58\u7684\u7c7b\u578b(\u5206\u6ca1\u5206\u9875)\u90fd\u80fd\u5e2e\u52a9\u51cf\u5c0f\u9519\u8bef\u3002\u5047\u5982\u4f60\u8981\u627e\u4e2a100\u5b57\u8282\u7684_EPROCESS\u7ed3\u6784\u4f53\uff0c\u4f46\u662f\u4f60\u9488\u5177\u6807\u7b7e\uff0c\u5374\u627e\u5230\u4e86\u4e00\u4e2a30\u5b57\u8282\u7684\u5355\u5143\uff0c\u90a3\u663e\u7136\u662f\u4e0d\u5bf9\u7684\u3002\u9664\u4e86tag\u3001\u5927\u5c0f\u3001\u5185\u5b58\u7c7b\u578b\u5916\uff0cVolatility\u7684pool-scanning\u8fd8\u652f\u6301\u81ea\u5b9a\u4e49\u4e00\u4e9b\u7ea6\u675f\u6765\u5e2e\u52a9\u641c\u7d22\u3002\u6bd4\u5982\u4f60\u53ef\u4ee5\u52a0\u4e2a\u65f6\u95f4\u6233\u3002 \u3000\u3000 Pool Tag Sources (\u6c60\u6807\u8bb0\u6e90) \u00b6 \u4e0b\u9762\u8fd9\u5f20\u8868Volatility\u901a\u8fc7pool scanning\u6765\u67e5\u627e\u6307\u5b9a\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u6807\u51c6\uff0c\u7b2c\u56db\u5217\u7684\u6700\u5c0f\u5927\u5c0f\u90fd\u6dfb\u52a0\u4e86_EPROCESS(\u5bf9\u4e8eprocess\u5bf9\u8c61)\u3001_OBJECT_HEADER\u3001\u4ee5\u53ca_POOL_HEADER\u3002\u6700\u540e\u4e00\u5217\u662f\u5bf9\u5e94\u7684\u63d2\u4ef6\uff0c\u7ecf\u5e38\u4f1a\u4f7f\u7528\u5230\u3002 \u3000\u3000 \u3000\u3000\u4f46\u662f\u4e0a\u9762\u8fd9\u4e9b\u6570\u636e\u4e0d\u662f\u56fa\u5b9a\u7684\uff0c\u5f53windows\u6709\u65b0\u7248\u672c\u51fa\u6765\u7684\u65f6\u5019\uff0c\u90fd\u53ef\u80fd\u8981\u4fee\u6539\uff0c\u800c\u4e14\u5982\u679c\u6709\u6076\u610f\u7684\u5185\u6838\u9a71\u52a8\u4ece\u6c60\u4e2d\u7533\u8bf7\u7a7a\u95f4\u6765\u5b58\u653e\u5b83\u7684\u6570\u636e(\u5982\uff1a\u914d\u7f6e\u4fe1\u606f,\u547d\u4ee4\u548c\u63a7\u5236\u6570\u636e\u5305,\u9700\u8981\u9690\u85cf\u7684\u7cfb\u7edf\u8d44\u6e90\u7684\u540d\u79f0\u7b49\u7b49)\u3002\u6240\u4ee5\u4f60\u53ef\u80fd\u9700\u8981\u81ea\u5df1\u4fee\u6539\u673a\u5236\u6765\u5305\u542b\u65b0\u7684\u6807\u51c6\u3002 \u3000\u3000\u6b64\u5916\uff0c\u6ce8\u610f\u4e00\u4e0b\u4e0a\u8868\u4e2d\u7684\u7b2c\u4e09\u5217\u3002\u5173\u4e8e\u5185\u6838\u6c60\u6807\u8bb0\u6700\u4e0d\u5e38\u89c1\u7684\u4e00\u4e2a\u590d\u6742\u7279\u6027\u5c31\u662f\u53d7\u4fdd\u62a4\u4f4d(the protected bit).\u5f53\u6211\u4eec\u901a\u8fc7 ExFreePoolWithTag \u91ca\u653e\u4e00\u4e2a\u5185\u6838\u6c60\u7684\u65f6\u5019,\u6211\u4eec\u5fc5\u987b\u8bbe\u7f6e\u8ddf\u5f53\u521d\u7533\u8bf7\u7a7a\u95f4\u65f6\u6240\u7528\u7684 ExAllocatePoolWithTag \u4e00\u6837\u7684\u6807\u8bb0\u3002\u8fd9\u9879\u6280\u672f\u662f\u64cd\u4f5c\u7cfb\u7edf\u7528\u6765\u9632\u6b62\u9a71\u52a8\u7a0b\u5e8f\u610f\u5916\u91ca\u653e\u5185\u5b58\u800c\u8bbe\u8ba1\u7684.\u5982\u679c\u4f20\u9012\u7ed9\u91ca\u653e\u51fd\u6570\u7684\u6807\u8bb0\u4e0d\u5339\u914d,\u90a3\u4e48\u7cfb\u7edf\u5c06\u629b\u51fa\u4e00\u4e2a\u5f02\u5e38\u3002\u8fd9\u5bf9\u4e0e\u5185\u5b58\u53d6\u8bc1\u6765\u8bf4\u6709\u5f88\u5927\u7684\u5f71\u54cd,\u56e0\u4e3a\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u5c31\u9700\u8981\u5bfb\u627e\u53d7\u4fdd\u62a4\u7684\u5185\u6838\u6c60\u6807\u8bb0\u3002 \u3000\u3000\u5185\u6838\u6c60\u6807\u8bb0\u4e2d\u53d7\u4fdd\u62a4\u7684\u4f4d\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5185\u5b58\u5206\u914d\u90fd\u4f1a\u8bbe\u7f6e,\u4ec5\u9650\u4e0e\u67d0\u4e9b\u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b.\u6b64\u5916,\u4eceWindows 8\u548cWindows Server 2012\u5f00\u59cb,\u8c8c\u4f3c\u5185\u6838\u6c60\u6807\u8bb0\u4e2d\u53d7\u4fdd\u62a4\u4f4d\u53d6\u6d88\u4e86\u3002\u5173\u4e8e\u53d7\u4fdd\u62a4\u7684\u4f4d\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\u53ef\u4ee5\u53c2\u8003 \u8fd9\u7bc7\u6587\u7ae0 \u3000\u3000 Pooltag File \u00b6 \u6b63\u5982\u4e4b\u524d\u6240\u63d0\u5230\u7684\uff0c \u5fae\u8f6f\u521b\u5efa\u6c60\u6807\u8bb0\u662f\u4e3a\u4e86\u8c03\u8bd5\u548c\u5ba1\u8ba1\u7684\u76ee\u7684 \u3002\u56e0\u6b64\uff0cWindows\u9a71\u52a8\u5f00\u53d1\u5305(DDK\u6216\u8005WDK)\u548cWindows\u8c03\u8bd5\u5de5\u5177\u7684\u5b89\u88c5\u76ee\u5f55\u4e2d\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u540d\u4e3a pooltag.txt \u7684\u6587\u4ef6,\u8fd9\u4e2a\u6587\u4ef6\u6211\u4eec\u53ef\u4ee5\u7528\u4e8e\u67e5\u627e\u3002\u4e3e\u4e2a\u6817\u5b50\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u6c60\u6807\u8bb0(pool tag)\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u786e\u5b9a\u8be5\u5185\u5b58\u5206\u914d\u7684\u76ee\u7684\u4ee5\u53ca\u62e5\u6709\u8fd9\u5757\u5185\u5b58\u7684\u5185\u6838\u9a71\u52a8\u3002\u56e0\u4e3a\u8be5\u6587\u4ef6\u4e2d\u5305\u542b\u6709\u63cf\u8ff0\u4fe1\u606f\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u53ef\u4ee5\u4ece\u8bf8\u5982\"\u8fdb\u7a0b\u5bf9\u8c61\"(process object)\u6216\u8005\"\u6587\u4ef6\u5bf9\u8c61\"(File object)\u8fd9\u6837\u7684\u5173\u952e\u5b57\u5165\u624b\uff0c\u8fdb\u800c\u627e\u51fa\u5176\u6c60\u6807\u8bb0\u3002 \u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2apooltag.txt\u6587\u4ef6\u7684\u90e8\u5206\u5185\u5bb9\uff0c\u4f60\u53ef\u4ee5\u5728\u4f60windbg\u7684triage\u6587\u4ef6\u5939\u4e2d\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\uff1a rem rem Pooltag.txt rem rem This file lists the tags used for pool allocations by kernel mode components rem and drivers. rem rem The file has the following format: rem <PoolTag> - <binary-name> - <Description> rem rem Pooltag.txt is installed with Debugging Tools for Windows (%windbg%\\triage) rem and with the Windows DDK (in %winddk%\\tools\\other\\platform\\poolmon, where rem platform is amd64, i386, or ia64). rem AdSv - vmsrvc.sys - Virtual Machines Additions Service ARPC - atmarpc.sys - ATM ARP Client ATMU - atmuni.sys - ATM UNI Call Manager [snip] Proc - nt!ps - Process objects //\u6ce8\u610f\u8fd9\u91cc Ps - nt!ps - general ps allocations [snip] RaDA - tcpip.sys - Raw Socket Discretionary ACLs RaEW - tcpip.sys - Raw Socket Endpoint Work Queue Contexts bookist.cc Part II: Windows Memory Forensics 132 RaJP - tcpip.sys - Raw Socket Join Path Contexts RaMI - tcpip.sys - Raw Socket Message Indication Tags \u3000\u3000\u5728\u659c\u7ebf\u6807\u6ce8\u7684\u5730\u65b9\u6307\u51fa\uff1a\u8fdb\u7a0b\u5bf9\u8c61\u7684\u6807\u7b7e\u662f Proc \uff0c\u7531nt!ps\u6765\u5206\u914d\uff0cnt!ps\u662fNT\u7684\u8fdb\u7a0b\u5b50\u7cfb\u7edf\u3002\u5f97\u5230\u4e86\u8fd9\u4e2a\u4fe1\u606f\u540e\uff0c\u4f60\u8fd8\u9700\u8981\u627e\u5230\u8fd1\u4f3c\u7684\u5206\u914d\u5927\u5c0f\u4ee5\u53ca\u5185\u5b58\u7684\u7c7b\u578b(\u5206\u9875?\u4e0d\u5206\u9875?)\u3002 \u3000\u3000\u5728\u8fd9\u4e2a \u7f51\u5740 \u4e2d\u4f60\u4e5f\u53ef\u4ee5\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4f46\u662f\u91cc\u9762\u7684\u5185\u5bb9\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u63d0\u4ea4\uff0c\u6240\u4ee5\u4e0d\u4e00\u5b9a\u51c6\u786e\uff0cwindbg\u5b89\u88c5\u76ee\u5f55\u4e0b\u5c31\u6709\u8fd9\u4e2a\u6587\u4ef6\u3002 PoolMon Utility (\u5185\u5b58\u6c60\u76d1\u89c6\u5668) \u00b6 PoolMon (poolmon.exe) \u5185\u5b58\u6c60\u76d1\u89c6\u5668\uff0c\u663e\u793a\u7684\u64cd\u4f5c\u7cfb\u7edf\u4ece\u5206\u9875\u7cfb\u7edf\u6536\u96c6\u6709\u5173\u5185\u5b58\u5206\u914d\u6570\u636e\u548c\u975e\u5206\u9875\u7684\u5185\u6838\u6c60\u548c\u7528\u4e8e\u7ec8\u7aef\u670d\u52a1\u4f1a\u8bdd\u4f7f\u7528\u7684\u5185\u5b58\u6c60\u3002 \u6309\u6c60\u5206\u914d\u6807\u8bb0\u5206\u7ec4\u6570\u636e\u3002\u9a71\u52a8\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u548c\u6d4b\u8bd5\u4eba\u5458\u901a\u5e38\u4f7f\u7528 PoolMon \u68c0\u6d4b\u5185\u5b58\u6cc4\u6f0f\u65f6\u4e0d\u521b\u5efa\u65b0\u7684\u9a71\u52a8\u7a0b\u5e8f\u3001 \u66f4\u6539\u9a71\u52a8\u7a0b\u5e8f\u4ee3\u7801\u4e2d\uff0c\u6216\u5f3a\u8c03\u8be5\u9a71\u52a8\u7a0b\u5e8f\u3002 \u6b64\u5916\u53ef\u4ee5\u4f7f\u7528 PoolMon \u6d4b\u8bd5\u7684\u6bcf\u4e2a\u9636\u6bb5\u4e2d\u53ef\u67e5\u770b\u5206\u914d\u548c free \u64cd\u4f5c\u7684\u9a71\u52a8\u7a0b\u5e8f\u7684\u6a21\u5f0f\uff0c\u5e76\u4ee5\u663e\u793a\u8be5\u9a71\u52a8\u7a0b\u5e8f\u4f7f\u7528\u5728\u4efb\u4f55\u7ed9\u5b9a\u65f6\u95f4\u7684\u6c60\u5185\u5b58\u91cf\u3002 \u4e0a\u8ff0\u5bf9PoolMon\u7684\u63cf\u8ff0\u6765\u81ea \u5fae\u8f6f\u5b98\u65b9\u8bf4\u660e \u3002poolMon\u5728DDK(Micrsoft's Driver Development, DDK\uff0c\u4e5f\u53ebWDK)\u4e2d\u53ef\u4ee5\u627e\u5230\u3002\u5b83\u4f1a\u62a5\u544a\u7cfb\u7edf\u4e2d\u4f7f\u7528\u7684\uff0c\u5173\u4e8e\u6c60\u6807\u7b7e\u5b9e\u65f6\u7684\u66f4\u65b0\uff0c\u4ee5\u53ca\u4ee5\u4e0b\u4fe1\u606f\uff1a \u5185\u5b58\u7c7b\u578b(\u662f\u5426\u5206\u9875) \u5206\u914d\u6570\u91cf \u7a7a\u95f2\u6570\u91cf \u5206\u914d\u5360\u7528\u7684\u5b57\u8282\u7684\u603b\u6570 \u5e73\u5747\u6bcf\u4e00\u4e2a\u5206\u914d\u5360\u7528\u7684\u5b57\u8282\u6570 \u3000\u3000\u4f60\u53ef\u4ee5 \u4ece\u8fd9\u91cc \u4e0b\u8f7dDDK\uff0c\u5728 C:\\Program Files (x86)\\Windows Kits\\10\\Tools\\x64 \u8def\u5f84\u5c31\u53ef\u4ee5\u770b\u5230\u8be5\u5de5\u5177\u3002\u4f7f\u7528\u5de5\u5177\u7684-b\u9009\u9879\u53ef\u4ee5\u4ee5\u5b57\u8282\u7684\u683c\u5f0f\u6574\u7406\u6570\u636e\uff0c\u5c06\u6700\u5bf9\u5185\u5b58\u654f\u611f\u7684\u6807\u7b7e\u5148\u5217\u51fa\u6765\uff0c\u4e0b\u56fe\u662f\u6211\u5728win10\u4e0a\u7684\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000\u5bf9\u6211\u6211\u8fd9\u91cc\u7684\u622a\u56fe\u6765\u8bf4\uff0c\u6211\u5f53\u524dMmSt\u6807\u7b7e\u662f\u5728\u6bd4\u7279\u6570\u91cf(Bytes\u5217)\u6392\u5e8f\u4e2d\u662f\u7b2c\u4e00\u4e2a\uff0c\u4ece\u7cfb\u7edf\u5f00\u59cb\u5230\u622a\u56fe\u8fd9\u4e00\u523b\uff0c\u8fd9\u4e2a\u6807\u7b7e\u8c03\u7528\u4e86503058\u6b21 exAllocatePoolWithTag \u51fd\u6570(\u7b2c\u4e09\u5217)\uff0c\u5176\u4e2d431441\u4e2a\u6c60\u88ab\u91ca\u653e\u4e86\uff0c\u4e8c\u8005\u7684\u5dee\u4e3a71,617(Diff\u5217)\uff0c\u5373\u5f53\u524d\u670971617\u4e2a\u6c60\u88ab\u5206\u914d\uff0c\u4ed6\u4eec\u603b\u5171\u5360\u7528\u4e86324342208\u4e2a\u5b57\u8282\u7684\u5185\u5b58(\u5927\u6982324.3MB)\uff0c\u5e73\u5747\u7b97\u4e0b\u6765\u4e00\u4e2a\u6c60\u5360\u4e86\u5185\u5b58\u7ea6\u4e3a4528\u5b57\u8282\u3002 \u3000\u3000\u5728\u7b2c\u4e00\u4e2a\u767d\u8272\u7684\u6760\u4e0b\u9762\u7b2c\u4e8c\u6760\u6709\u4e00\u4e2aCM25\u6807\u7b7e\uff0c\u5927\u6982\u5360\u4e86\u5185\u5b5816MB\uff0cCM\u7684\u610f\u601d\u662f\u914d\u7f6e\u7ba1\u7406\u5668(Configuration Manager)\uff0c\u5b83\u662f\u4e00\u4e2a\u5305\u542b\u7740windows\u6ce8\u518c\u8868\u7684\u5185\u6838\u7ec4\u4ef6\u3002\u6240\u6709\u8fd9\u4e9bCM\u6807\u7b7e\u52a0\u8d77\u6765\u7684\u603b\u548c\u5927\u6982\u5c31\u662f\u4f60\u6ce8\u518c\u8868\u7684\u5927\u5c0f\uff0c\u4f46\u662f\u4f60\u4e0d\u53ef\u80fd\u628a\u4ed6\u4eec\u90fd\u4ece\u5185\u5b58\u4e2ddump\u51fa\u6765\uff0c\u56e0\u4e3a\u50a8\u5b58\u5728\u5206\u9875\u5185\u5b58\u4e2d\u7684\u6807\u7b7e\u5b83\u7684\u6570\u636e\u53ef\u80fd\u4f1a\u6620\u5c04\u5230\u78c1\u76d8\u4e0a\uff0c\u800c\u4f60\u624b\u5934\u53ea\u6709\u5185\u5b58\u3002 \u3000\u3000\u6b64\u5916\uff0c\u7b2c\u4e00\u4e2a\u767d\u8272\u7684\u6760\u662f\u4e00\u4e2aFile\u6807\u7b7e\uff0c\u5b83\u50a8\u5b58\u7740\u4e00\u4e2a_FILE_OBJECT\u6570\u636e\u7ed3\u6784\uff0c\u53ef\u4ee5\u770b\u5230\u5927\u69829900000\u4e2a\u6c60\u88ab\u521b\u5efa\uff0c\u5b83\u7684\u7279\u70b9\u662f\u6bcf\u6b21\u6587\u4ef6\u88ab\u6253\u5f00\u6216\u8005\u521b\u5efa\u7684\u65f6\u5019\u90fd\u4f1a\u5206\u914d\u4e00\u4e2a_FILE_OBJECT\u7ed3\u6784\u4f53\u3002\u4f46\u662f\u56e0\u4e3a\u6587\u4ef6\u5bf9\u8c61\u90fd\u76f8\u5bf9\u5c0f\u4e00\u70b9\uff0c\u6240\u4ee5\u53ef\u4ee5\u770b\u5230\u5b9e\u9645\u4e0a\u53ea\u670945265\u5b57\u8282\u88ab\u771f\u6b63\u5206\u914d\uff0c\u5e73\u5747\u6bcf\u4e2a\u6c60399\u5b57\u8282\u3002 \u3000\u3000\u5de6\u624b\u4e00\u4e2apoolMon\u53f3\u624b\u4e00\u4e2apooltag.txt\uff0c\u57fa\u672c\u4f60\u5c31\u638c\u63e1\u4e86\u6c60\u6807\u7b7e\uff0c\u76f8\u5e94\u63cf\u8ff0\uff0c\u6240\u5c5e\u5185\u6838\u9a71\u52a8\uff0c\u5206\u914d\u5927\u5c0f\uff0c\u5185\u5b58\u7c7b\u578b\u8fd9\u4e9b\u4fe1\u606f\u4e86\u3002\u8fd9\u4e9b\u4fe1\u606f\u5c31\u8db3\u591f\u4f60\u5f00\u59cb\u626b\u63cf\u5185\u5b58\u5bfc\u51fa\u6587\u4ef6\uff0c\u67e5\u627e\u5206\u914d\u7684\u5b9e\u4f8b\u4e86\u3002 \u3000\u3000\u4e3a\u4e86\u5b66\u4e60\u65b9\u4fbf\uff0c\u4f60\u8fd8\u53ef\u4ee5\u5728windbg\u4e2d\u4f7f\u7528!poolfind\u547d\u4ee4\u6765\u67e5\u627e\u4f60\u60f3\u8981\u7684\u6807\u7b7e\u5e76\u544a\u8bc9\u4f60\u5185\u5b58\u7c7b\u578b\u548c\u5206\u914d\u7684\u5927\u5c0f\uff0c\u6bd4\u5982\u4e66\u4e0a\u7684\u8fd9\u4e2a\u6817\u5b50\uff1a kd> !poolfind Proc Searching NonPaged pool (fffffa8000c02000 : ffffffe000000000) for Tag: Proc *fffffa8000c77000 size: 430 previous size: 0 (Allocated) Proc (Protected) *fffffa8001346000 size: 430 previous size: 0 (Allocated) Proc (Protected) *fffffa8001361000 size: 430 previous size: 0 (Allocated) Proc (Protected) *fffffa800138f7a0 size: 430 previous size: 30 (Free) Pro. *fffffa80013cb1e0 size: 430 previous size: c0 (Allocated) Proc (Protected) *fffffa80013e4460 size: 430 previous size: f0 (Allocated) Proc (Protected) *fffffa80014fd000 size: 430 previous size: 0 (Allocated) Proc (Protected) *fffffa800153ebd0 size: 10 previous size: 70 (Free) Pro. [snip] \u3000\u3000\u4ece\u4e0a\u9762\u7684\u4fe1\u606f\u4f60\u53ef\u4ee5\u770b\u5230\uff0c\u6709\u516d\u4e2a\u88ab\u5206\u914d\u4e86\u7684\u8fdb\u7a0b\uff0c\u6709\u4e24\u4e2a\u88ab\u6807\u8bb0\u4e3afree\uff0c\u5176\u4e2d\u4e00\u4e2afree\u7684\u5927\u5c0f\u548c\u5176\u4ed6\u4e00\u6837\uff0c\u90fd\u662f430\uff0c\u800c\u53e6\u4e00\u4e2a\u662f10\u3002\u6240\u4ee5\u4f60\u53ef\u4ee5\u63a8\u65ad\u8fd9\u4e2a\u4f4d\u4e8e0xfffffa800138f7a0\u7684\u5757\u53ef\u80fd\u5305\u542b\u8fd9\u4e00\u4e2a\u7ec8\u6b62\u7684\u8fdb\u7a0b_EPROCESS\u6570\u636e\u7ed3\u6784\uff0c\u800c0xfffffa800153ebd0\u7684\u90a3\u4e2a\u5757\u53ef\u80fd\u88ab\u91cd\u7528\u4e86\u3002 Pool Tracker Tables (\u6c60\u8ddf\u8e2a\u5668\u8868) \u00b6 \u4e0a\u9762\u7684poolMon\u725b\u903c\u662f\u725b\u903c\uff0c\u95ee\u9898\u662f\u5185\u5b58\u53d6\u8bc1\u4e07\u4e00\u54b1\u53ea\u6709\u5185\u5b58\uff0c\u4e48\u5f97\u5b9e\u4f53\u673a\u548b\u8dd1poolMon.exe\uff1f\u6240\u5e78\u7684\u662f\u5185\u5b58\u4e2d\u5176\u5b9e\u662f\u5305\u542b\u4e86\u4e00\u4e9b\u9759\u6001\u6570\u636e\uff0c\u5b83\u4eec\u90fd\u4f1a\u88abpoolMon\u8bfb\u53d6\uff0c\u90a3\u600e\u4e48\u4e0d\u901a\u8fc7poolMon\u8bfb\u53d6\u8fd9\u4e9b\u6570\u636e\u5462\uff1f\u5b83\u4eec\u50a8\u5b58\u5728\u4e00\u4e2a\u5185\u6838\u8c03\u8bd5\u6570\u636e\u5757\u4e2d(_KDDEBUGGER_DATA64)\uff0c\u8fd9\u4e2a\u5757\u540c\u6837\u4e5f\u50a8\u5b58\u4e86\u6d3b\u52a8\u7684\u8fdb\u7a0b\u548c\u52a0\u8f7d\u7684\u6a21\u5757\u7684\u5217\u8868\u3002PoolTrackTable\u8868\u5b9e\u9645\u4e0a\u6307\u5411\u4e86\u4e00\u4e2a\u6570\u7ec4\uff0c\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u50a8\u5b58\u7740\u4e00\u4e9b\u540d\u4e3a _POOL_TRACKER_TABLE \u7684\u6570\u636e\u7ed3\u6784\uff0c\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u72ec\u7279\u7684\u5403\u6807\u7b7e\u90fd\u4f1a\u88ab\u8bb0\u5f55\uff0c\u4f7f\u7528volshell\u67e5\u770b\u4e00\u4e0b\uff0c\u8fd8\u662fWin7SP1x64: In [ 2 ] : dt ( \"_POOL_TRACKER_TABLE\" ) '_POOL_TRACKER_TABLE' ( 40 bytes ) 0x0 : Key [ 'String' , { 'length' : 4 }] 0x4 : NonPagedAllocs [ 'long' ] 0x8 : NonPagedFrees [ 'long' ] 0x10 : NonPagedBytes [ 'unsigned long long' ] 0x18 : PagedAllocs [ 'unsigned long' ] 0x1c : PagedFrees [ 'unsigned long' ] 0x20 : PagedBytes [ 'unsigned long long' ] \u3000\u3000\u53ef\u4ee5\u770b\u5230\u6bcf\u4e00\u4e2a\u8ddf\u8e2a\u5668\u8868\u90fd\u6709\u4e00\u4e2a4\u5b57\u8282\u7684Key\u5c5e\u6027\uff0c\u5269\u4e0b\u7684\u5c5e\u6027\u6839\u636e\u5185\u5b58\u7684\u7c7b\u578b\u5206\u4e3a\u4e86\u4e24\u7c7b\uff0c\u5206\u522b\u544a\u8bc9\u4f60\u4e86\u5206\u914d\u7684\u6570\u91cf\u3001\u91ca\u653e\u7684\u6570\u91cf\u3001\u5360\u7528\u603b\u5b57\u8282\u6570\u3002\u867d\u7136\u5185\u5b58\u6587\u4ef6\u662f\u4e00\u4e2a\u65f6\u523b\u7684\uff0c\u5e76\u4e0d\u80fd\u9879poolMon\u90a3\u6837\u5b9e\u65f6\u7684\u66f4\u65b0\u6570\u636e\uff0c\u4f46\u662f\u4f60\u81f3\u5c11\u80fd\u5224\u65ad\u51fa\u6765\u5b83\u5728\u8fd9\u4e00\u65f6\u523b(\u5185\u5b58\u5bfc\u51fa\u65f6)\u7684\u72b6\u6001\uff0c\u4e0b\u9762\u4f7f\u7528volatility\u7684 pooltracker \u63d2\u4ef6\u6765\u67e5\u8be2\u51e0\u4e2a\u7279\u5b9a\u7684\u6267\u884c\u4f53\u5bf9\u8c61\u6807\u7b7e\uff0c Np \u4ee3\u8868\u4e0d\u5206\u9875\uff0c Pg \u4ee3\u8868\u5206\u9875\uff1a \u3000\u3000 \u3000\u3000\u4ece\u7ed3\u679c\u6765\u770b\uff0c\u8fd9\u56db\u4e2a\u6807\u7b7e\u7684\u5bf9\u8c61\u90fd\u5728\u975e\u5206\u9875\u7684\u5185\u5b58\u4e2d\uff0c\u4ece\u4e0a\u9762\u7684\u7ed3\u679c\u4f60\u53ef\u4ee5\u5f97\u5230\u6bd4\u5982\u8fd9\u6837\u7684\u4fe1\u606f\uff1a\u5bf9\u4e8eThre\u6807\u7b7e(Thread Object)\uff0c\u5b83\u5e73\u5747\u6c60\u5927\u5c0f\u4e3a252544/(23747-22436)=1311\u5b57\u8282\u3002\u6240\u4ee5\u5982\u679c\u8981\u67e5\u627e\u6240\u6709\u7684\u5305\u542b\u7ebf\u7a0b\u5bf9\u8c61\u7684\u5206\u914d\u6c60\u7684\u8bdd\uff0c\u4f60\u7684\u67e5\u627e\u7ea6\u675f\u6761\u4ef6\u5c31\u662f\u8fd9\u6837\u7684\uff1a1.\u662f Thre \u6807\u7b7e\uff1b2.\u5927\u5c0f\u81f3\u5c11\u662f1311\u5b57\u8282\u3002 \u3000\u3000\u6b64\u5916\u8fd9\u91cc\u6709\u51e0\u4e2a\u4f7f\u7528 pooltracker \u63d2\u4ef6\u7684\u5c0f\u6280\u5de7\uff1a \u3000\u3000\u5982\u679c\u4f60\u8981\u663e\u793a\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\u7684\u8bdd\uff0c\u53ef\u4ee5\u5e26\u5e26\u4e0a--tagfile\u53c2\u6570\uff0c\u53c2\u6570\u503c\u662f\u4f60\u7684pooltag.txt\u6587\u4ef6\uff0c\u8fd9\u6837\u8f93\u51fa\u5c31\u4f1a\u663e\u793a\u4e0a\u9762\u7ed3\u679c\u6ca1\u6709\u663e\u793a\u7684\u63cf\u8ff0\u4ee5\u53ca\u6240\u5c5e\u9a71\u52a8\u4e86\u3002\u6bd4\u5982\u8fd9\u6837(\u6211\u7528\u7684win7\u7684pooltag.txt\uff0c\u4ed6\u6bd4win10\u7684\u5c0f)\uff1a \u3000\u3000 \u3000\u3000**\u6ce8\u610f\uff1a**\u56e0\u4e3awindows\u5728XP\u548c2003\u4e4b\u524d(\u5305\u62ec\u4ed6\u4eec)\u4e0d\u4f1a\u5c06\u8fd9\u4e9b\u7edf\u8ba1\u6570\u636e\u5199\u5230\u6c60\u8ddf\u8e2a\u5668\u8868\u4e2d\uff0c\u6240\u4ee5\u8fd9\u4e2a\u63d2\u4ef6\u53ea\u9002\u7528\u4e8eVista\u53ca\u4e4b\u540e\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002\u6b64\u5916\uff0c\u6c60\u8ddf\u8e2a\u8868\u4e5f\u6709\u5b83\u7684\u9650\u5236\u6027\uff0c\u4ed6\u53ea\u4f1a\u7edf\u8ba1\u6807\u7b7e\u7684\u4f7f\u7528\u60c5\u51b5\u7ed3\u679c\uff0c\u4e0d\u4f1a\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u6807\u7b7e\u7684\u6240\u6709\u5206\u914d\u6c60\u7684\u5730\u5740 Building a Pool Scanner (\u5efa\u7acb\u4e00\u4e2a\u6c60\u626b\u63cf\u5668) \u00b6 DIY\u8d70\u8d77 \u5728\u4e0a\u9762\u7684\u5c0f\u8282\u4e2d\u53ef\u4ee5\u770b\u5230\uff0cVolatility\u4e3a\u5e38\u89c1\u7684tags\u90fd\u6709\u81ea\u5df1\u63d2\u4ef6\uff0c\u6bd4\u5982psscan\uff0cthrdscan\uff0cfilescan\u7b49\u7b49\u3002\u540c\u65f6Volatility\u4e5f\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u57fa\u7840\u7684\u53eb PoolScanner \u7c7b\uff0c\u6765\u5e2e\u52a9\u6211\u4eec\u81ea\u5df1DIY\u4e00\u4e2a\u626b\u63cf\u5668(\u6bd4\u5982\u53ef\u4ee5\u81ea\u5df1\u6307\u5b9a\u67e5\u627e\u4ec0\u4e48\u6807\u7b7e\uff0c\u6307\u5b9a\u67e5\u627e\u7684\u5206\u914d\u6c60\u5927\u5c0f\uff0c\u5206\u914d\u7684\u5185\u5b58\u7684\u7c7b\u578b\u7b49\u7b49)\uff0c\u4ee5\u53ca\u4e00\u4e2a\u53eb AbstractScanCommand \u7684\u7c7b\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e00\u4e2a\u6c60\u626b\u63cf\u5668\u5e94\u6709\u7684\u547d\u4ee4\u884c\u9009\u9879\u3002 Extending the PoolScanner (\u6269\u5c55PoolScanner\u63d2\u4ef6) \u00b6 \u4e0b\u9762\u7684\u4ee3\u7801\u662fpsscan\u63d2\u4ef6(\u626b\u63cf\u8fdb\u7a0b\u5bf9\u8c61\u7684\u6c60\u626b\u63cf\u5668)\u7684\u4e00\u4e2a\u5fc5\u8981\u914d\u7f6e\u6587\u4ef6\uff0c\u53ef\u81ea\u884c\u67e5\u770b\u6e90\u4ee3\u7801(/usr/lib/python2.7/dist-packages/volatility)\uff1a 1 class PoolScanProcess ( poolscan . PoolScanner ): 2 \"\"\"Pool scanner for process objects\"\"\" 3 4 def __init__ ( self , address_space , ** kwargs ): 5 poolscan . PoolScanner . __init__ ( self , address_space , ** kwargs ) 6 7 self . struct_name = \"_EPROCESS\" 8 self . object_type = \"Process\" 9 self . pooltag = obj . VolMagic ( address_space ) . ProcessPoolTag . v () 10 size = self . address_space . profile . get_obj_size ( \"_EPROCESS\" ) 11 12 self . checks = [ 13 ( 'CheckPoolSize' , dict ( condition = lambda x : x >= size )), 14 ( 'CheckPoolType' , dict ( non_paged = True , free = True )), 15 ( 'CheckPoolIndex' , dict ( value = 0 )), 16 ] \u3000\u3000\u9996\u5148 PoolScanProcess \u7c7b\u7ee7\u627f\u4e86 poolscan.PoolScan \u7c7b\uff0c\u6240\u4ee5\u65b9\u6cd5\u53ef\u4ee5\u4ece\u7236\u7c7b\u7ee7\u627f\uff0c\u5982\u679c\u4f60\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a\u626b\u63cf\u5668\u7684\u8bdd\uff0c\u53ea\u9700\u8981\u505a\u5982\u4e0b\u4fee\u6539\uff1a \u3000\u30001. Structure name\uff1a\u4fee\u6539\u7b2c\u4e03\u884c\u7684\u6570\u636e\u7ed3\u6784\u540d\u79f0\u3002\u5b83\u4f1a\u544a\u8bc9\u6c60\u626b\u63cf\u5668\u8981\u626b\u63cf\u7684\u6570\u636e\u7ed3\u6784\u7c7b\u578b \u3000\u30002. Object type\uff1a\u4fee\u6539\u7b2c\u516b\u884c\u7684\u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b\u3002\u5f53\u626b\u63cf\u5668\u626b\u63cf\u53ef\u80fd\u7684\u6c60\u5bf9\u8c61\u65f6\uff0c\u4ed6\u4f1a\u770b\u8fd9\u4e2a\u5bf9\u8c61\u7684_OBJECT_HEADER.Name\u5c5e\u6027\u7684\u503c\u662f\u4e0d\u662f\u8fd9\u91cc\u8bbe\u5b9a\u7684\u503c\u3002\u5982\u679c\u4e0d\u5305\u542b\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u8bdd\uff0c\u8fd9\u91cc\u7684\u503c\u53ef\u4ee5\u4e3a\u7a7a(\u6bd4\u5982\u7f51\u7edc\u8fde\u63a5\u548csockets) \u3000\u30003. Pool tag\uff1a\u4fee\u6539\u7b2c\u4e5d\u884c\u7684\u6c60\u6807\u7b7e\u3002\u5047\u5982\u4f60\u8981\u627eProc\u6807\u7b7e\u7684\u5bf9\u8c61\uff0c\u8fd9\u91cc\u4e0d\u80fd\u76f4\u63a5\u5199\u4e2aProc\uff0c\u800c\u662f\u4f7f\u7528\u4e86\u4e00\u4e2a\u6839\u636e\u4e0d\u540c\u7684profile\u7684\u5bb9\u5668\u6765\u83b7\u53d6\u7684\uff0c\u56e0\u4e3a\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u7684\u6807\u7b7e\u53ef\u80fd\u4f1a\u53d1\u751f\u53d8\u5316 \u3000\u30004. Allocation size\uff1a\u4fee\u6539\u7b2c\u5341\u884c\u7684\u5206\u914d\u5927\u5c0f\uff0c\u57fa\u4e8e\u6700\u5c0f\u7684\u8981\u67e5\u627e\u7684\u5bf9\u8c61\u7684\u5927\u5c0f(\u6bd4\u5982_EPROCESS\u7684\u5927\u5c0f)\u3002\u8fd9\u91cc\u7684\u503c\u4e5f\u4e0d\u662f\u76f4\u63a5\u5199\u7684\uff0c\u56e0\u4e3a\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u4f1a\u5f71\u54cd\u8fd9\u4e2a\u503c\uff0c\u5c24\u5176\u5bf9\u4e8e32\u4f4d\u64cd\u4f5c\u7cfb\u7edf\u548c64\u4f4d\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5927\u5c0f\u7684\u7ea6\u675f\u572813\u884c\u3002 \u3000\u30005. Memory type\uff1a\u4fee\u6539\u7b2c\u5341\u56db\u884c\u7684\u5185\u5b58\u7c7b\u578b\u3002\u8fd9\u91cc\u53ea\u6709non_paged\u548cfree\u4e24\u4e2a\u503c\u7684\u952e\u503c\u4e3atrue\uff0c\u90a3\u4e48\u626b\u63cf\u5668\u4f1a\u626b\u63cf\u975e\u5206\u9875\u533a\u548c\u91ca\u653e\u4e86\u7684\u5185\u5b58\u4e2d\u7684\u6c60\uff0c\u5e76\u8df3\u8fc7\u5728\u5206\u9875\u5185\u5b58\u4e2d\u7684\u7ed3\u679c\u3002 Extending AbstractScanCommand (\u6269\u5c55\u9009\u9879) \u00b6 \u4e0a\u4e00\u8282\u4e2d\u5df2\u7ecf\u770b\u4e86\u4e00\u4e2a\u626b\u63cf\u5668\u662f\u600e\u4e48\u521d\u59cb\u5316\u7684\uff0c\u4e0b\u4e00\u6b65\u5c31\u4f3c\u4e4e\u521b\u5efa\u4e00\u4e2a\u63d2\u4ef6\uff0c\u7531\u5b83\u6765\u52a0\u8f7d\u626b\u63cf\u5668\u5e76\u5728\u7ec8\u7aef\u4e2d\u5c55\u793a\u7ed3\u679c\uff0c\u4e0b\u9762\u662fpsscan\u7684\u63d2\u4ef6\u4ee3\u7801\uff1a 1 class PSScan ( common . AbstractScanCommand ): 2 \"\"\"Pool scanner for process objects\"\"\" 3 4 scanners = [ poolscan . PoolScanProcess ] 5 6 def render_text ( self , outfd , data ): 7 self . table_header ( outfd , [( 'Offset(P)' , '[addrpad]' ), 8 ( 'Name' , '16' ), 9 ( 'PID' , '>6' ), 10 ( 'PPID' , '>6' ), 11 ( 'PDB' , '[addrpad]' ), 12 ( 'Time created' , '30' ), 13 ( 'Time exited' , '30' ) 14 ]) 15 16 for pool_obj , eprocess in data : 17 self . table_row ( outfd , 18 eprocess . obj_offset , 19 eprocess . ImageFileName , 20 eprocess . UniqueProcessId , 21 eprocess . InheritedFromUniqueProcessId , 22 eprocess . Pcb . DirectoryTableBase , 23 eprocess . CreateTime or '' , 24 eprocess . ExitTime or '' ) \u3000\u3000PSScan\u7c7b\u7ee7\u627f\u4e86 common.AbstractScanCommand \u7236\u7c7b\uff0c\u5728\u7b2c\u56db\u884c\u7684scanners\u53d8\u91cf\uff0c\u5176\u503c\u65f6\u4e0a\u9762\u7684 poolscan.PoolScanProcess \u7c7b\uff0c\u8fd9\u91cc\u7684\u503c\u7531\u4f60\u8981\u5bfb\u627e\u7684\u5bf9\u8c61\u7684\u7c7b\u578b\u51b3\u5b9a\u30027-14\u884c\u751f\u6210\u4e86\u8868\u7684\u5934\u90e8\uff0c\u5c31\u662f\u4e0b\u56fe\u4e2d\u7a7a\u6846\u8fd9\u4e00\u884c\uff1a \u3000\u3000 \u3000\u300016-24\u884c\u5c06\u626b\u63cf\u5668\u5f97\u5230\u7684\u7ed3\u679c\u653e\u5165\u8868\u4e2d\uff0c\u5c31\u662f\u4e0a\u56fe\u4e2d\u7684\u6bcf\u4e00\u884c\u7ed3\u679c\uff0c\u4ed6\u4eec\u90fd\u662f_EPROCESS\u7c7b\u578b\u5bf9\u8c61(\u5728\u672c\u4f8b\u4e2d)\u3002 \u3000\u3000\u901a\u8fc7\u7ee7\u627fAbstractScanCommand\u7c7b\uff0c\u4f60\u7684\u65b0\u7684\u63d2\u4ef6\u5c31\u62e5\u6709\u4e86\u7528\u6237\u4f7f\u7528\u4e0d\u540c\u7684\u547d\u4ee4\u884c\u9009\u9879\u6765\u8c03\u6574\u7684\u80fd\u529b\uff0c\u6bd4\u5982\u4f60\u53ef\u4ee5\u7528--help\u6307\u4ee4\u770b\u4e0b\u5e2e\u52a9\uff1a (\u7701\u7565) -V, --virtual Scan virtual space instead of physical -W, --show-unallocated Skip unallocated objects (e.g. 0xbad0b0b0) -A START, --start=START The starting address to begin scanning -G LENGTH, --length=LENGTH Length (in bytes) to scan from the starting address Module Output Options: dot, greptext, html, json, sqlite, text, xlsx --------------------------------- Module PSScan --------------------------------- Pool scanner for process objects \u3000\u3000\u6bd4\u5982\u6211\u53ea\u626b\u63cf\u4e00\u6bb5\u533a\u95f4\u7684\uff1a \u3000\u3000 PoolScanner Algorithm (\u6c60\u626b\u63cf\u5668\u7b97\u6cd5) \u00b6 \u6240\u6709\u6c60\u626b\u63cf\u5668\u7684\u7236\u7c7b--- PoolScanner \u7c7b\u4f7f\u7528\u4e86\u4e0b\u9762\u8fd9\u4e2a\u56fe\u7684\u903b\u8f91\uff1a \u3000\u3000 \u3000\u3000\u56fe\u4e2d\u7684\u68c0\u67e5\u6b65\u9aa4\u90fd\u662f\u524d\u9762\u5c0f\u8282\u5b66\u4e60\u7684\u5185\u5bb9\u3002\u5373\u6bcf\u5230\u4e0b\u4e00\u4e2a\u5730\u5740\uff0c\u5c31\u68c0\u67e5\u8fd9\u4e2a\u5730\u5740\u4e2d\u7684\u6c60\u5bf9\u8c61\u662f\u5426\u5305\u542b**\u6807\u7b7e**Proc\uff0c\u662f\u7684\u8bdd\u63a5\u7740\u5224\u65ad\u4ed6\u7684**\u5927\u5c0f**\u662f\u5426\u6709\u6548\uff0c\u662f\u7684\u8bdd\u63a5\u7740\u5224\u65ad\u662f\u5426\u662f\u5728\u4e0d\u5206\u9875\u6216\u7a7a\u95f2\u5185\u5b58( \u5185\u5b58\u7c7b\u578b )\u4e2d\uff0c\u662f\u7684\u8bdd\u63a5\u7740\u4f7f\u7528\u7528\u6237**\u81ea\u5b9a\u4e49\u7684\u7ea6\u675f**\u8fdb\u884c\u5224\u65ad\uff0c\u6700\u7ec8\u5f97\u5230\u7ed3\u679c\u3002 \u3000\u3000\u5bf9\u4e8epsscan\u63d2\u4ef6\uff0c\u5982\u679c\u4f60\u8bbe\u7f6e\u4e86-V\u9009\u9879\uff0c\u90a3\u4e48\u626b\u63cf\u5668\u5c31\u4f1a\u4ece\u5185\u6838\u7684\u9875\u8868\u4e2d\u904d\u5386\u626b\u63cf\u6240\u6709\u7684\u9875\uff0c\u5426\u5219\u7684\u8bdd(\u65e0-V\u9009\u9879\u4f7f\u7528\u7269\u7406\u5730\u5740)\uff0c\u626b\u63cf\u5668\u4f1a\u4ece\u504f\u79fb\u5730\u57400\u5f00\u59cb\u8fdb\u884c\u626b\u63cf\uff0c\u76f4\u5230\u5185\u5b58\u6587\u4ef6\u7684\u672b\u5c3e\uff0c\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u7ed3\u679c\u7684\u6b63\u786e\u6027\u3002 Finding Terminated Processes (\u641c\u7d22\u7ec8\u6b62\u8fdb\u7a0b) \u00b6 \u5728\u5b98\u65b9\u7ed9\u7684windows\u955c\u50cf\u4e2d\u7684sample003.bin\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230psscan\u7684\u7ed3\u679c\u4e2d\u6709\u7684\u8fdb\u7a0b\u662f\u6709\u9000\u51fa\u65f6\u95f4\u7684\uff0c\u6bd4\u5982\u4e0b\u9762\u8fd9\u4e2acmd.exe\uff0c\u6301\u7eed\u4e862\u520610\u79d2\uff1a $ volatility -f sample003.bin --profile = WinXPSP2x86 psscan Volatility Foundation Volatility Framework 2 .6 Offset ( P ) Name PID PPID PDB Time created Time exited ------------------ ---------------- ------ ------ ---------- ------------------------------ ------------------------------ 0x000000000181b748 alg.exe 992 660 0x08140260 2008 -11-15 23 :43:25 UTC+0000 0x0000000001843b28 wuauclt.exe 1372 1064 0x08140180 2008 -11-26 07 :39:38 UTC+0000 0x000000000184e3a8 wscntfy.exe 560 1064 0x081402a0 2008 -11-26 07 :44:57 UTC+0000 0x00000000018557e0 alg.exe 512 672 0x08140260 2008 -11-26 07 :38:53 UTC+0000 0x000000000185dda0 cmd.exe 940 1516 0x081401a0 2008 -11-26 07 :43:39 UTC+0000 2008 -11-26 07 :45:49 UTC+0000 0x00000000018a13c0 VMwareService.e 1756 672 0x08140220 2008 -11-26 07 :38:45 UTC+0000 0x00000000018af448 VMwareUser.exe 1904 1516 0x08140100 2008 -11-26 07 :38:31 UTC+0000 0x00000000018af860 VMwareTray.exe 1896 1516 0x08140200 2008 -11-26 07 :38:31 UTC+0000 0x00000000018e75e8 spoolsv.exe 1648 672 0x081401e0 2008 -11-26 07 :38:28 UTC+0000 0x00000000019456e8 csrss.exe 592 360 0x08140040 2008 -11-15 23 :42:56 UTC+0000 ( \u7701\u7565 ) \u3000\u3000\u5982\u679c\u4e00\u4e2a\u8fdb\u7a0b\u6301\u7eed\u65f6\u95f4\u5f88\u77ed\uff0c\u6bd4\u5982ipconfig\u8fd9\u79cd\u53ef\u80fd\u53ea\u9700\u8981\u8fd0\u884c\u4e0d\u52302\u79d2\u5c31\u53ef\u4ee5\u9000\u51fa\u4e86\uff0c\u5728\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u90e8\u6d3b\u52a8\u8fdb\u7a0b\u8868\u4e2d\u4f60\u662f\u627e\u4e0d\u5230\u5b83\u7684\uff0c\u56e0\u4e3a\u4ed6\u4eec\u5728\u4f60\u6293\u5185\u5b58\u524d\u5c31\u7ec8\u6b62\u4e86\u3002\u4f46\u662f\u4f60\u4f7f\u7528\u6c60\u6807\u7b7e\u626b\u63cf\u662f\u53ef\u4ee5\u53d1\u73b0\u4ed6\u4eec\u7684(psscan\u5c31\u662f\u6c60\u6807\u7b7e\u5668)\u3002\u5177\u4f53\u7684\u5e94\u7528\u5c31\u662f\uff0c\u5047\u5982\u8fd9\u662f\u4e00\u53f0\u5185\u7f51\u8bbe\u5907\uff0c\u5982\u679c\u4f60\u53d1\u73b0\u5b58\u5728\u8fc7Ping\u6216\u8005ifconfig\u8fd9\u7c7b\u547d\u4ee4\uff0c\u90a3\u8bf4\u660e\u653b\u51fb\u8005\u53ef\u80fd\u5728\u8fd9\u53f0\u673a\u5668\u4e0a\u5bf9\u7f51\u6bb5\u8fdb\u884c\u4e86\u63cf\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e5f\u662f\u6c60\u626b\u63cf\u6280\u672f\u7ecf\u5e38\u5e94\u7528\u7684\u5730\u65b9\u3002\u540e\u9762\u6211\u4eec\u8fd8\u4f1a\u63a5\u89e6\u5230\u8fd0\u7528\u6c60\u626b\u63cf\u6280\u672f\u6765\u68c0\u6d4b\u5185\u6838\u7ea7\u522b\u7684rootkit\u3002 Limitations of Pool Scanning (\u6c60\u626b\u63cf\u6280\u672f\u7684\u9650\u5236\u6027) \u00b6 \u867d\u8bf4\u4ed6\u662f\u4e2a\u5f88\u725b\u903c\u7684\u65b9\u5f0f\uff0c\u65e0\u9700\u501f\u52a9\u64cd\u4f5c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u626b\u63cf\u51fa\u5bf9\u8c61\uff0c\u4f46\u662f\u4ed6\u6709\u4e0b\u8ff0\u7684\u51e0\u4e2a\u9650\u5236\u6027\u3002 Non-mailcious Limitations (\u8bef\u5224) \u00b6 \u4e0b\u9762\u8fd9\u51e0\u79cd\u60c5\u51b5\u53ef\u80fd\u4f1a\u88ab\u8bef\u5224\u4e3a\u662f\u5bf9\u8bc1\u636e\u7684\u6076\u610f\u7684\u7be1\u6539\uff1a \u3000\u30001. \u6ca1\u6807\u7b7e\u7684\u6c60\u5185\u5b58\uff1a\u867d\u7136\u5fae\u8f6f**\u63a8\u8350**\u4f7f\u7528 ExAllocatePoolWithTag \u6765\u8ba9\u9a71\u52a8\u548c\u5185\u6838\u6a21\u5f0f\u7684\u7ec4\u4ef6\u6765\u5206\u914d\u5185\u5b58\uff0c\u4f46\u662f\u8fd9\u5e76\u975e\u552f\u4e00\u7684\u65b9\u5f0f\uff0c\u4f7f\u7528 ExAllocatePool \u4e5f\u53ef\u4ee5\u5b9e\u73b0\uff0c\u53ea\u4e0d\u8fc7\u4ed6\u88ab\u5f03\u7528\u4e86\uff0c\u4f46\u5728\u5f88\u591awindows\u7248\u672c\u4e0a\u4ecd\u7136\u662f\u53ef\u7528\u7684\u3002\u8fd9\u79cd\u65b9\u5f0f\u5206\u914d\u7684\u5185\u5b58\u4e0d\u4f1a\u5e26tag\u6807\u7b7e\uff0c\u5bf9\u4f60\u7684\u67e5\u627e\u5de5\u4f5c\u4f1a\u9020\u6210\u56f0\u96be\u3002 \u3000\u30002. \u5047\u9633\u6027(False positives)\uff1a\u6c60\u626b\u63cf\u5668\u7684\u903b\u8f91\u6211\u4eec\u5df2\u7ecf\u770b\u8fc7\u4e86\uff0c\u5b9e\u8d28\u662f\u4e00\u4e2a\u57fa\u4e8e\u7ecf\u9a8c\u5224\u65ad\u7684\u542f\u53d1\u5f0f\u7b97\u6cd5\uff0c\u8bef\u62a5\u662f\u96be\u514d\u7684\u3002 \u3000\u30003. \u5927\u7684\u5185\u5b58\u5206\u914d\uff1a\u6c60\u6807\u7b7e\u626b\u63cf\u6280\u672f\u4e0d\u80fd\u626b\u63cf\u51fa\u8d85\u8fc74096\u5b57\u8282\u7684\u5206\u914d(\u540e\u9762\u4f1a\u63d0\u5230\"Big Page Pool\"\u5927\u9875\u6c60)\uff0c\u4e0d\u8fc7\u6240\u6709\u7684\u6267\u884c\u4f53\u5bf9\u8c61\u90fd\u6bd4\u5b83\u5c0f\u3002 Malicious Limitations(Anti-Forensics) (\u53cd\u53d6\u8bc1\u7684\u9650\u5236) \u00b6 \u4e0b\u9762\u8fd9\u4e9b\u53cd\u53d6\u8bc1\u624b\u6bb5\u4e5f\u4f1a\u5bfc\u81f4\u6c60\u626b\u63cf\u7684\u8bef\u5224\uff1a \u3000\u30001. \u4efb\u610f\u6807\u7b7e\uff1a\u9a71\u52a8\u5728\u5206\u914d\u5185\u5b58\u65f6\u9ed8\u8ba4\u4f7f\u7528\u7684\u6807\u7b7e\u65f6\"Ddk \"(\u540e\u9762\u6709\u7a7a\u683c)\u3002\u5f53\u64cd\u4f5c\u7cfb\u7edf\u6216\u7b2c\u4e09\u65b9\u4ee3\u7801\u6ca1\u6709\u6307\u5b9a\u6807\u7b7e\u65f6\uff0c\u5c31\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u6807\u7b7e\u3002\u5982\u679c\u4e00\u4e2a\u6076\u610f\u9a71\u52a8\u4f7f\u7528\u4e86\"Ddk \"\u4f5c\u4e3a\u5b83\u4eec\u7684\u6807\u7b7e\uff0c\u5185\u5b58\u5757\u5c31\u4f1a\u548c\u5176\u4ed6\u5757\u6df7\u5408\u8d77\u6765\uff0c\u96be\u4ee5\u5206\u8fa8\u3002 \u3000\u30002. \u4f2a\u9020\u6807\u7b7e\uff1a \u8fd9\u7bc7\u6587\u7ae0 \u4e2d\u63d0\u51fa\uff0c\u9a71\u52a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u8868\u73b0\u7684\u5f88\u50cf\u4e00\u4e2a\u6b63\u5e38\u5bf9\u8c61\u7684\uff0c\u5e26\u6709\u5047\u6807\u7b7e\u7684\u5bf9\u8c61\u6765\u8bef\u5bfc\u53d6\u8bc1\u4eba\u5458\u3002 \u3000\u30003. \u88ab\u64cd\u7eb5\u7684\u6807\u7b7e\uff1a\u524d\u9762\u4e5f\u63d0\u5230\u4e86\uff0c \u5fae\u8f6f\u521b\u5efa\u6c60\u6807\u8bb0\u662f\u4e3a\u4e86\u8c03\u8bd5\u548c\u5ba1\u8ba1\u7684\u76ee\u7684 \uff0c\u5b83\u4eec\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u7684\u7a33\u5b9a\u6027\u5e76\u4e0d\u91cd\u8981\u3002\u4f46\u662f\u5185\u6838Rootkit\u53ef\u4ee5\u4fee\u6539\u6c60\u6807\u7b7e(\u6216\u8005_POOL_HEADER\u4e2d\u7684\u4efb\u4f55\u503c\uff0c\u6bd4\u5982\u5927\u5c0f\uff0c\u5185\u5b58\u7c7b\u578b\u7b49)\uff0c\u8fd9\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u6ca1\u4ec0\u4e48\u5f71\u54cd\uff0c\u4f46\u662f\u4f1a\u5f71\u54cdVolatility\u7684\u626b\u63cf\u7ed3\u679c\u3002 \u3000\u3000\u4f46\u662f\u5bf9\u4e8e\u8fd9\u4e9b\u9650\u5236\u4f60\u4e5f\u53ef\u4ee5\u5e94\u53d8\uff0c\u6bd4\u5982\u4f7f\u7528\u5176\u4ed6\u624b\u6bb5\u6765\u8fdb\u884c\u641c\u7d22\uff0c\u6c60\u626b\u63cf\u53ea\u662f\u5176\u4e2d\u7684\u4e00\u79cd\uff0c\u6216\u8005\u53ef\u4ee5\u501f\u52a9\u5176\u4ed6\u8bc1\u636e\u6587\u4ef6\uff0c\u6bd4\u5982\u68c0\u67e5\u6d41\u91cf\u5305\u6765\u786e\u5b9a\u662f\u5426\u53d1\u751f\u8fc7\u67d0\u4e00\u4e8b\u4ef6\u3002 Big Page Pool (\u5927\u9875\u6c60) \u00b6 \u524d\u9762\u63d0\u8fc7\uff0cWindows\u5185\u6838\u4f1a\u5c1d\u8bd5\u5c06\u8fd1\u4f3c\u5927\u5c0f\u7684\u5206\u914d\u653e\u5728\u4e00\u8d77\uff0c\u4f46\u662f\u5982\u679c\u8bf7\u6c42\u5185\u5b58\u7684\u5927\u5c0f\u8d85\u8fc7\u4e86\u4e00\u4e2a\u9875\u7684\u5927\u5c0f(4096\u5b57\u8282\uff0c4KB)\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5757\u5c31\u4f1a\u7531\u4e00\u4e2a\u7279\u6b8a\u7684\u6c60\u6765\u5206\u914d --- \u5927\u9875\u6c60(Big Page Pool) \u5728\u4f7f\u7528\u5927\u9875\u6c60\u5206\u914d\u7684\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u662f\u4e0d\u5b58\u5728_POOL_HEADER\u7ed3\u6784\u7684\uff0c\u6240\u4ee5\u5403\u6807\u7b7e\u626b\u63cf\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a\u538b\u6839\u5c31\u6ca1\u6709\u6807\u7b7e\u3002\u4e0b\u56fe\u662f\u5c0f\u4e8e4096\u548c\u5927\u4e8e4096\u7684\u5185\u5b58\u7684\u5206\u7ed3\u6784\uff0c\u53ef\u4ee5\u770b\u5230\u4e8c\u8005\u533a\u522b\u5c31\u662f\u540e\u8005\u6ca1\u6709_POOL_HEADER\u5934\u4fe1\u606f\uff1a \u3000\u3000 \u3000\u3000\u4f46\u662f\u4f60\u53ea\u9700\u8981\u6362\u4e00\u4e2a\u89d2\u5ea6\u5c31\u53ef\u4ee5\u627e\u5230\u8fd9\u4e2a\u5355\u5143\u4e86\uff0c\u90a3\u5c31\u662f\u67e5\u770b\u5927\u9875\u8ddf\u8e2a\u8868(big page track tables)\uff0c\u5b83\u7684\u6761\u76ee\u4f1a\u76f4\u63a5\u6307\u5411\u5927\u9875\u6c60\u4e2d\u7684\u5bf9\u8c61\u3002 Big Page Track Tables (\u5927\u9875\u8ddf\u8e2a\u8868) \u00b6 \u5927\u9875\u8ddf\u8e2a\u8868\u548c\u4e0a\u9762\u63d0\u5230\u7684\u6c60\u8ddf\u8e2a\u8868\u662f\u6709\u533a\u522b\u7684\u3002\u6c60\u8ddf\u8e2a\u8868(PoolTrackTable)\u9002\u7528\u4e8e\u5c0f\u7684\u5185\u5b58\u5757(\u5c0f\u4e8e4096\u5b57\u8282)\uff0c\u5176\u4e2d\u50a8\u5b58\u7740\u7edf\u8ba1\u4fe1\u606f(\u5206\u914d\u6570\u91cf\u3001\u4f7f\u7528\u91cf\u7b49)\uff0c \u4f46\u662f\u5b83\u4e0d\u4f1a\u544a\u8bc9\u4f60\u6bcf\u4e00\u4e2a\u5206\u914d\u7684\u51c6\u786e\u7684\u5730\u5740\uff0c\u8fd9\u4e00\u70b9\u5728PoolTrackTable\u5c0f\u59d0\u63d0\u5230\u4e86\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u9700\u8981\u904d\u5386\u53bb\u626b\u63cf\u7684\u539f\u56e0 \u3002\u4f46\u662f\u5bf9\u4e8e\u5927\u9875\u8ddf\u8e2a\u8868\uff0c \u6070\u6070\u76f8\u53cd\uff0c\u5b83\u4e0d\u50a8\u5b58\u7edf\u8ba1\u4fe1\u606f\uff0c\u4f46\u662f\u5374\u5305\u542b\u4e86\u6bcf\u4e00\u4e2a\u5206\u914d\u7684\u5730\u5740 \uff0c\u5982\u679c\u4f60\u627e\u5230\u4e86\u5927\u9875\u8ddf\u8e2a\u8868\uff0c\u5c31\u76f8\u5f53\u4e8e\u4f60\u6709\u4e86\u4e00\u5f20\u5728\u5185\u6838\u5185\u5b58\u4e2d\u5b9a\u4f4d\u4efb\u4f55\u5927\u7684\u5206\u914d\u5757\u7684\u5730\u56fe\u3002 \u3000\u3000\u4e0d\u8fc7\uff0c\u5185\u6838\u7b26\u53f7 nt!PoolBigPageTable \u6307\u5411\u7684\u6570\u7ec4\u4e2d\uff0c\u867d\u7136\u50a8\u5b58\u4e86\u4e00\u4e9b _POOL_TRACKER_BIG_PAGES \u7684\u6570\u636e\u7ed3\u6784(\u6bcf\u4e00\u4e2a\u5bf9\u5e94\u7740\u4e00\u4e2a\u5927\u7684\u5206\u914d\u5757)\uff0c\u4f46\u662f\u5b83\u4eec\u4e0d\u4f1a\u88ab\u62f7\u8d1d\u6216\u5bfc\u51fa\u5230\u5185\u6838\u8c03\u8bd5\u6570\u636e\u5757(_KDDEBUGGER_DATA64)\u4e2d(\u4e0d\u50cfPoolTrackTable)\u3002\u4f46\u662f\uff0c\u4f60\u53ef\u4ee5\u5728nt!PoolTrackTable\u4e2d\u7684\u4e00\u4e2a\u53ef\u9884\u6d4b\u7684\u4f4d\u7f6e\u4e0a\u627e\u5230\u5b83\uff0c\u56e0\u4e3a\u8fd9\u90e8\u5206\u662f\u4f1a\u62f7\u8d1d\u5230\u5185\u6838\u8c03\u8bd5\u6570\u636e\u5757\u4e2d\u53bb\u7684\u3002\u4e0b\u9762\u7528volshell\u770b\u4e00\u4e0bwin7SP1x64\u4e2d\u5927\u9875\u8ffd\u8e2a\u8868\u7684\u6570\u636e\u7ed3\u6784\uff1a In [ 10 ] : dt ( \"_POOL_TRACKER_BIG_PAGES\" ) '_POOL_TRACKER_BIG_PAGES' ( 24 bytes ) 0x0 : Va [ 'pointer64' , [ 'void' ]] 0x8 : Key [ 'String' , { 'length' : 4 }] 0xc : PoolType [ 'Enumeration' , { 'target' : 'long' , 'choices' : { 0 : 'NonPagedPool' , 1 : 'PagedPool' , 2 : 'NonPagedPoolMustSucceed' , 3 : 'DontUseThisType' , 4 : 'NonPagedPoolCacheAligned' , 5 : 'PagedPoolCacheAligned' , 6 : 'NonPagedPoolCacheAlignedMustS' , 7 : 'MaxPoolType' , 34 : 'NonPagedPoolMustSucceedSession' , 35 : 'DontUseThisTypeSession' , 32 : 'NonPagedPoolSession' , 36 : 'NonPagedPoolCacheAlignedSession' , 33 : 'PagedPoolSession' , 38 : 'NonPagedPoolCacheAlignedMustSSession' , 37 : 'PagedPoolCacheAlignedSession' }}] 0x10 : NumberOfBytes [ 'unsigned long long' ] \u3000\u3000\u7b2c\u4e00\u4e2a\u53c2\u6570 Va \u662f*Virtual Address*\u7684\u7f29\u5199\uff0c\u5b83\u7684\u503c\u662f\u4e00\u4e2a\u6307\u5411\u5206\u914d\u5757\u7684\u57fa\u5740\u7684\u6307\u9488\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570 Key (4\u5b57\u8282\uff0c0xc-0x8)\u5c31\u662fpool tag\uff0c\u800c\u7b2c\u4e09\u4e2a\u53c2\u6570 PoolType \u5c31\u662f\u5185\u5b58\u7684\u7c7b\u578b(\u662f\u5426\u5206\u9875)\uff0c\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u662f\u5206\u914d\u7684\u5927\u5c0f\u3002 \u3000\u3000**\u6ce8\u610f\uff1a**\u867d\u7136\u5730\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662fpoolTag\uff0c\u4f46\u662f\u8fd9\u4e2a\u6807\u7b7e\u7684\u4f4d\u7f6e\u662fVa\u53c2\u6570\u6307\u5411\u7684\u4f4d\u7f6e\uff0c\u548c\u5206\u914d\u7684\u5730\u5740\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u3002\u800c\u5728\u5bf9\u4e8e\u5c0f\u7684\u5206\u914d(_POOL_TRACKER_TABLE)\uff0c\u5b83\u7684\u6807\u7b7e\u662f\u50a8\u5b58\u5728\u5206\u914d\u4e2d\u7684\u3002\u8fd9\u4e00\u70b9\u5f88\u597d\u7406\u89e3\uff0c\u4e0a\u9762\u7684\u5bf9\u6bd4\u56fe\u4e2d\u540e\u8005\u6ca1\u6709_POOL_HEADER\u5934\uff0c\u800ctag\u5c5e\u6027\u662f\u50a8\u5b58\u5728_POOL_HEADER\u4e2d\u7684(\u7ea2\u6846)\uff1a \u3000\u3000 Bigpools Plugin (\u5e94\u7528\u4e8e\u5927\u6c60\u626b\u63cf\u7684\u63d2\u4ef6) \u00b6 \u4e3a\u4e86\u4ece\u5185\u5b58\u4e2d\u5f97\u5230\u751f\u6210\u5927\u7684\u5185\u6838\u6c60\u5206\u914d\u7684\u4fe1\u606f(\u4e0a\u8ff0\u7ed3\u6784\u4f53\u4fe1\u606f)\uff0cVolatility\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53eb bigpools \u7684\u63d2\u4ef6\uff0c\u4e0b\u9762\u662f\u90e8\u5206\u7ed3\u679c\uff1a $ volatility -f FLOAT-WIN7-20200130-110844.raw --profile Win7SP1x64 bigpools Volatility Foundation Volatility Framework 2 .6 Allocation Tag PoolType NumberOfBytes ------------------ -------- -------------------------- ------------- 0xfffff8a003c09000 CM25 PagedPool 0x1000L 0xfffff8a00458d000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a0007ee000 CM25 PagedPool 0x4000L 0xfffff8a004a4f000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a000cb0000 CM25 PagedPool 0x1000L 0xfffff8a004f11000 CM31 PagedPoolCacheAligned 0x1000L 0xfffffa8019cc2000 Cont NonPagedPool 0x1000L 0xfffff8a0053d3000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a005895000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a005d57000 CM31 PagedPoolCacheAligned 0x4000L 0xfffff8a006219000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a005ce1000 CM31 PagedPoolCacheAligned 0x2000L 0xfffff8a001f42000 Obtb PagedPool 0x1000L 0xfffff8a0061a3000 CM31 PagedPoolCacheAligned 0x1000L ( \u7701\u7565 ) \u3000\u3000\u7b2c\u4e00\u5217\u544a\u8bc9\u4f60\u4e86\u5206\u914d\u7684\u5757\u7684\u8d77\u59cb\u5730\u5740\uff0c\u6700\u540e\u4e00\u5217\u662f\u5927\u5c0f(\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d)\uff0c\u77e5\u9053\u4e86\u8fd9\u4e24\u4e2a\u4fe1\u606f\uff0c\u4f60\u53ef\u4ee5\u5728volshell\u4e2d\u5bfc\u51fa\u8fd9\u90e8\u5206\u7684\u6570\u636e\uff0c\u6bd4\u5982\u6211\u67e5\u770b\u7b2c\u4e00\u9879\uff1a In [ 2 ] : db ( 0xfffff8a003c09000, length = 0x1000L ) 0xfffff8a003c09000 68 62 69 6e 00 50 23 00 00 10 00 00 00 00 00 00 hbin.P#......... 0xfffff8a003c09010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0xfffff8a003c09020 d8 ff ff ff 76 6b 0a 00 08 00 00 00 e8 4f 23 00 ....vk.......O#. 0xfffff8a003c09030 03 00 00 00 01 00 00 00 31 31 30 36 33 31 36 38 ........11063168 0xfffff8a003c09040 30 33 00 00 00 00 00 00 d8 ff ff ff 76 6b 0a 00 03 ..........vk.. 0xfffff8a003c09050 08 00 00 00 70 50 23 00 03 00 00 00 01 00 00 00 ....pP#......... 0xfffff8a003c09060 31 31 30 36 33 31 38 39 30 30 00 00 00 00 00 00 1106318900 ...... 0xfffff8a003c09070 f0 ff ff ff 00 00 70 00 00 00 00 00 00 00 00 00 ......p......... 0xfffff8a003c09080 e8 ff ff ff 78 4f 23 00 a0 4f 23 00 20 50 23 00 ....xO#..O#..P#. 0xfffff8a003c09090 48 50 23 00 00 00 00 00 e0 ff ff ff 76 6b 07 00 HP#.........vk.. 0xfffff8a003c090a0 08 00 00 00 68 4a 23 00 01 00 00 00 01 00 2d 00 ....hJ#.......-. 0xfffff8a003c090b0 53 65 72 76 69 63 65 00 d8 ff ff ff 76 6b 0c 00 Service.....vk.. 0xfffff8a003c090c0 14 00 00 00 70 52 23 00 07 00 00 00 01 00 30 00 ....pR#.......0. 0xfffff8a003c090d0 55 70 70 65 72 46 69 6c 74 65 72 73 31 00 30 00 UpperFilters1.0. 0xfffff8a003c090e0 d8 ff ff ff 76 6b 0f 00 4e 00 00 00 08 51 23 00 ....vk..N....Q#. 0xfffff8a003c090f0 01 00 00 00 01 00 41 00 44 72 69 76 65 72 50 61 ......A.DriverPa 0xfffff8a003c09100 63 6b 61 67 65 49 64 00 a8 ff ff ff 61 00 67 00 ckageId.....a.g. 0xfffff8a003c09110 70 00 2e 00 69 00 6e 00 66 00 5f 00 61 00 6d 00 p...i.n.f._.a.m. \u3000\u3000\u6211\u67e5\u770b\u7684\u8fd9\u5757\u7684\u6807\u7b7eCM25\uff0c\u4e4b\u524d\u8bf4\u8fc7CM\u7684\u610f\u601d\u5c31\u662fConfiguration Manager\u7684\u610f\u601d\uff0c\u8bf4\u660e\u8fd9\u5757\u662f\u5185\u6838\u4e2d\u6ce8\u518c\u8868\u7684\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u5176\u4e2d hbin \u548c vk \u5206\u522b\u4ee3\u8868\u6ce8\u518c\u8868HBIN\u5757\u7684\u7b7e\u540d\u548c\u4e00\u4e9b\u503c\u3002 \u3000\u3000\u6709\u4e00\u4e2a\u6bd4\u8f83\u6709\u610f\u601d\u7684\u5730\u65b9\uff0c\u4f5c\u8005\u63d0\u5230\u6839\u636e\u4ed6\u4eec\u7684\u7814\u7a76\uff0c\u5206\u914d\u57fa\u5740\u7684\u6700\u540e\u4e00\u4f4d16\u8fdb\u5236\u6570\u5982\u679c\u4e3a1\u7684\u8bdd\uff0c\u5c31\u8bf4\u660e\u8fd9\u5757\u5185\u5b58\u5df2\u7ecf\u88ab\u6807\u8bb0\u4e3a\u4e86free\u3002\u4e0b\u9762\u6211\u4e5f\u5b9e\u9a8c\u4e00\u4e0b\uff0c\u770b\u662f\u5426\u5982\u6b64\uff1a \u3000\u3000\u6211\u67e5\u770b\u4e0b\u8fd9\u51e0\u4e2a\u5757\uff1a 0xfffff8a001e1b001 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a002148001 CM31 PagedPoolCacheAligned 0x1000L \u3000\u3000 \u3000\u3000\u53ef\u4ee5\u770b\u5230\u6709\u4e00\u4e2a\u662f\u4e0d\u53ef\u8bfb\u7684\u72b6\u6001\uff0c\u800c\u53e6\u4e00\u4e2a\u8fd8\u662f\u53ef\u8bfb\u7684\uff0c\u4f5c\u8005\u7684\u89e3\u91ca\u662f\u4e0d\u53ef\u8bfb\u7684\u90a3\u4e00\u4e2a\u53ef\u80fd\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u63d0\u5230\u7684\uff0c\u6570\u636e\u6620\u5c04\u5230\u4e86\u78c1\u76d8\u4e0a\u7684\u4f8b\u5b50\uff0c\u56e0\u4e3a\u4ed6\u662f\u4f4d\u4e8e\u5206\u9875\u7684\u5185\u5b58\u3002\u800c\u53e6\u4e00\u4e2a\u5219\u5df2\u7ecf\u88ab\u91cd\u65b0\u5206\u914d\u5e76\u4e14\u91cd\u5199\u4e86\uff0c\u56e0\u4e3a\u5b83\u7684\u6570\u636e\u5df2\u7ecf\u6ca1\u6709 hbin \u8fd9\u4e2a\u6570\u5b57\u7b7e\u540d\u4e86\u3002 Exploring Big Page Pools (\u6df1\u5165\u641c\u7d22\u5927\u9875\u6c60) \u00b6 \u521a\u624d\u5f88\u591a\u547d\u4ee4\u7684\u7ed3\u679c\u90fd\u662f\u90e8\u5206\u7ed3\u679c\uff0c\u5728\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u5927\u9875\u6c60\u53ef\u80fd\u4f1a\u6709\u6210\u5343\u7684\u5206\u914d\u7ed3\u679c\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 --tags \u6765\u5e2e\u52a9\u4f60\u8fc7\u6ee4\uff0c\u518d\u7ed3\u5408\u4e00\u4e9b\u7ba1\u9053\u6765\u8fdb\u884c\u7b5b\u9009\uff0c\u6bd4\u5982\u505a\u4e00\u4e2a\u7b80\u5355\u7edf\u8ba1\uff1a $ awk '{print $2}' bigpools.txt | sort | uniq -c | sort -rn 9929 CM31 2753 CM25 1368 Cont 878 CMA? 322 CM53 183 MmRe 141 MmSt 123 Obtb 91 CM16 81 Ntf9 (\u7701\u7565) \u3000\u3000\u5982\u679c\u4f60\u5bf9windows\u5185\u6838\u6570\u636e\u7ed3\u6784\u8db3\u591f\u719f\u6089\u7684\u8bdd\uff0c\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5c31\u53ef\u4ee5\u5e2e\u52a9\u4f60\u8fdb\u884c\u6570\u636e\u5206\u6790\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u5f88\u591a\u7684\u8f6c\u6362\u8868\u3001\u5185\u5b58\u7ba1\u7406\u9875\u8868\u3001\u8bbf\u95ee\u8bb0\u5f55\u3001ASLR(Address Space Layout Randomization)\u7ec6\u8282\u7b49\u7b49\u4fe1\u606f\u3002 Pool-Scanning Alternatives (\u6c60\u626b\u63cf\u5907\u9009\u65b9\u6848) \u00b6 \u5230\u8fd9\u91cc\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u4e86\u5185\u5b58\u533a\u6b63\u4e2d\u7684\u6c60\u6807\u7b7e\u626b\u63cf(pool tag scanning)\u4f18\u70b9\u548c\u7f3a\u70b9\u4ee5\u53ca\u539f\u7406\u65b9\u6cd5\u4e86\uff0c\u4e0b\u9762\u8ba8\u8bba\u51e0\u4e2a\u5907\u7528\u65b9\u6848\u3002 Dispatcher Header Scans (\u8c03\u5ea6\u5668\u5934\u90e8\u626b\u63cf) \u00b6 \u8bb8\u591a\u6267\u884c\u4f53\u5bf9\u8c61(\u5982\u8fdb\u7a0b\u3001\u7ebf\u7a0b\u3001\u4e92\u65a5\u9501)\u90fd\u662f\u53ef\u540c\u6b65\u7684\u3002\u8fd9\u610f\u5473\u7740\u5176\u4ed6\u7ebf\u7a0b\u53ef\u4ee5\u540c\u6b65\u3001\u6216\u7b49\u5f85\u8fd9\u4e9b\u5bf9\u8c61\u7684\u6267\u884c\u3001\u7ed3\u675f\u3001\u6216\u8005\u6267\u884c\u5176\u4ed6\u7c7b\u578b\u52a8\u4f5c\uff0c\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4f1a\u5c06\u4e00\u4e2a\u5bf9\u8c61\u7684\u5f53\u524d\u72b6\u6001\u50a8\u5b58\u5728\u4e00\u4e2a\u53eb _DISPATCHER_HEADER \u7684\u5b50\u7ed3\u6784(substructure)\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u5f00\u5934\u90fd\u4f1a\u6709\u8fd9\u4e2a\u5b50\u7ed3\u6784\u3002 \u3000\u3000\u6b64\u5916\u8fd9\u4e2a\u7ed3\u6784\u4f53\u5185\u8fd8\u5305\u542b\u7740\u4e00\u4e9b\u4e0ewindows\u7248\u672c\u6709\u5173\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u5e2e\u52a9\u4f60\u786e\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u7684profile\u503c\u3002\u66f4\u591a\u5173\u4e8e\u8c03\u5ea6\u5668\u5934\u90e8\u4fe1\u606f\u5728\u5185\u5b58\u53d6\u8bc1\u53d6\u8bc1\u4e2d\u7684\u7528\u9014\uff0c\u53c2\u8003 Searching for Processes and Threads in Microsoft Windows Memory Dumps \u3000\u3000\u4e0b\u9762\u662fvolshell\u4e2d\u67e5\u770bWin7SP1x64\u4e2d _DISPATCHER_HEADER \u7684\u7ed3\u679c\uff1a In [ 1 ] : dt ( \"_DISPATCHER_HEADER\" ) '_DISPATCHER_HEADER' ( 24 bytes ) 0x0 : Lock [ 'long' ] 0x0 : Type [ 'unsigned char' ] 0x1 : Abandoned [ 'unsigned char' ] 0x1 : Absolute [ 'BitField' , { 'end_bit' : 1 , 'start_bit' : 0 , 'native_type' : 'unsigned char' }] 0x1 : Coalescable [ 'BitField' , { 'end_bit' : 2 , 'start_bit' : 1 , 'native_type' : 'unsigned char' }] 0x1 : EncodedTolerableDelay [ 'BitField' , { 'end_bit' : 8 , 'start_bit' : 3 , 'native_type' : 'unsigned char' }] 0x1 : KeepShifting [ 'BitField' , { 'end_bit' : 3 , 'start_bit' : 2 , 'native_type' : 'unsigned char' }] 0x1 : Signalling [ 'unsigned char' ] 0x1 : TimerControlFlags [ 'unsigned char' ] 0x2 : CounterProfiling [ 'BitField' , { 'end_bit' : 3 , 'start_bit' : 2 , 'native_type' : 'unsigned char' }] 0x2 : CpuThrottled [ 'BitField' , { 'end_bit' : 1 , 'start_bit' : 0 , 'native_type' : 'unsigned char' }] 0x2 : CycleProfiling [ 'BitField' , { 'end_bit' : 2 , 'start_bit' : 1 , 'native_type' : 'unsigned char' }] 0x2 : Hand [ 'unsigned char' ] 0x2 : Reserved [ 'BitField' , { 'end_bit' : 8 , 'start_bit' : 3 , 'native_type' : 'unsigned char' }] 0x2 : Size [ 'unsigned char' ] 0x2 : ThreadControlFlags [ 'unsigned char' ] 0x3 : ActiveDR7 [ 'BitField' , { 'end_bit' : 1 , 'start_bit' : 0 , 'native_type' : 'unsigned char' }] 0x3 : DebugActive [ 'unsigned char' ] 0x3 : DpcActive [ 'unsigned char' ] 0x3 : Expired [ 'BitField' , { 'end_bit' : 8 , 'start_bit' : 7 , 'native_type' : 'unsigned char' }] 0x3 : Index [ 'BitField' , { 'end_bit' : 6 , 'start_bit' : 0 , 'native_type' : 'unsigned char' }] 0x3 : Inserted [ 'BitField' , { 'end_bit' : 7 , 'start_bit' : 6 , 'native_type' : 'unsigned char' }] 0x3 : Instrumented [ 'BitField' , { 'end_bit' : 2 , 'start_bit' : 1 , 'native_type' : 'unsigned char' }] 0x3 : Reserved2 [ 'BitField' , { 'end_bit' : 6 , 'start_bit' : 2 , 'native_type' : 'unsigned char' }] 0x3 : TimerMiscFlags [ 'unsigned char' ] 0x3 : UmsPrimary [ 'BitField' , { 'end_bit' : 8 , 'start_bit' : 7 , 'native_type' : 'unsigned char' }] 0x3 : UmsScheduled [ 'BitField' , { 'end_bit' : 7 , 'start_bit' : 6 , 'native_type' : 'unsigned char' }] 0x4 : SignalState [ 'long' ] 0x8 : WaitListHead [ '_LIST_ENTRY' ] \u4f5c\u8005\u6307\u51fa\uff0c\u5bf9\u4e8eAbsolute\u548cInserted\u8fd9\u4e24\u4e2a\u53d8\u91cf\uff0c\u5728win2K,2k3,XP\u4e2d\u90fd\u662f0\uff0c\u800cType\u548cSize\u53d8\u91cf\u90fd\u662f\u786c\u7f16\u7801\u7684\u5f62\u5f0f\u5199\u6b7b\u4e86\u5bf9\u8c61\u7684\u7c7b\u578b\u548c\u5927\u5c0f\uff0c\u6bd4\u5982WinXPx32\uff0cType\u53d8\u91cf\u503c\u4e3a3\u4ee3\u8868\u8fdb\u7a0b\uff0c\u5bf9\u5e94\u5927\u5c0f\u4e3a0x1b\uff0c\u56db\u5b57\u8282\u7b7e\u540d\u4e3a\\x03\\x00\\x1b\\x00\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u7b7e\u540d\uff0c\u4ee5\u7c7b\u4f3c\u6c60tag\u626b\u63cf\u7684\u65b9\u5f0f\u8fdb\u884c\u626b\u63cf\uff0c\u8fd9\u4e5f\u662f\u65e9\u671f\u5185\u5b58\u53d6\u8bc1\u7684\u4e00\u6b3e\u540d\u4e3aPTFinder\u7684\u5de5\u5177\u5de5\u4f5c\u539f\u7406\u3002 \u4f46\u662f\u8c03\u5ea6\u5668\u5934\u626b\u63cf\u7684\u65b9\u6cd5\u53ea\u80fd\u626b\u63cf\u5230\u540c\u6b65\u4e86\u7684\u5bf9\u8c61\uff0c\u5047\u5982\u4e00\u4e2a\u5bf9\u8c61\u6ca1\u6709\u8fdb\u884c\u540c\u6b65\uff0c\u90a3\u4e48\u5b83\u5c31\u6ca1\u6709 _DISPATCHER_HEADER \u8fd9\u4e2a\u5934\u90e8\u4fe1\u606f\uff0c\u8fd9\u6837\u4f60\u5c31\u4e0d\u80fd\u627e\u5230 _FILE_OBJECT \u7c7b\u578b\u7684\u5b9e\u4f8b\u4e86\u3002 \u3000\u3000\u8fd9\u4e2a\u65b9\u6cd5\u53ea\u4f5c\u4e3a\u4ecb\u7ecd\uff0c\u6ca1\u6709\u592a\u5927\u5b9e\u8df5\u4ef7\u503c\uff0cVolatility\u4e2d\u7684pspdispscan\u63d2\u4ef6\u5c31\u662f\u5bf9\u5e94\u8fd9\u4e2a\u65b9\u6cd5(2.6\u7248\u672c\u4e2d\u5df2\u7ecf\u53bb\u6389\u4e86\uff0c\u4f5c\u4e3a\u4e00\u4e2aPOC)\uff0c\u4f46\u53ea\u9650\u4e8e32\u4f4dWindowsXP\u3002 Robust Signature Scans (\u589e\u5f3a\u578b\u7b7e\u540d\u626b\u63cf) \u00b6 \u6c60\u5934\u90e8\u4fe1\u606f\u548c\u8c03\u5ea6\u5668\u5934\u90e8\u4fe1\u606f\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u6765\u8bf4\u90fd\u662f\u4e0d\u91cd\u8981\u7684\uff0c\u6240\u4ee5\u6076\u610f\u7684\u4fee\u6539\u5b83\u4eec\u53ef\u4ee5\u9003\u8fc7\u57fa\u4e8e\u6807\u7b7e\u7684\u626b\u63cf\u65b9\u6cd5\uff0c\u540c\u65f6\u4e0d\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u9020\u6210\u5f71\u54cd\u3002\u6240\u4ee5\u6709\u53e6\u4e00\u4e2a\u5bf9\u6297\u8fd9\u79cd\u6076\u610f\u4fee\u6539\u7684\u641c\u7d22\u5bf9\u8c61\u7684\u624b\u6bb5\uff0c\u8be6\u7ec6\u63cf\u8ff0\u5728\u8fd9\u7bc7\u6587\u7ae0\uff1a Robust Signatures for Kernel Data Structures \u3002\u5927\u6982\u5c31\u662f\u7814\u7a76\u8981\u67e5\u627e\u7684\u7ed3\u6784\u4f53\u4e2d\uff0c\u90a3\u4e9b\u4fe1\u606f\u7684\u4fee\u6539\u4f1a\u5bfc\u81f4\u64cd\u4f5c\u7cfb\u7edf\u7684\u5d29\u6e83\uff0c\u518d\u4f9d\u636e\u8fd9\u4e9b\u4fe1\u606f\u6765\u8fdb\u884c\u641c\u7d22\uff0c\u8fd9\u6837\u654c\u624b\u5c31\u4e0d\u80fd\u968f\u610f\u4fee\u6539\u4e86\u3002\u8fd9\u5bf9\u4e8e\u641c\u7d22\u88ab\u5185\u6838\u7ea7\u522b\u7684rootkit\u9690\u85cf\u7684\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u6709\u53c2\u8003\u4ef7\u503c\u3002 \u3000\u3000\u5728Volatility 1.3\u7248\u672c\u4e2d\u53ef\u4ee5\u4f7f\u7528 psscan3 \u63d2\u4ef6\u8fdb\u884c\u589e\u5f3a\u578b\u7684\u7b7e\u540d\u626b\u63cf\uff0c\uff0c\u4f46\u662f\u6700\u65b0\u7248\u672c\u4e2d\u4e0d\u5305\u542b\u8be5\u63d2\u4ef6\u3002\u53ef\u4ee5\u81ea\u884c\u5728\u8fd9\u91cc\u4e0b\u8f7d psscan3 Summary \u603b\u7ed3 \u00b6 \u672c\u7bc7\u4e3b\u8981\u8ba8\u8bba\u7684\u662fwindows\u5bf9\u8c61\u7ba1\u7406\u5668(Windows Object Manager)\u5728\u521b\u5efa\u548c\u5220\u9664\u4e00\u4e9b\u4e3b\u8981\u7c7b\u578b\u5bf9\u8c61(\u8fdb\u7a0b\u3001\u6587\u4ef6\u3001\u6ce8\u518c\u8868\u952e\u503c\u7b49)\u65f6\u7684\u4f5c\u7528\uff0c\u8fd9\u4e9b\u90fd\u662f\u53d6\u8bc1\u65f6\u8981\u4f9d\u8d56\u7684\u5bf9\u8c61\u3002 \u3000\u3000\u672c\u7bc7\u4e3b\u8981\u5b66\u4e60\u4e86\u5177\u4f53Volatility\u5728\u5b9e\u73b0\u641c\u7d22\u8fd9\u4e9b\u5bf9\u8c61\u65f6\u4f7f\u7528\u7684\u65b9\u5f0f\u4ee5\u53ca\u539f\u7406\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u770b\u5230\uff0c\u867d\u7136\u5bf9\u5185\u5b58\u6587\u4ef6\u53ca\u9006\u884c\u5168\u5c40\u7684\u7206\u7834\u641c\u7d22\u5f88\u6709\u6548\uff0c\u4f46\u662f\u4e5f\u5bb9\u6613\u8bef\u5224\uff0c\u56e0\u4e3a\u4f7f\u7528\u7684\u65b9\u6cd5(\u6c60\u6807\u7b7e\u626b\u63cf)\u4f9d\u8d56\u7684\u6570\u636e\u654c\u624b\u4e5f\u53ef\u4ee5\u4f2a\u9020\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u4e86\u89e3\u626b\u63cf\u6280\u672f\u5230\u5e95\u600e\u4e48\u5de5\u4f5c\u7684\u3001\u653b\u51fb\u8005\u662f\u5982\u4f55\u907f\u5f00\u8fd9\u4e9b\u626b\u63cf\u624b\u6bb5\u7684\uff0c\u8fd9\u4e5f\u662f\u672c\u7bc7\u4e3b\u8981\u5b66\u4e60\u7684\u5185\u5bb9\u3002\u6b64\u5916\uff0c\u5728\u5f97\u51fa\u7ed3\u8bba\u4e4b\u524d\uff0c\u4f60\u5e94\u8be5\u4e60\u60ef\u4e8e\u7ed3\u5408\u591a\u79cd\u8bc1\u636e\u6765\u6e90\u6765\u7efc\u5408\u5224\u65ad\u3002 \u53c2\u8003\u5b66\u4e60\u94fe\u63a5 \u00b6 Windbg\u4e0b\u8f7d\u5730\u5740 \u5229\u7528Volatility\u8fdb\u884cWindows\u5185\u5b58\u53d6\u8bc1\u5206\u6790(\u4e00)\uff1a\u521d\u4f53\u9a8c \u5229\u7528Volatility\u8fdb\u884cWindows\u5185\u5b58\u53d6\u8bc1\u5206\u6790(\u4e8c)\uff1a\u5185\u6838\u5bf9\u8c61\u3001\u5185\u6838\u6c60\u5b66\u4e60\u5c0f\u8bb0 win10\u4e2d\u201cwindbg+vmware+win7\u53cc\u673a\u8c03\u8bd5\u201d\u8bbe\u7f6e ExAllocatePool\u548cExAllocatePoolWithTag\u7684\u533a\u522b","title":"\u5185\u5b58\u53d6\u8bc1\u539f\u7406\u5b66\u4e60\u53caVolatility - \u7bc7\u4e8c"},{"location":"ram2/#_1","text":"\u4e0a\u4e00\u7bc7\u4e2d\u5927\u6982\u4ecb\u7ecd\u4e86\u4e00\u4e0bVolatility\u7684\u7528\u6cd5\uff0c\u56e0\u4e3a\u76ee\u524d\u8f83\u4e3a\u6210\u719f\u7684\u5185\u5b58\u53d6\u8bc1\u4e66\u5c31\u53ea\u6709\u90a3\u672c*The Art Of Memory Forensics*\uff0c\u6240\u4ee5\u8fd9\u4e00\u7bc7\u5f00\u59cb\u4f1a\u8ddf\u7740\u8bfe\u672c\uff0c\u4ee5\u5b66\u4e60\u4e3a\u7b2c\u4e00\u76ee\u7684\uff0c\u7cfb\u7edf\u6027\u7684\u5b66\u4e60\u5185\u5b58\u53d6\u8bc1\u3002 \u3000\u3000\u5b98\u65b9\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u8f85\u52a9\u5b66\u4e60\u7684\u8d44\u6599\uff0c\u4e0b\u9762\u662f\u6211\u6536\u96c6\u5230\u7684\u8d44\u6e90\uff0c\u81ea\u884c\u4e0b\u8f7d\u5b66\u4e60\u3002 \u3000\u3000 \u6240\u9700\u4e66\u672c \u3000\u3000 \u5b98\u65b9\u5185\u5b58\u6837\u672c\u4ee5\u53ca\u8d44\u6599 \uff0c\u63d0\u53d6\u7801\uff1ay2mu \u3000\u3000 Windbg\u4e0b\u8f7d\u5730\u5740 \u3000\u3000\u6b64\u5916\u6700\u597d\u81ea\u5df1\u88c5\u4e00\u4e2awindows\u865a\u62df\u673a\uff0c\u6bd4\u5982win7\u7b49\uff0c\u5e76\u914d\u7f6e\u6240\u9700\u5de5\u5177\u3002","title":"\u51c6\u5907\u5de5\u4f5c"},{"location":"ram2/#_2","text":"\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u5f0f\u4ece\u81ea\u5df1\u7684\u5b9e\u4f53\u673a\u6216\u865a\u62df\u673a\u4e2d\u6293\u53d6\u5185\u5b58\u6765\u81ea\u5df1\u5206\u6790\uff0c\u6216\u8005\u7528\u4e0a\u9762\u6211\u63d0\u4f9b\u7684\u94fe\u63a5\u6765\u4e0b\u8f7d\u5b98\u65b9\u7684\u955c\u50cf\u6837\u672c\u3002\u5de5\u5177\u5f88\u591a\uff0c\u8fd9\u91cc\u63d0\u4f9b\u5e38\u7528\u7684\u4e09\u79cd\u65b9\u6cd5\uff1a","title":"\u600e\u4e48\u6293\u53d6\u5185\u5b58"},{"location":"ram2/#vmware","text":"\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662fVmware\u6765\u505a\u8bd5\u9a8c\u7684\u8bdd\uff0c\u53ea\u9700\u8981\u5c06\u865a\u62df\u673a\u6682\u505c\uff0c\u6216\u8005\u521b\u5efa\u5feb\u7167\uff0c\u5c31\u53ef\u4ee5\u5728\u5bf9\u5e94\u76ee\u5f55\u4e0b\u627e\u5230vmem\u6587\u4ef6\u4e86(\u865a\u62df\u5185\u5b58\u6587\u4ef6)\u3002\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"\u4f7f\u7528VMWare"},{"location":"ram2/#dumpit","text":"\u8fd9\u4e2a\u66f4\u65e0\u8111\uff0c\u514d\u5b89\u88c5\uff0c\u76f4\u63a5\u653e\u5230\u5bf9\u65b9\u673a\u5668\uff0c\u6572\u4e2ay\u5b8c\u4e8b\u4e86\u3002\u5f97\u5230\u7684\u7ed3\u679c\u662f\u4e00\u4e2araw\u6587\u4ef6\uff0c\u5177\u4f53\u7528\u6cd5\u548c\u4e0b\u8f7d\u5730\u5740 \u770b\u8fd9\u91cc \uff0c\u5982\u56fe\u5c31\u662f\u6293\u53d6\u5b8c\u6210\uff1a","title":"\u4f7f\u7528DumpIt"},{"location":"ram2/#accessdata-ftk-imager","text":"\u6253\u5f00FTK\uff0cFile\u9009\u9879\u4e2d\u6709\u6293\u53d6\u5185\u5b58\u7684\u529f\u80fd\uff1a","title":"\u4f7f\u7528AccessData FTK Imager"},{"location":"ram2/#windows-object-and-pool-allocation-windows","text":"","title":"Windows Object And Pool Allocation (Windows\u5bf9\u8c61\u548c\u6c60\u5206\u914d)"},{"location":"ram2/#windows-executive-objects-windows","text":"\u5f88\u591a\u5185\u5b58\u5206\u6790\u6848\u4f8b\u4e2d\u90fd\u4f1a\u7275\u626f\u5230\u5206\u6790\u6267\u884c\u4f53\u5bf9\u8c61\uff0c\u5728windows\u4e2d\u4f1a\u6709\u5927\u91cf\u7684C\u8bed\u8a00\u7684\u6570\u636e\u7ed3\u6784\uff0c executive objects \u662f**\u5176\u4e2d\u4e00\u7c7b**\u7684\u540d\u79f0\uff0c\u6765\u6e90\u662f\u56e0\u4e3a\u4ed6\u4eec\u90fd\u88ab Windows Object Manager \u6765\u7ba1\u7406(\u521b\u5efa\u3001\u7ef4\u62a4\u3001\u5220\u9664\u7b49)\uff0c Windows Object Manager \u662fWindows NT\u5185\u6838\u7684\u4e00\u4e2a\u5185\u6838\u7ec4\u4ef6\u3002 \u6ce8\u610f\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6570\u636e\u7ed3\u6784\u90fd\u662f\u6267\u884c\u4f53\u5bf9\u8c61(executive objects) \uff0c\u6267\u884c\u4f53\u5bf9\u8c61\u662f\u6709\u4ed6\u81ea\u5df1\u7279\u6b8a\u7684\u6587\u4ef6\u5934\u7684\uff0c\u5176\u4ed6\u6570\u636e\u7ed3\u6784\u662f\u6ca1\u6709\u7684\uff1b\u5e76\u4e14\u6267\u884c\u4f53\u5bf9\u8c61\u662f\u7531\u5bf9\u8c61\u7ba1\u7406\u5668(Object Manager)\u751f\u6210\u7684\uff0c\u800c\u5176\u4ed6\u7684\u662f\u7531\u5176\u4ed6\u5b50\u7cfb\u7edf\u751f\u6210\u7684\uff0c\u5982\u7531TCP/IP\u6808(tcpip.sys)\u751f\u6210\u7684\u3002 \u3000\u3000\u4e0b\u9762\u662f\u4e00\u4e9b\u4e0e\u53d6\u8bc1\u6709\u5173\u7684\u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b(executive object types)\uff0c\u5728Volatility\u4e2d\u6709\u76f8\u5e94\u7684\u5206\u6790\u8fd9\u4e9b\u5bf9\u8c61\u7684\u63d2\u4ef6\uff1a \u3000\u3000 \u3000\u3000 \u3000\u3000\u4e0d\u540c\u7248\u672c\u7684Windows\u7684\u5bf9\u8c61\u7c7b\u578b\u4f1a\u53d1\u751f\u53d8\u5316\u6765\u652f\u6301\u65b0\u7684\u7279\u6027\uff0c\u53ef\u4ee5\u4f7f\u7528 Sysinternals Suite \u5de5\u5177\u5305\u4e2d\u7684 winObj \u6765\u67e5\u770b(\u5b89\u5229\u4e00\u4e0bMark Russinovich\u5927\u795e\u5199\u7684windows\u5de5\u5177\u5305\u3002\u5982\u4e0b\u56fe\uff1a","title":"Windows Executive Objects (Windows \u6267\u884c\u4f53\u5bf9\u8c61)"},{"location":"ram2/#object-header-windos","text":"\u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b\u7684\u4e00\u4e2a\u7279\u70b9\u5c31\u662f\u6709**\u4e00\u4e2a** object header (_OBJECT_HEADER\u7c7b\u578b)\uff0c\u4ee5\u53ca\u96f6\u4e2a\u6216\u591a\u4e2a\u53ef\u9009\u7684\u5176\u4ed6\u5934\u90e8\u4fe1\u606f(optional headers)\u3002\u5bf9\u8c61\u7684\u5934\u90e8(Object header)\u4f1a\u5148\u4e8e\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u6570\u636e\u7ed3\u6784\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u540c\u6837\u5730\uff0c\u53ef\u9009\u7684\u5934\u90e8\u4fe1\u606f(optional headers)\u4e5f\u4f1a\u4e00\u79cd\u65b9\u5f0f(in a fixed order)\uff0c\u5148\u4e8e\u4e00\u822c\u5934\u90e8\u4fe1\u606f(object header)\u52a0\u8f7d\u3002\u8fd9\u6837\u7684\u7279\u70b9\u7684\u7ed3\u679c\u662f\u4ec0\u4e48\u5462\uff1f\u5c31\u662f\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u683c\u5f0f\u662f\u53ef\u9884\u77e5\u7684(predictable)\uff0c\u5982\u4e0b\u56fe\uff1a \u3000\u3000 \u3000\u3000\u6240\u4ee5\u7efc\u4e0a\u8fd9\u79cd\u52a0\u8f7d\u7684\u7279\u70b9\uff0c\u4e3e\u4e00\u4e2a\u6817\u5b50\uff0c\u6bd4\u5982\u4e00\u4e2aFile\u7c7b\u578b\uff0c\u5b83\u62e5\u6709\u4e00\u4e2a _FILE_OIBJECT \u7c7b\u578b\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\u83b7\u53d6\u5230\u5b83\u7684 _OBJECT_HEADER \u6570\u636e\u7ed3\u6784\uff0c\u6216\u8005\u53cd\u4e4b\u4ea6\u7136\uff0c\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u7ed3\u6784\u4f53\u5728\u5934\u90e8\u4e2d\u662f\u76f8\u90bb\u7684(\u4e0a\u56fe)\uff0c\u800c\u5bf9\u4e8e _OBJECT_HEADER \u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u7684\u5927\u5c0f\u4e0d\u4f1a\u5e94\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e0d\u540c\u800c\u53d8\u5316\u3002 \u3000\u3000\u90a3\u4e48\u5982\u4f55\u786e\u5b9a\u54ea\u4e00\u4e2a\u53ef\u9009\u7684\u5934\u90e8\u4fe1\u606f\u662f\u5b58\u5728\u7684\u5462\uff1f\u53ef\u4ee5\u4f9d\u9760\u5bf9\u8c61\u5934\u90e8\u7684 InfoMask \u4fe1\u606f\u3002\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2aWin7\u4e0a\u7684\u5bf9\u8c61\u5934\u90e8\u7684\u5b9e\u4f8b(\u81ea\u5df1\u53ef\u4ee5\u5728volshell\u4e2d\u770b\uff0c\u547d\u4ee4\u5982\u4e0b)\u3002 In [3]: dt(\"_OBJECT_HEADER\") '_OBJECT_HEADER' (56 bytes) 0x0 : PointerCount ['long long'] //\u6307\u9488\u6570\u91cf\uff0c\u5305\u542b\u5185\u6838\u6a21\u5f0f\u7684 0x8 : HandleCount ['long long'] //\u5f53\u524d\u5bf9\u8c61\u6301\u6709\u7684\u53e5\u67c4\u6570 0x8 : NextToFree ['pointer64', ['void']] 0x10 : Lock ['_EX_PUSH_LOCK'] 0x18 : TypeIndex ['unsigned char'] //\u5bf9\u8c61\u7684\u7c7b\u578b 0x19 : TraceFlags ['unsigned char'] 0x1a : InfoMask ['unsigned char'] 0x1b : Flags ['unsigned char'] 0x20 : ObjectCreateInfo ['pointer64', ['_OBJECT_CREATE_INFORMATION']] 0x20 : QuotaBlockCharged ['pointer64', ['void']] 0x28 : SecurityDescriptor ['pointer64', ['void']] //\u50a8\u5b58\u5b89\u5168\u9650\u5236\u4fe1\u606f(\u5982\u54ea\u4e9b\u7528\u6237\u53ef\u8bfb) 0x30 : Body ['_QUAD'] //\u4e00\u4e2a\u5360\u4f4d\u7b26\uff0c\u4ee3\u8868\u5bf9\u8c61\u6570\u636e\u7ed3\u6784\u4f53\u7684\u5f00\u59cb\uff0c\u5bf9\u8c61\u5934\u90e8\u7684\u7ed3\u675f","title":"Object Header (windos \u5bf9\u8c61\u5934\u90e8)"},{"location":"ram2/#optional-headers-windos","text":"\u53ef\u9009\u5934\u90e8\u4fe1\u606f\u4e2d\u5305\u542b\u4e86\u5f88\u591a\u7528\u4e8e\u63cf\u8ff0\u5bf9\u8c61\u7684\u5143\u4fe1\u606f(metadata)\uff0c\u56e0\u4e3a\u662f\u53ef\u9009\uff0c\u6240\u4ee5\u4e0d\u662f\u6240\u6709\u7684\u5bf9\u8c61\u90fd\u62e5\u6709\u5b83\uff0c\u5e76\u4e14**\u4e0d\u540c\u5bf9\u8c61\u7c7b\u578b\u7684\u5b9e\u4f8b\u4e5f\u53ef\u80fd\u5305\u542b\u4e0d\u540c\u7684\u53ef\u9009\u5934\u90e8\u4fe1\u606f**\uff0c\u4e3e\u4e00\u4e2a\u6817\u5b50\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e0d\u4f1a\u8ddf\u8e2a\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u7684\u8d1f\u8f7d\u60c5\u51b5(quota stats)\uff0c\u6240\u4ee5\u7a7a\u95f2(Idle)\u548c\u7cfb\u7edf(system)\u7684\u8fdb\u7a0b\u867d\u7136\u90fd\u5c5e\u4e8e _EPRROCESS \u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4f46\u662f\u4ed6\u4eec\u4e24\u4e2a\u662f\u6ca1\u6709 _OBJECT_HEADER_NAME_INFO \u8fd9\u4e2a\u53ef\u9009\u5934\u90e8\u7684\u3002\u4f46\u662f\u533f\u540d\u4e92\u65a5\u9501\u662f\u6709\u8fd9\u4e2a\u5934\u90e8\u7684\u3002 \u3000\u3000\u867d\u7136\u53ef\u9009\u5934\u90e8\u4fe1\u606f\u5f88\u591a\uff0c\u4f46\u662f\u5e38\u5206\u6790\u7684\u8fd8\u662f\u5b83\u7684Name\u5c5e\u6027(\u89c1\u4e0b\u56feName Info)\u3002\u4e0b\u9762\u7684\u8868\u662f64\u4f4dwin7\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u53ef\u9009\u5934\u90e8\u4fe1\u606f\uff0c\u5982\u679cBit Mask\u5217\u7684\u67d0\u4e00\u4e2a\u503c\u5c31\u662f\u5bf9\u8c61\u5934\u90e8\u4e2d\u7684 InfoMask \u7684\u503c\u7684\u8bdd\uff0c\u5c31\u8bf4\u660e\u8fd9\u4e2a\u5934\u662f\u6709\u7684\u3002","title":"Optional Headers (windos \u53ef\u9009\u5bf9\u8c61\u5934\u90e8)"},{"location":"ram2/#object-type-objects-windows","text":"\u5728\u4e0a\u9762\u7684\u5bf9\u8c61\u5934\u90e8\u5206\u6790\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\u6709\u4e00\u4e2a\u53c2\u6570 TypeIndex \uff0c\u4ed6\u4ee3\u8868\u4e86\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u8fd9\u4e2a\u53c2\u6570\u662f\u5728nt!ObTypeIndexTable(\u4e00\u4e2a_OBJECT_TYPE\u7684\u6570\u7ec4\u96c6\u5408)\u4e2d\u67e5\u627e\u7684\u7d22\u5f15(\u6240\u4ee5\u53ebTypeIndex)\uff0c\u8fd9\u4e2a\u53c2\u6570\u5bf9\u5185\u5b58\u53d6\u8bc1\u6709\u5f88\u5927\u7528\u5904\uff0c\u7531\u8fd9\u4e2a\u53c2\u6570(_OBJECT_HEADER.TypeIndex)\u4f60\u5c31\u53ef\u4ee5\u5224\u5b9a\u8fd9\u4e2a\u5bf9\u8c61\u7684\u7c7b\u578b\u662f\u4ec0\u4e48\u3002\u4e3e\u4e00\u4e2a\u6817\u5b50\uff1a\u52a0\u5165\u5728\u4e00\u4e2a\u8fdb\u7a0b\u53e5\u67c4\u8868\u4e2d\u6307\u5411\u591a\u4e2a\u5bf9\u8c61\u5934\u90e8\uff0c\u4e3a\u4e86\u786e\u5b9a\u8fd9\u4e9b\u5bf9\u8c61\u90fd\u662f\u4ec0\u4e48\u7c7b\u578b\uff0c\u672c\u6765\u4f60\u9700\u8981\u53bb\u904d\u5386\u4e0a\u9762\u8bf4\u7684\u8868\u624d\u80fd\u786e\u5b9a\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u4f46\u662f\u73b0\u5728\u4f60\u53ea\u9700\u8981\u67e5\u770b\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u7684 _OBJECT_HEADER.TypeIndex \u503c\u5c31\u53ef\u4ee5\u4e86\uff0c\u901a\u8fc7\u8fd9\u4e2a\u7d22\u5f15\u4f60\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa _OBJECT_TYPE \u7684 Name \u5c5e\u6027(\u89c1\u4e0b\u9762\u8fd9\u5f20Win7x64\u7684_OBJECT_TYPE\u7684\u8868)\uff1a In [4]: dt(\"_OBJECT_TYPE\") '_OBJECT_TYPE' (208 bytes) 0x0 : TypeList ['_LIST_ENTRY'] 0x10 : Name ['_UNICODE_STRING'] //\u8fd9\u4e2aName\u5c5e\u6027\u7684\u503c\u5c31\u662f\u8fd9\u4e2a\u5bf9\u8c61\u7684\u7c7b\u578b\u7684\u540d\u79f0(Proces,File,Key\u7b49) 0x20 : DefaultObject ['pointer64', ['void']] 0x28 : Index ['unsigned char'] 0x2c : TotalNumberOfObjects ['unsigned long'] //\u672c\u5bf9\u8c61\u7c7b\u578b\u7684\u5bf9\u8c61\u603b\u6570 0x30 : TotalNumberOfHandles ['unsigned long'] //\u672c\u5bf9\u8c61\u7c7b\u578b\u7684\u5bf9\u8c61\u7684\u53e5\u67c4\u7684\u603b\u6570 0x34 : HighWaterNumberOfObjects ['unsigned long'] 0x38 : HighWaterNumberOfHandles ['unsigned long'] 0x40 : TypeInfo ['_OBJECT_TYPE_INITIALIZER'] //\u4e00\u4e2a_OBJECT_TYPE_INITIALIZER\u7c7b\u578b\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5185\u5bb9\u4e3a\u5185\u5b58\u4e3a\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5b9e\u4f8b\u5206\u914d\u5185\u5b58\u7684\u65b9\u5f0f(\u5206\u9875\uff1f\u4e0d\u5206\u9875\uff1f) 0xb0 : TypeLock ['_EX_PUSH_LOCK'] 0xb8 : Key ['unsigned long'] //\u4e00\u4e2a\u56db\u5b57\u8282\u7684\u3001\u7528\u4e8e\u552f\u4e00\u6807\u8bc6\u672c\u5bf9\u8c61\u7c7b\u578b\u7684\u3001\u5bf9\u8c61\u7684\u6807\u7b7e 0xc0 : CallbackList ['_LIST_ENTRY'] \u3000\u3000\u4e0a\u8ff0\u7684\u8fd9\u4e9b\u5c5e\u6027\u4e2d\uff0c TypeInfo \u548c Key \u4e24\u4e2a\u5c5e\u6027\u63d0\u4f9b\u7684\u7ebf\u7d22\u53ef\u4ee5\u544a\u8bc9\u4f60\u4e24\u4e2aW\uff1aWhere(\u53bb\u54ea\u91cc\u5bfb\u627e\uff0c\u662f\u5206\u9875\u7684\u5185\u5b58\u8fd8\u662f\u6ca1\u5206\u9875\u7684)\u548cWhat(\u4e00\u4e2a\u7279\u6b8a\u7684\u56db\u5b57\u8282\u7684\u6807\u7b7etag)\u3002\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u955c\u50cf\u4e3a\u4f7f\u7528DumpIt\u83b7\u53d6\u7684\u5185\u5b58\u6587\u4ef6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e3aWin7x64SP1\uff0c\u5185\u5b58\u683c\u5f0f\u4e3araw\u3002\u4f7f\u7528volatility\u7684volshell\u8fdb\u884c\u8bf4\u660e\uff0c\u9700\u8981windbg\u5de5\u5177((\u6ca1\u6709windbg\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u540e\u9762\u6211\u4f1a\u63d0\u5230))\u3002 \u3000\u3000\u9996\u5148\u6765\u770b\u770bvolshell\u600e\u4e48\u4f7f\u7528\uff1a \u3000\u3000\u4f7f\u7528 hh() \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u7528\u6cd5 # root @ kali in ~/Desktop [14:30:31] $ volatility -f FLOAT-WIN7-20200130-055210.raw --profile Win7SP1x64 volshell Volatility Foundation Volatility Framework 2 .6 Current context: System @ 0xfffffa8018d45740, pid = 4 , ppid = 0 DTB = 0x187000 Python 2 .7.17 ( default, Oct 19 2019 , 23 :36:22 ) Type \"copyright\" , \"credits\" or \"license\" for more information. IPython 5 .8.0 -- An enhanced Interactive Python. ? -> Introduction and overview of IPython 's features. %quickref -> Quick reference. help -> Python' s own help system. object? -> Details about 'object' , use 'object??' for extra details. In [ 1 ] : hh () Use addrspace () for Kernel/Virtual AS Use addrspace () .base for Physical AS Use proc () to get the current process object and proc () .get_process_address_space () for the current process AS and proc () .get_load_modules () for the current process DLLs addrspace () : Get the current kernel/virtual address space. cc ( offset = None, pid = None, name = None, physical = False ) : Change current shell context. db ( address, length = 128 , space = None ) : Print bytes as canonical hexdump. dd ( address, length = 128 , space = None ) : Print dwords at address. dis ( address, length = 128 , space = None, mode = None ) : Disassemble code at a given address. dq ( address, length = 128 , space = None ) : Print qwords at address. dt ( objct, address = None, space = None, recursive = False, depth = 0 ) : Describe an object or show type info. find ( needle, max = 1 , shift = 0 , skip = 0 , count = False, length = 128 ) : getmods () : Generator for kernel modules ( scripting ) . getprocs () : Generator of process objects ( scripting ) . hh ( cmd = None ) : Get help on a command. list_entry ( head, objname, offset = -1, fieldname = None, forward = True, space = None ) : Traverse a _LIST_ENTRY. modules () : Print loaded modules in a table view. proc () : Get the current process object. ps () : Print active processes in a table view. sc () : Show the current context. For help on a specific command, type 'hh(<command>)' \u3000\u3000\u4e0b\u9762\u662f\u6bcf\u4e00\u4e2a\u63d2\u4ef6\u7684\u7528\u6cd5\uff1a \u4f7f\u7528 addrspace() \u83b7\u53d6\u865a\u62df\u6216\u7269\u7406\u5730\u5740\u7684\u6570\u636e\u7ed3\u6784 \u4f7f\u7528 addrspace().base \u83b7\u53d6\u7269\u7406\u5730\u5740\u7684\u6570\u636e\u7ed3\u6784 \u4f7f\u7528 proc() \u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u5bf9\u8c61 proc().get_process_address_space() \u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u5bf9\u8c61\u7684\u5730\u5740 proc().get_load_modules() \u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u5bf9\u8c61\u52a0\u8f7d\u7684dll addrspace(): \u83b7\u53d6\u5f53\u524d\u5185\u6838\u6216\u8005\u865a\u62df\u5730\u5740\u7a7a\u95f4 cc(offset=None, pid=None, name=None, physical=False):\u7528\u4e8e\u6539\u53d8\u5f53\u524dshell\u7684\u4e0a\u4e0b\u6587 db(address, length=128, space=None): \u4ee516\u8fdb\u5236dump\u7684\u5f62\u5f0f\u6253\u5370\u8be5\u5730\u5740\u5904\u7684\u5b57\u8282 dd(address, length=128, space=None): \u4ee5\u53cc\u5b57\u7684\u683c\u5f0f\u6253\u5370\u6b64\u5730\u5740\u5185\u5bb9 dis(address, length=128, space=None, mode=None) : \u53cd\u6c47\u7f16\u6b64\u5904\u7684\u4ee3\u7801 dq(address, length=128, space=None): \u4ee5\u56db\u5b57\u7684\u683c\u5f0f\u6253\u5370\u6b64\u5730\u5740\u5185\u5bb9 dt(objct, address=None, space=None, recursive=False, depth=0): \u63cf\u8ff0\u6b64\u5bf9\u8c61\u6216\u8005\u663e\u793a\u5b83\u7684\u7c7b\u578b find(needle, max=1, shift=0, skip=0, count=False, length=128): getmods(): \u5185\u6838\u6a21\u5757\u751f\u6210\u5668(\u811a\u672c\u5316) getprocs(): \u8fdb\u7a0b\u5bf9\u8c61\u751f\u6210\u5668(\u811a\u672c\u5316) hh(cmd=None): \u83b7\u53d6\u4e00\u4e2a\u547d\u4ee4\u7684\u5e2e\u52a9 list_entry(head, objname, offset=-1, fieldname=None, forward=True, space=None) : \u904d\u5386\u4e00\u4e2a_LIST_ENTRY\u6570\u636e\u7ed3\u6784\u4f53 modules(): \u4ee5\u8868\u683c\u5f62\u5f0f\u6253\u5370\u52a0\u8f7d\u7684\u6a21\u5757 proc(): \u83b7\u5f97\u5f53\u524d\u8fdb\u7a0b\u5bf9\u8c61 ps(): \u4ee5\u8868\u683c\u7684\u5f62\u5f0f\u6253\u5370\u5f53\u524d\u7684\u6d3b\u52a8\u8fdb\u7a0b sc(): \u663e\u793a\u5f53\u524d\u4e0a\u4e0b\u6587 \u3000\u3000\u5728\u5f00\u59cb\u5b9e\u9a8c\u524d\u4f60\u9700\u8981\u5728\u4f60\u81ea\u5df1\u7684windows\u865a\u62df\u673a\u4e0a\u5b89\u88c5Windbg\uff0c\u8fd9\u91cc\u63d0\u4f9b \u4e00\u7bc7\u6559\u7a0b \u6211\u8fd9\u91cc\u865a\u62df\u673a\u662fWin7x64SP1\uff0c\u4e3b\u673a\u662fWin10\u3002\u914d\u7f6e\u597d\u4ee5\u540e\uff0c\u91cd\u542f\u4f60\u7684\u865a\u62df\u673a\uff0c\u4f7f\u7528\u8c03\u8bd5\u7684\u542f\u52a8\u9879\uff0c\u7136\u540e\u5f00\u542fwindbg\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u4e0b\u9762\u7684\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000 \u3000\u3000\u4e0a\u8ff0\u914d\u7f6e\u597d\u4e86\u4ee5\u540e\uff0c\u518d\u5f00\u59cb\u6211\u4eec\u7684\u793a\u4f8b\uff1a \u3000\u3000\u4e0b\u9762\u6211\u4eec\u904d\u5386\u4e00\u4e0b\u5185\u6838\u7a7a\u95f4\u5185100\u4e2a\u5bf9\u8c61\u7684\u5bf9\u8c61\u7c7b\u578b\uff0c\u770b\u770b\u90fd\u662f\u4ec0\u4e48\u7c7b\u578b\u7684\u3002\u8fd9\u91cc\u4e3b\u8981\u76ee\u7684\u662f\u719f\u6089volshell\u7684\u4f7f\u7528\u4ee5\u53ca\u6f84\u6e05\u51e0\u4e2a\u6982\u5ff5\uff1a kernel_space = addrspace () ObjectTypeIndexTable = 0xfffff80004039340 // \u4e0b\u9762\u4f1a\u8bf4\u660e\u8fd9\u4e2a\u503c\u600e\u4e48\u6765\u7684 ptrs = obj . Object ( \"Array\" , targetType = \"Pointer\" , offset = ObjectTypeIndexTable , cout = 100 , vm = kernel_space ) for i , ptr in enumerate ( ptrs ): objType = ptr . dereference_as ( \"_OBJECT_TYPE\" ) if objType . is_valid (): print i , str ( objtype . Name ), \"in\" , str ( objtype . TypeInfo . PoolType ), \"with key\" , str ( objtype . Key ) \u3000\u3000\u8fd9\u6bb5\u4ee3\u7801\u7684\u542b\u4e49\u662f\u9996\u5148\u83b7\u53d6\u5185\u6838\u7684\u5730\u5740\uff1b\u7b2c\u4e8c\u884c\u8bbe\u7f6e\u4e86\u7c7b\u578b\u7d22\u5f15\u8868\u7684\u5730\u5740\uff0c\u540e\u9762\u8981\u4f7f\u7528\u5230\u8be5\u8868\uff1b\u7b2c\u4e09\u884c\u5b9e\u4f8b\u5316\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u7c7b\u578b\u4e3a\u6570\u7ec4\uff0c\u50a8\u5b58\u5185\u5bb9\u7c7b\u578b\u4e3a\u6307\u9488\uff0c\u6570\u7ec4\u5927\u5c0f\u4e3a100\uff1b\u7b2c\u56db\u884c\u5f00\u59cb\u904d\u5386\u8fd9\u4e00\u767e\u4e2a\u5143\u7d20\uff0c\u5c06\u6bcf\u4e2a\u6307\u9488\u89e3\u91ca\u4e3a\u4e00\u4e2a_OBJECT_TYPE\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u5982\u679c\u4ed6\u662f\u6709\u6548\u7684\u8bdd\u5c31\u5c06\u5b83\u7684\u540d\u79f0\u3001\u7c7b\u578b\u4fe1\u606f\u3001Key\u503c(\u8fd9\u4e9b\u90fd\u662f\u5bf9\u8c61\u7c7b\u578b\u5bf9\u8c61\u7684\u5c5e\u6027)\u6253\u5370\u51fa\u6765\uff0c\u5177\u4f53\u8fd9\u4e9b\u503c\u7684\u542b\u4e49\u5728\u672c\u8282\u5f00\u5934\u6211\u4eec\u5df2\u7ecf\u63d0\u5230\u4e86\u3002 \u3000\u3000 ObjectTypeIndexTable \u8fd9\u4e2a\u53d8\u91cf\u7684\u503c\u662f\u7c7b\u578b\u7d22\u5f15\u8868\uff0c\u5b83\u5728windows\u5185\u6838\u662f\u4ee5\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u5bfc\u51fa\u7684\u3002\u6253\u5f00windbg\uff0c\u67e5\u770b\u8fd9\u4e2a\u53d8\u91cf\u7684\u503c\u3002 \u3000\u3000\u56e0\u4e3a\u6211\u6ca1\u6709\u5b66\u8fc7windbg\u4f7f\u7528\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u662f\u7b80\u5355\u4f7f\u7528\uff0c\u5982\u679c\u4e0d\u80fd\u4e0b\u8f7d\u7b26\u53f7\u8868\u7684\u8bdd\uff0c\u53ef\u4ee5\u6302\u4ee3\u7406\u4e0b\u8f7d\u3002\u4f7f\u7528 dd ObTypeIndexTable \u547d\u4ee4\u5c31\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u503c\u4e86\uff1a \u3000\u3000 \u3000\u3000\u8fd9\u91cc\u6211\u7684\u503c\u662f 0xfffff80004039340 \uff0c\u4e0b\u9762\u5728volshell\u4e2d\u8fd0\u884c\u8fd9\u4e2a\u811a\u672c\uff1a \u3000\u3000\u5148\u8bbe\u7f6e\u5185\u6838\u7a7a\u95f4\u7684\u5730\u5740\u4ee5\u53ca\u53d8\u91cf\u7684\u503c\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u8868\u662f\u6709\u5185\u5bb9\u7684(\u5982\u679c\u662f\u7a7a\u7684\u5c31\u8bf4\u660e\u4f60\u53ef\u80fd\u627e\u9519\u4e86\uff0c\u6211\u7b2c\u4e00\u6b21\u5c31\u662f\u8fd9\u6837)\uff1a \u3000\u3000 \u3000\u3000 \u3000\u3000\u4e4b\u540e\u8fdb\u884c\u904d\u5386\u5faa\u73af\uff1a \u3000\u3000 \u3000\u3000\u5728\u7ed3\u679c\u4e2d\u53ef\u4ee5\u770b\u5230\u8fd9\u51e0\u4e2a\u7279\u70b9\uff1a 1. \u7b2c\u4e00\u5217\u603b\u6570\u4e0d\u662f100\uff0c\u8bf4\u660e\u4e0d\u662f\u6bcf\u4e00\u4e2a\u53d8\u91cf\u90fd\u662f_OBJECT_TYPE\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u5373\uff0c\u4ed6\u4e0d\u662f\u4e00\u4e2a\u5bf9\u8c61\u7c7b\u578b\u7684\u5bf9\u8c61 2. \u7b2c\u4e8c\u5217\u4e2d\u6253\u5370\u51fa\u6765\u7684\u5bf9\u8c61\u7c7b\u578b\u7684\u540d\u79f0\u5c31\u662f\u8fd9\u4e2a\u6307\u9488\u6240\u6307\u7684\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u5728\u4e0a\u9762\u7684\u8868\u4e2d\u90fd\u53ef\u4ee5\u627e\u5230 3. \u7b2c\u56db\u5217\u53ef\u4ee5\u770b\u5230\u53ea\u6709\u4e24\u4e2a\u503c\uff0c\u5373\u50a8\u5b58\u5728\u5206\u9875\u7684\u5185\u5b58\u4e2d\u8fd8\u662f\u6ca1\u5206\u9875\u7684\u5185\u5b58\u4e2d 4. \u6700\u540e\u4e00\u5217\u7684key\u503c\u53ef\u4ee5\u770b\u5230\u90fd\u662f4\u5b57\u8282\u7684\uff0c\u8fd9\u4e5f\u543b\u5408\u4e86\u672c\u8282\u5f00\u5934\u6240\u63cf\u8ff0\u7684\u5bf9\u8c61\u7c7b\u578b\u5bf9\u8c61\u7684\u7ed3\u6784 \u3000\u3000\u5982\u679c\u6ca1\u6709windbg\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528volatility\u7684 objtypescan \u63d2\u4ef6\u6765\u5f97\u51fa\u4e0a\u8ff0\u811a\u672c\u7684\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000\u8fd9\u4e2a\u63d2\u4ef6\u7684\u7ed3\u679c\u548c\u4e0a\u9762\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\uff0c\u4e8c\u8005\u7684\u533a\u522b\u662f\uff0c\u4f7f\u7528nt!ObTytpeIndexTable\u662f\u5f00\u59cb\u7684\u5730\u5740\u5f00\u59cb\u8fdb\u884c\u626b\u63cf\u7684\uff0c\u800cvolatility\u4e2d\u7684objtypescan\u63d2\u4ef6\u7ed3\u679c\u7684\u987a\u5e8f\u662f\u6309\u7167\u88ab\u53d1\u73b0\u7684\u987a\u5e8f\u51fa\u73b0\u7684\u3002","title":"Object Type Objects (windows \u5bf9\u8c61\u7c7b\u578b\u5bf9\u8c61)"},{"location":"ram2/#kernel-pool-allocations","text":"\u5185\u6838\u6c60(kernel pool)\u662f\u4e00\u6bb5\u53ef\u5206\u7684\u5185\u5b58\uff0c\u53ef\u4ee5\u5206\u4e3a\u4e0d\u540c\u7684\u5c0f\u7684\u5757\u6765\u50a8\u5b58\u5185\u6838\u6a21\u5f0f\u7684\u7ec4\u4ef6(NT\u3001\u7b2c\u4e09\u65b9\u9a71\u52a8\u7b49)\u6240\u9700\u8981\u7684\u4efb\u4f55\u7c7b\u578b\u7684\u6570\u636e \u548c\u5806\u7c7b\u4f3c\uff0c\u6bcf\u4e00\u4e2a\u5206\u914d\u7684\u5757\u90fd\u6709\u4e00\u4e2a\u5934 --- _POOL_HEADER \uff0c\u5b83\u5305\u542b\u7740\u8ba1\u6570\u548c\u8c03\u8bd5\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5e2e\u52a9\u4f60\u627e\u5230\u4e0d\u540c\u5757\u7684\u5185\u5b58\u6240\u5f52\u5c5e\u7684\u9a71\u52a8\uff0c\u800c\u4e14\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u53ef\u4ee5\u5e2e\u52a9\u4f60\u63a8\u65ad\u6570\u636e\u7ed3\u6784\u7684\u7c7b\u578b\u6216\u8005\u5305\u542b\u8fd9\u4e9b\u5185\u5b58\u7684\u5bf9\u8c61\u3002\u5b66\u4e60\u8fd9\u90e8\u5206\u9664\u4e86\u5bf9\u5185\u5b58\u53d6\u8bc1\u6709\u5f88\u5927\u5e2e\u52a9\uff0c\u5728\u653b\u51fb\u65b9\u9762\u4e5f\u6709\u5e2e\u52a9\uff0c\u5982\u8fd9\u7bc7\u6587\u7ae0 Kernel Pool Exploitation on Windows.7 \u6240\u8ff0\u3002 \u3000\u3000\u4e0b\u9762\u8fd9\u5f20\u56fe\u662f\u5728Object Header\u7684\u7ed3\u6784\u56fe\u7684\u57fa\u7840\u4e0a\u589e\u6539\u7684(\u7ea2\u6846\u662f\u589e\u52a0\u7684)\uff1a \u3000\u3000 \u3000\u3000\u53ef\u4ee5\u770b\u5230\u5728\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u5934\u90e8\u4fe1\u606f\u4e2d\u9664\u4e86\u53ef\u9009\u5934\u90e8\u4fe1\u606f\u5916\u8fd8\u6709\u4e00\u4e2a _POOL_HEADER \u7684\u6570\u636e\u7ed3\u6784\u4fe1\u606f\u3002\u5728Win7\u4e2d _POOL_HEADER \u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u7ed3\u6784\u662f\u8fd9\u6837\u7684\uff1a In [2]: dt(\"_POOL_HEADER\") '_POOL_HEADER' (16 bytes) 0x0 : BlockSize ['BitField', {'end_bit': 24, 'start_bit': 16, 'native_type': 'unsigned long'}] 0x0 : PoolIndex ['BitField', {'end_bit': 16, 'start_bit': 8, 'native_type': 'unsigned long'}] 0x0 : PoolType ['BitField', {'end_bit': 32, 'start_bit': 24, 'native_type': 'unsigned long'}] 0x0 : PreviousSize ['BitField', {'end_bit': 8, 'start_bit': 0, 'native_type': 'unsigned long'}] 0x0 : Ulong1 ['unsigned long'] 0x4 : PoolTag ['unsigned long'] 0x8 : AllocatorBackTraceIndex ['unsigned short'] 0x8 : ProcessBilled ['pointer64', ['_EPROCESS']] 0xa : PoolTagHash ['unsigned short'] \u3000\u3000\u5173\u952e\u7684\u53d8\u91cf\u503c\u6709\u8fd9\u4e09\u4e2a\uff1a 1. BlockSize: \u5757\u5927\u5c0f\uff0c\u4ee3\u8868\u4e86\u5206\u914d\u7684\u5bf9\u8c61\u5927\u5c0f\uff0c\u5305\u62ec\u4e86\u6c60\u5934\u90e8(pool header)\u3001\u5bf9\u8c61\u5934\u90e8\u3001\u548c\u53ef\u9009\u5934\u90e8\u4fe1\u606f 2. PoolType: \u8fd9\u4e2a\u6c60\u7684\u7cfb\u7edf\u5185\u5b58\u7684\u7c7b\u578b(\u5206\u9875\uff1f\u4e0d\u5206\u9875\uff1f) 3. PoolTag: \u4e00\u4e2a4\u5b57\u8282\u7684\u3001\u7531ASCII\u5b57\u7b26\u7ec4\u6210\u7684\u3001\u552f\u4e00\u6807\u8bc6\u7684\u3001\u53d1\u751f\u5185\u5b58\u5206\u914d\u7684\u4ee3\u7801\u8def\u5f84(\u53ef\u4ee5\u5e2e\u52a9\u5c06\u4e00\u4e9b\u9ebb\u70e6\u7684\u5757\u5f52\u5c5e\u5230\u5b83\u4eec\u7684\u6e90)\u3002\u5728Win8\u548cWin2012\u4e2d,\u5176\u4e2d\u4e00\u4e2a\u5b57\u7b26\u53ef\u80fd\u4f1a\u88ab\u4fee\u6539\u4e3a\u4fdd\u62a4\u4f4d","title":"Kernel Pool Allocations (\u5185\u6838\u6c60\u5206\u914d)"},{"location":"ram2/#allocation-api-api","text":"\u5728\u5b9e\u4f8b\u5316\u4e00\u4e2a\u6267\u884c\u4f53\u5bf9\u8c61(\u6216\u8005\u5176\u4ed6\u5bf9\u8c61)\u65f6\uff0c\u4e00\u4e2a\u8db3\u591f\u5bb9\u7eb3\u8fd9\u4e2a\u5b9e\u4f8b\u5316\u7684\u5bf9\u8c61\u7684\u3001\u4ee5\u53ca\u4ed6\u7684\u5934\u90e8\u4fe1\u606f\u7684\u5185\u5b58\u5757\u4f1a\u4ece\u64cd\u4f5c\u7cfb\u7edf\u6c60\u4e2d\u88ab\u5206\u914d\u3002 \u5b9e\u73b0\u8fd9\u4e2a\u5206\u914d\u7684API\u662f ExAllocatePoolWithTag \uff0c\u4ed6\u7684\u51fd\u6570\u539f\u578b\u662f\u8fd9\u6837\u7684\uff1a PVOID ExAllocatePoolWithTag ( _In_ POOL_TYPE PoolType , //\u8981\u5206\u914d\u7684\u7cfb\u7edf\u5185\u5b58\u7684\u7c7b\u578b\uff0c0\u4ee3\u8868\u4e0d\u5206\u9875\uff0c1\u4ee3\u8868\u5206\u9875 _In_ SIZE_T NumberOfBytes , //\u8981\u5206\u914d\u7684\u5927\u5c0f\uff0c\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d _In_ ULONG Tag ); \u3000\u3000\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u4e0a\u9762\u5b9e\u9a8c\u4e5f\u53ef\u4ee5\u770b\u5230\u5927\u90e8\u5206\u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b\u90fd\u88ab\u5206\u914d\u5728\u4e0d\u5206\u9875\u5185\u5b58\uff0c\u4f60\u53ef\u4ee5\u67e5\u770b _OBJECT_TYPE.Typeinfo.PoolType \u8fd9\u4e2a\u503c\u6765\u67e5\u770b\u5177\u4f53\u3002 \u3000\u3000\u4e5f\u6709\u5176\u4ed6\u7684\u6807\u5fd7\u4f4d(_POOL_TYPE\u6570\u636e\u7ed3\u6784)\u6765\u67e5\u770b\u4e00\u6bb5\u5185\u5b58\u5230\u5e95\u662f\u53ef\u6267\u884c\u7684\uff0c\u8fd8\u662f\u7f13\u5b58\u5bf9\u9f50\u7684\uff0c\u8fd8\u662f\u5176\u4ed6\u7684\uff0c \u5b66\u4e60\u94fe\u63a5 \u3002 \u3000\u3000\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u5b83\u51b3\u5b9a\u4e86\u8c03\u7528 ExAllocatePoolWithTag \u8fd9\u4e2a\u51fd\u6570\u7684\u9a71\u52a8\u8981\u6c42\u5206\u914d\u7684\u6570\u636e\u5927\u5c0f\u3002\u5185\u6838\u4e2d\u7684\u51fd\u6570 ObCreateObject \u4f1a\u6700\u7ec8\u6765\u6267\u884c\u6240\u6709\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u521b\u5efa\u3002\u4e3e\u4e2a\u6817\u5b50\u5427\uff0c\u5047\u5982\u8bf4\u4f60\u8981\u7533\u8bf7\u4e00\u4e2a EPROCESS \u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4ed6\u7684\u5927\u5c0f\u662f1232\u5b57\u8282(win7x64)\uff0c\u7136\u540e\u4f60\u5728\u52a0\u4e0a _OBJECT_HEADER \u548c\u5176\u4ed6\u53ef\u9009\u5934\u90e8\u4fe1\u606f\u7684\u5927\u5c0f\uff0c\u6700\u7ec8\u7684**\u5b57\u8282\u6570**\u5c31\u662f\u4f60\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u503c\u3002 \u3000\u3000\u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u4ed6\u662f\u4e00\u4e2a4\u5b57\u8282\u7684\u3001\u7531ASCII\u5b57\u7b26\u7ec4\u6210\u7684\u3001\u552f\u4e00\u6807\u8bc6\u7684\u3001\u53d1\u751f\u5185\u5b58\u5206\u914d\u7684\u4ee3\u7801\u8def\u5f84\u3002 \u5bf9\u4e8e\u6267\u884c\u4f53\u5bf9\u8c61\u6765\u8bf4\u7684\u8bdd \uff0c\u8fd9\u4e2a\u6807\u7b7e\u662f\u7531 _OBJECT_TYPE.Key \u8fd9\u4e2a\u5c5e\u6027\u6d3e\u751f\u7684\uff0c\u4e8c\u8005\u90fd\u662f4\u5b57\u8282\uff0c\u6240\u4ee5\u540c\u4e00\u4e2a\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4ed6\u4eec\u7684Tag\u53c2\u6570\u662f\u4e00\u6837\u7684\u3002","title":"Allocation API (\u5206\u914dAPI)"},{"location":"ram2/#_3","text":"\u4e0b\u9762\u4e3e\u4e00\u4e2a\u6817\u5b50\uff0c\u770b\u770b\u4e00\u4e2a\u8fdb\u7a0b\u5728\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u65f6\u662f\u600e\u4e48\u8fdb\u884c\u7684\uff1a 1. \u5f53\u524d\u8fdb\u7a0b\u8c03\u7528CreateFileA(ASCII\u683c\u5f0f)\u6216\u8005CreateFileW(Unicode\u683c\u5f0f)\uff0c\u8fd9\u4e24\u4e2a\u51fd\u6570\u90fd\u662fkernel32.dll\u4e2d\u7684\u51fd\u6570\u3002 2. CreateFileA\u6216\u8005CreateFileW\u51fd\u6570\u4f7f\u7528\u4e86ntdll.dll\u5e93\uff0c\u8fd9\u4e2a\u5e93\u968f\u540e\u4f1a\u8c03\u7528\u5185\u6838\u51fd\u6570NtCreateFile\u3002 3. NtCreateFile\u51fd\u6570\u4f1a\u8c03\u7528ObCreateObject\u51fd\u6570\u6765\u7533\u8bf7\u4e00\u4e2a\u65b0\u7684FIle\u7c7b\u578b\u7684\u5bf9\u8c61\u3002 4. ObCreateObject\u51fd\u6570\u4f1a\u8ba1\u7b97_FILE_OBJECT\u7ed3\u6784\u4f53\u7684\u5927\u5c0f\uff0c\u5305\u62ec\u5bf9\u8c61\u7684\u53ef\u9009\u5934\u90e8\u4fe1\u606f\u7684\u7a7a\u95f4\u7a7a\u95f4\u3002 5. ObCreateObject\u51fd\u6570\u67e5\u627eFile\u5bf9\u8c61\u7684_OBJECT_TYPE\u6570\u636e\u7ed3\u6784\uff0c\u5e76\u51b3\u5b9a\u662f\u653e\u5728\u5206\u9875\u5185\u5b58\u8fd8\u662f\u4e0d\u8981\u5206\u9875\u5185\u5b58\uff0c\u4ee5\u53ca\u786e\u5b9a4\u5b57\u8282\u7684tag 6. \u8c03\u7528ExAllocatePoolWithTag\u51fd\u6570\uff0c\u4f7f\u7528\u4e0a\u9762\u8ba1\u7b97\u51fa\u7684\u4e09\u4e2a\u53c2\u6570\uff1a\u5bf9\u8c61\u5927\u5c0f\u3001\u5185\u5b58\u7c7b\u578b\u3001tag \u3000\u3000\u4e0a\u8ff0\u6b65\u9aa4\u7ed3\u675f\u540e\uff0c\u4f1a\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u4e00\u4e2a _FILE_OBJECT \u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5e76\u4e14\u8fd9\u6b21\u5206\u914d\u4f1a\u88ab\u4e00\u4e2a4\u5b57\u8282\u7684tag\u6765\u552f\u4e00\u6807\u8bc6\u3002\u5f53\u7136\u4e4b\u540e\u8fd8\u4f1a\u6709\u4e00\u4e2a\u6307\u5411\u8be5\u5bf9\u8c61\u7684\u6307\u9488\u88ab\u6dfb\u52a0\u5230\u8be5\u8fdb\u7a0b\u7684\u53e5\u67c4\u8868\u4e2d\u3001\u64cd\u4f5c\u7cfb\u7edf\u5168\u5c40\u7684\u6c60\u4e2d\u6807\u7b7e\u8ddf\u8e2a\u6570\u636e\u5e93(tag tracking database)\u4e5f\u4f1a\u8fdb\u884c\u76f8\u5e94\u7684\u66f4\u65b0\u3001\u8be5\u5bf9\u8c61\u4e2d\u5176\u4ed6\u7684\u5c5e\u6027\u4e5f\u4f1a\u88ab\u521d\u59cb\u5316\uff0c\u5982\uff1a\u6743\u9650(\u8bfb\u3001\u5199\u3001shan)\uff0c\u6587\u4ef6\u7684\u521b\u5efa\u8def\u5f84\u3002 \u3000\u3000\u53e6\u5916\u8865\u5145\u4e00\u70b9\uff1a\u5e76\u975e\u4f7f\u7528\u76f8\u540c\u5927\u5c0f\u3001tag\u503c\u3001\u5185\u5b58\u7c7b\u578b\u7684\u5bf9\u8c61jiu\u5c31\u4f1a\u88ab\u5206\u914d\u5230\u8fde\u7eed\u7684\u5185\u5b58\u4e2d\uff0c\u8fd9\u4e48\u8bf4\u662f\u56e0\u4e3awindows\u4f1a\u5c1d\u8bd5\u5c06\u5927\u5c0f\u8fd1\u4f3c\u7684\u5bf9\u8c61\u653e\u5728\u4e00\u8d77\uff0c\u524d\u63d0\u662f\u6ca1\u6709\u53ef\u7528\u7684\u7a7a\u95f2\u5757\u6765\u6ee1\u8db3\u8bf7\u6c42\u7684\u5927\u5c0f\u4e86\uff0c\u5185\u6838\u4f1a\u4ece\u4e0b\u4e00\u4e2a\u5927\u7684\u7ec4\u4e2d\u6765\u9009\u62e9\u4e00\u4e2a\u5757\u7528\u4e8e\u5206\u914d\u3002\u8fd9\u6837\u7684\u7ed3\u679c\u5c31\u662f\u4f60\u4f1a\u770b\u5230\u540c\u4e00\u7c7b\u578b\u7684\u5bf9\u8c61\u5206\u6563\u5728windows\u7684\u6c60\u4e2d\u3002\u6b64\u5916\uff0c\u8fd9\u6837\u7684\u5206\u914d\u7279\u70b9\u4f1a\u5bfc\u81f4\u5c0f\u7684\u6570\u636e\u7ed3\u6784\u5360\u7528\u4e86\u4e00\u4e2a\u7528\u4e8e\u50a8\u5b58\u5927\u7684\u6570\u636e\u7ed3\u6784\u7684\u5185\u5b58\u5757\uff0c\u5f62\u6210\u4e86\u4e00\u79cd\u677e\u6563\u7684\u7ed3\u6784(slack space)\uff0c\u5982\u679c\u6ca1\u6709\u9002\u5f53\u7684\u6e05\u7406\u5185\u5b58\u7684\u8bdd\u3002\u8be6\u7ec6\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0 The Impact of Windows Pool Allocation Strategies on Memory Forensics","title":"\u4e00\u4e2a\u5206\u914d\u5b9e\u4f8b"},{"location":"ram2/#de-allocation-and-reuse","text":"\u5728\u4e0a\u8ff0\u7684\u8fdb\u7a0b\u521b\u5efa\u6587\u4ef6\u7684\u4f8b\u5b50\u4e2d\uff0c\u8fd9\u4e2a\u88ab\u521b\u5efa\u7684\u6587\u4ef6\u7684\u76f8\u5173\u6570\u636e\u7ed3\u6784_FILE_OBJECT\u7684\u751f\u5b58\u65f6\u95f4(\u5728\u5185\u5b58\u4e2d\u7684\u5b58\u5728\u65f6\u95f4)\uff0c\u53d6\u51b3\u4e8e\u5f88\u591a\u56e0\u7d20\u3002\u8fd9\u91cc\u8ba8\u8bba\u4e0b\u91ca\u653e\u548c\u91cd\u7528(De-allocation and Reuse) \u5728\u8fd9\u4e9b\u56e0\u7d20\u4e2d\uff0c\u552f\u4e00\u7684\u3001\u6700\u91cd\u8981\u7684\u56e0\u7d20\u662f\u8fd9\u4e2a\u8fdb\u7a0b\u7ed3\u675f\u8bfb\u6216\u5199\u65b0\u6587\u4ef6\u65f6(\u901a\u8fc7\u8c03\u7528CloseHandle)\u65f6\uff0c\u7528\u4e86\u591a\u4e45\u7684\u65f6\u95f4\uff0c\u539f\u6587\uff1a how soon the process indicates (by calling CloseHandle ) that it is finished reading or writing the new file. \uff0c\u6b64\u65f6\uff0c \u5982\u679c\u6216\u6ca1\u6709\u5176\u4ed6\u7684\u8fdb\u7a0b\u4f7f\u7528\u8fd9\u4e2a\u6587\u4ef6\u5bf9\u8c61 \uff0c\u90a3\u4e48\u8fd9\u5757\u5185\u5b58\u5c31\u4f1a\u88ab\u91ca\u653e\u4f1a\u6c60\u4e2d\u7684**\u7a7a\u95f2\u5217\u8868**(free list)\uff0c\u8fd9\u6837\u8fd9\u5757\u5185\u5b58\u5c31\u53ef\u4ee5\u88ab\u91cd\u65b0\u5206\u914d\u4ee5\u4f9b\u4ed6\u7528\u3002\u5728\u7b49\u5f85\u88ab\u91cd\u65b0\u5206\u914d\u7684\u65f6\u5019\u6216\u8005\u7b49\u5f85\u5199\u5165\u65b0\u6570\u636e\u5230\u5185\u5b58\u65f6\uff0c\u5927\u90e8\u5206\u539f\u5148\u7684(\u91ca\u653e\u524d)\u7684_FILE_OBJECT\u7684\u5185\u5bb9\u4f1a\u4fdd\u6301\u5b8c\u6574(will remain intact)\u3002 \u3000\u3000\u7a76\u7adf\u8fd9\u5757\u5185\u5b58\u505c\u7559\u5728\u5b8c\u6574\u7684\u72b6\u6001(\u4e0a\u8ff0\u72b6\u6001)\u591a\u4e45\uff0c\u53d6\u51b3\u4e8e\u7cfb\u7edf\u7684\u6d3b\u52a8\u7b49\u7ea7(activity level)\u3002\u5982\u679c\u7cfb\u7edf\u5728\u731b\u70c8\u7684\u6296\u52a8(thrashing)\uff0c\u5e76\u4e14\u540e\u7eed\u8bf7\u6c42\u7684\u5185\u5b58\u5c0f\u4e8e\u6216\u7b49\u540c\u4e8e _FILE_OBJECT (\u8fd9\u4e2a\u4f8b\u5b50\u4e2d)\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u8fc5\u901f\u7684\u590d\u5199\uff1b\u5426\u5219\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u4f1a\u751f\u5b58\u51e0\u5929\u6216\u8005\u51e0\u4e2a\u661f\u671f---\u9664\u975e\u521b\u5efa\u8fd9\u4e2a\u6587\u4ef6\u7684\u8fdb\u7a0b\u7ed3\u675f\u4e86\u3002 \u3000\u3000**\u6ce8\u610f\uff1a**\u5f53\u4e00\u5757\u6c60\u7684\u5185\u5b58\u88ab\u91ca\u653e\u7684\u65f6\u5019\uff0c\u5e76\u4e0d\u662f\u76f4\u63a5\u88ab\u590d\u5199\u4e86\uff0c\u800c\u662f\u7b80\u5355\u7684\u6807\u8bb0\u4e3a\u4e86 free \u3002\u8fd9\u5bf9\u4e8e\u786c\u76d8\u53d6\u8bc1(disk forensics)\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u5f53\u4e00\u4e2aNTFS\u7684\u6587\u4ef6\u88ab\u5220\u9664\u65f6\uff0c\u53ea\u6709\u4e3b\u6587\u4ef6\u8868(Master File Table, MFT)\u4f1a\u76f8\u5e94\u7684\u6539\u53d8\u72b6\u6001\uff0c\u800c\u6587\u4ef6\u7684\u5185\u5bb9\u4f1a\u4fdd\u6301\u4e0d\u53d8---\u76f4\u5230\u8be5\u5206\u914d\u7684\u7c07(sectors\uff0c\u5206\u914d\u662f\u6309\u7c07\u5206\u914d\u7684\uff0c\u5982NTFS\u4e2d\u4e00\u4e2a\u7c07\u662f4096\u5b57\u8282)\u88ab\u91cd\u65b0\u5206\u914d\u7ed9\u4e86\u65b0\u7684\u6587\u4ef6\uff0c\u5e76\u4e14\u53d1\u751f\u4e86\u5199\u4e8b\u4ef6\u3002\u57fa\u4e8e\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5df2\u7ecf\u88ab\u64cd\u4f5c\u7cfb\u7edf\u91ca\u653e\u7684\u5185\u5b58\u4e2d\u627e\u5230\u6267\u884c\u4f53\u5bf9\u8c61\u3002\u8fd9\u6837\u4f60\u5c31\u83b7\u5f97\u4e86\u5728\u5185\u5b58\u4e2d\u67e5\u627e\u4e0d\u4ec5\u662f\u5f53\u524d\u5e38\u7528\u7684\u6267\u884c\u4f53\u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u67e5\u627e\u8fc7\u53bb\u5b58\u5728\u8fc7\u7684\u8d44\u6e90\u3002","title":"De-allocation and Reuse (\u91ca\u653e\u548c\u91cd\u7528)"},{"location":"ram2/#pool-tag-scanning","text":"\u6c60\u6807\u7b7e\u626b\u63cf\uff0c\u4e5f\u53eb\u6c60\u626b\u63cf(pool-scanning)\uff0c\u662f\u6839\u636e\u4e0a\u9762\u63d0\u5230\u7684_POOL_HEADER.PoolTag\u6765\u8fdb\u884c\u5206\u914d\u67e5\u627e\u7684\u65b9\u6cd5\u3002 \u4e3e\u4e00\u4e2a\u6817\u5b50\uff0c\u4e3a\u4e86\u5b9a\u4f4d\u4e00\u4e2a\u8fdb\u7a0b\u5bf9\u8c61\uff0c\u4f60\u53ef\u4ee5\u627e**\u5185\u6838\u7b26\u53f7\u8868**(Kernel Symbol)\u4e2d\u7684\u6d3b\u52a8\u8fdb\u7a0b\u94fe\u8868PsAcvtivePeorecssList(\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\uff0c\u4fdd\u5b58\u7740\u7cfb\u7edf\u4e2d\u6240\u6709\u8fdb\u7a0b\u7684EPROCESS\u7ed3\u6784)\uff0c\u7136\u540e\u904d\u5386\u8fd9\u4e2a\u8fdb\u7a0b\u8868\u3002\u6216\u8005\uff0c\u4f7f\u7528\u6c60\u626b\u63cf\u7684\u65b9\u6cd5\uff0c\u4ed6\u4f1a\u7ffb\u6574\u4e2a\u5185\u5b58\u6587\u4ef6\uff0c\u53bb\u67e5\u627eProc\u6807\u8bb0(\u4e0e_EPROCESS\u76f8\u5173\u7684\u56db\u5b57\u8282\u6807\u8bb0)\u3002\u4f7f\u7528\u540e\u8005\u65b9\u5f0f\u7684\u4f18\u70b9\u662f\u4f60\u53ef\u4ee5\u4ece\u8868\u4e2d\u53d1\u73b0\u4e00\u4e9b\u5386\u53f2\u6761\u76ee(\u4e0d\u518d\u8fd0\u884c\u7684\u8fdb\u7a0b)\uff0c\u6216\u8005\u53ef\u4ee5\u627e\u5230\u4e00\u4e9brootkit\u7684\u75d5\u8ff9(\u6bd4\u5982Direct Kernel Object Manipulation \uff0c DKOM ) \u3000\u3000\u4f46\u662f\u4f60\u4e5f\u4e0d\u80fd\u5168\u9760\u4e2atag\u6765\u51b3\u5b9a\uff0c\u5426\u5219\u4f1a\u6709\u5927\u91cf\u7684\u9519\u8bef\u3002\u6240\u4ee5Volatility\u5185\u5efa\u4e86\u4e00\u4e2a\u66f4\u725b\u903c\u7684\"\u7b7e\u540d\"\u6765\u5e2e\u52a9\u4f60\u5206\u8fa8\u5185\u5b58\u4e2d\u4f60\u60f3\u8981\u7684\u5206\u914d\u5355\u5143\uff0c\u539f\u7406\u5c31\u662f\u524d\u9762\u5c0f\u8282\u53d9\u8ff0\u7684\u3002\u6bd4\u5982\u5206\u914d\u5355\u5143\u7684\u5927\u5c0f\u3001\u5185\u5b58\u7684\u7c7b\u578b(\u5206\u6ca1\u5206\u9875)\u90fd\u80fd\u5e2e\u52a9\u51cf\u5c0f\u9519\u8bef\u3002\u5047\u5982\u4f60\u8981\u627e\u4e2a100\u5b57\u8282\u7684_EPROCESS\u7ed3\u6784\u4f53\uff0c\u4f46\u662f\u4f60\u9488\u5177\u6807\u7b7e\uff0c\u5374\u627e\u5230\u4e86\u4e00\u4e2a30\u5b57\u8282\u7684\u5355\u5143\uff0c\u90a3\u663e\u7136\u662f\u4e0d\u5bf9\u7684\u3002\u9664\u4e86tag\u3001\u5927\u5c0f\u3001\u5185\u5b58\u7c7b\u578b\u5916\uff0cVolatility\u7684pool-scanning\u8fd8\u652f\u6301\u81ea\u5b9a\u4e49\u4e00\u4e9b\u7ea6\u675f\u6765\u5e2e\u52a9\u641c\u7d22\u3002\u6bd4\u5982\u4f60\u53ef\u4ee5\u52a0\u4e2a\u65f6\u95f4\u6233\u3002","title":"Pool-Tag Scanning (\u6c60\u6807\u7b7e\u626b\u63cf)"},{"location":"ram2/#pool-tag-sources","text":"\u4e0b\u9762\u8fd9\u5f20\u8868Volatility\u901a\u8fc7pool scanning\u6765\u67e5\u627e\u6307\u5b9a\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u6807\u51c6\uff0c\u7b2c\u56db\u5217\u7684\u6700\u5c0f\u5927\u5c0f\u90fd\u6dfb\u52a0\u4e86_EPROCESS(\u5bf9\u4e8eprocess\u5bf9\u8c61)\u3001_OBJECT_HEADER\u3001\u4ee5\u53ca_POOL_HEADER\u3002\u6700\u540e\u4e00\u5217\u662f\u5bf9\u5e94\u7684\u63d2\u4ef6\uff0c\u7ecf\u5e38\u4f1a\u4f7f\u7528\u5230\u3002 \u3000\u3000 \u3000\u3000\u4f46\u662f\u4e0a\u9762\u8fd9\u4e9b\u6570\u636e\u4e0d\u662f\u56fa\u5b9a\u7684\uff0c\u5f53windows\u6709\u65b0\u7248\u672c\u51fa\u6765\u7684\u65f6\u5019\uff0c\u90fd\u53ef\u80fd\u8981\u4fee\u6539\uff0c\u800c\u4e14\u5982\u679c\u6709\u6076\u610f\u7684\u5185\u6838\u9a71\u52a8\u4ece\u6c60\u4e2d\u7533\u8bf7\u7a7a\u95f4\u6765\u5b58\u653e\u5b83\u7684\u6570\u636e(\u5982\uff1a\u914d\u7f6e\u4fe1\u606f,\u547d\u4ee4\u548c\u63a7\u5236\u6570\u636e\u5305,\u9700\u8981\u9690\u85cf\u7684\u7cfb\u7edf\u8d44\u6e90\u7684\u540d\u79f0\u7b49\u7b49)\u3002\u6240\u4ee5\u4f60\u53ef\u80fd\u9700\u8981\u81ea\u5df1\u4fee\u6539\u673a\u5236\u6765\u5305\u542b\u65b0\u7684\u6807\u51c6\u3002 \u3000\u3000\u6b64\u5916\uff0c\u6ce8\u610f\u4e00\u4e0b\u4e0a\u8868\u4e2d\u7684\u7b2c\u4e09\u5217\u3002\u5173\u4e8e\u5185\u6838\u6c60\u6807\u8bb0\u6700\u4e0d\u5e38\u89c1\u7684\u4e00\u4e2a\u590d\u6742\u7279\u6027\u5c31\u662f\u53d7\u4fdd\u62a4\u4f4d(the protected bit).\u5f53\u6211\u4eec\u901a\u8fc7 ExFreePoolWithTag \u91ca\u653e\u4e00\u4e2a\u5185\u6838\u6c60\u7684\u65f6\u5019,\u6211\u4eec\u5fc5\u987b\u8bbe\u7f6e\u8ddf\u5f53\u521d\u7533\u8bf7\u7a7a\u95f4\u65f6\u6240\u7528\u7684 ExAllocatePoolWithTag \u4e00\u6837\u7684\u6807\u8bb0\u3002\u8fd9\u9879\u6280\u672f\u662f\u64cd\u4f5c\u7cfb\u7edf\u7528\u6765\u9632\u6b62\u9a71\u52a8\u7a0b\u5e8f\u610f\u5916\u91ca\u653e\u5185\u5b58\u800c\u8bbe\u8ba1\u7684.\u5982\u679c\u4f20\u9012\u7ed9\u91ca\u653e\u51fd\u6570\u7684\u6807\u8bb0\u4e0d\u5339\u914d,\u90a3\u4e48\u7cfb\u7edf\u5c06\u629b\u51fa\u4e00\u4e2a\u5f02\u5e38\u3002\u8fd9\u5bf9\u4e0e\u5185\u5b58\u53d6\u8bc1\u6765\u8bf4\u6709\u5f88\u5927\u7684\u5f71\u54cd,\u56e0\u4e3a\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u5c31\u9700\u8981\u5bfb\u627e\u53d7\u4fdd\u62a4\u7684\u5185\u6838\u6c60\u6807\u8bb0\u3002 \u3000\u3000\u5185\u6838\u6c60\u6807\u8bb0\u4e2d\u53d7\u4fdd\u62a4\u7684\u4f4d\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5185\u5b58\u5206\u914d\u90fd\u4f1a\u8bbe\u7f6e,\u4ec5\u9650\u4e0e\u67d0\u4e9b\u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b.\u6b64\u5916,\u4eceWindows 8\u548cWindows Server 2012\u5f00\u59cb,\u8c8c\u4f3c\u5185\u6838\u6c60\u6807\u8bb0\u4e2d\u53d7\u4fdd\u62a4\u4f4d\u53d6\u6d88\u4e86\u3002\u5173\u4e8e\u53d7\u4fdd\u62a4\u7684\u4f4d\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\u53ef\u4ee5\u53c2\u8003 \u8fd9\u7bc7\u6587\u7ae0","title":"Pool Tag Sources (\u6c60\u6807\u8bb0\u6e90)"},{"location":"ram2/#pooltag-file","text":"\u6b63\u5982\u4e4b\u524d\u6240\u63d0\u5230\u7684\uff0c \u5fae\u8f6f\u521b\u5efa\u6c60\u6807\u8bb0\u662f\u4e3a\u4e86\u8c03\u8bd5\u548c\u5ba1\u8ba1\u7684\u76ee\u7684 \u3002\u56e0\u6b64\uff0cWindows\u9a71\u52a8\u5f00\u53d1\u5305(DDK\u6216\u8005WDK)\u548cWindows\u8c03\u8bd5\u5de5\u5177\u7684\u5b89\u88c5\u76ee\u5f55\u4e2d\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u540d\u4e3a pooltag.txt \u7684\u6587\u4ef6,\u8fd9\u4e2a\u6587\u4ef6\u6211\u4eec\u53ef\u4ee5\u7528\u4e8e\u67e5\u627e\u3002\u4e3e\u4e2a\u6817\u5b50\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u6c60\u6807\u8bb0(pool tag)\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u786e\u5b9a\u8be5\u5185\u5b58\u5206\u914d\u7684\u76ee\u7684\u4ee5\u53ca\u62e5\u6709\u8fd9\u5757\u5185\u5b58\u7684\u5185\u6838\u9a71\u52a8\u3002\u56e0\u4e3a\u8be5\u6587\u4ef6\u4e2d\u5305\u542b\u6709\u63cf\u8ff0\u4fe1\u606f\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u53ef\u4ee5\u4ece\u8bf8\u5982\"\u8fdb\u7a0b\u5bf9\u8c61\"(process object)\u6216\u8005\"\u6587\u4ef6\u5bf9\u8c61\"(File object)\u8fd9\u6837\u7684\u5173\u952e\u5b57\u5165\u624b\uff0c\u8fdb\u800c\u627e\u51fa\u5176\u6c60\u6807\u8bb0\u3002 \u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2apooltag.txt\u6587\u4ef6\u7684\u90e8\u5206\u5185\u5bb9\uff0c\u4f60\u53ef\u4ee5\u5728\u4f60windbg\u7684triage\u6587\u4ef6\u5939\u4e2d\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\uff1a rem rem Pooltag.txt rem rem This file lists the tags used for pool allocations by kernel mode components rem and drivers. rem rem The file has the following format: rem <PoolTag> - <binary-name> - <Description> rem rem Pooltag.txt is installed with Debugging Tools for Windows (%windbg%\\triage) rem and with the Windows DDK (in %winddk%\\tools\\other\\platform\\poolmon, where rem platform is amd64, i386, or ia64). rem AdSv - vmsrvc.sys - Virtual Machines Additions Service ARPC - atmarpc.sys - ATM ARP Client ATMU - atmuni.sys - ATM UNI Call Manager [snip] Proc - nt!ps - Process objects //\u6ce8\u610f\u8fd9\u91cc Ps - nt!ps - general ps allocations [snip] RaDA - tcpip.sys - Raw Socket Discretionary ACLs RaEW - tcpip.sys - Raw Socket Endpoint Work Queue Contexts bookist.cc Part II: Windows Memory Forensics 132 RaJP - tcpip.sys - Raw Socket Join Path Contexts RaMI - tcpip.sys - Raw Socket Message Indication Tags \u3000\u3000\u5728\u659c\u7ebf\u6807\u6ce8\u7684\u5730\u65b9\u6307\u51fa\uff1a\u8fdb\u7a0b\u5bf9\u8c61\u7684\u6807\u7b7e\u662f Proc \uff0c\u7531nt!ps\u6765\u5206\u914d\uff0cnt!ps\u662fNT\u7684\u8fdb\u7a0b\u5b50\u7cfb\u7edf\u3002\u5f97\u5230\u4e86\u8fd9\u4e2a\u4fe1\u606f\u540e\uff0c\u4f60\u8fd8\u9700\u8981\u627e\u5230\u8fd1\u4f3c\u7684\u5206\u914d\u5927\u5c0f\u4ee5\u53ca\u5185\u5b58\u7684\u7c7b\u578b(\u5206\u9875?\u4e0d\u5206\u9875?)\u3002 \u3000\u3000\u5728\u8fd9\u4e2a \u7f51\u5740 \u4e2d\u4f60\u4e5f\u53ef\u4ee5\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4f46\u662f\u91cc\u9762\u7684\u5185\u5bb9\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u63d0\u4ea4\uff0c\u6240\u4ee5\u4e0d\u4e00\u5b9a\u51c6\u786e\uff0cwindbg\u5b89\u88c5\u76ee\u5f55\u4e0b\u5c31\u6709\u8fd9\u4e2a\u6587\u4ef6\u3002","title":"Pooltag File"},{"location":"ram2/#poolmon-utility","text":"PoolMon (poolmon.exe) \u5185\u5b58\u6c60\u76d1\u89c6\u5668\uff0c\u663e\u793a\u7684\u64cd\u4f5c\u7cfb\u7edf\u4ece\u5206\u9875\u7cfb\u7edf\u6536\u96c6\u6709\u5173\u5185\u5b58\u5206\u914d\u6570\u636e\u548c\u975e\u5206\u9875\u7684\u5185\u6838\u6c60\u548c\u7528\u4e8e\u7ec8\u7aef\u670d\u52a1\u4f1a\u8bdd\u4f7f\u7528\u7684\u5185\u5b58\u6c60\u3002 \u6309\u6c60\u5206\u914d\u6807\u8bb0\u5206\u7ec4\u6570\u636e\u3002\u9a71\u52a8\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u548c\u6d4b\u8bd5\u4eba\u5458\u901a\u5e38\u4f7f\u7528 PoolMon \u68c0\u6d4b\u5185\u5b58\u6cc4\u6f0f\u65f6\u4e0d\u521b\u5efa\u65b0\u7684\u9a71\u52a8\u7a0b\u5e8f\u3001 \u66f4\u6539\u9a71\u52a8\u7a0b\u5e8f\u4ee3\u7801\u4e2d\uff0c\u6216\u5f3a\u8c03\u8be5\u9a71\u52a8\u7a0b\u5e8f\u3002 \u6b64\u5916\u53ef\u4ee5\u4f7f\u7528 PoolMon \u6d4b\u8bd5\u7684\u6bcf\u4e2a\u9636\u6bb5\u4e2d\u53ef\u67e5\u770b\u5206\u914d\u548c free \u64cd\u4f5c\u7684\u9a71\u52a8\u7a0b\u5e8f\u7684\u6a21\u5f0f\uff0c\u5e76\u4ee5\u663e\u793a\u8be5\u9a71\u52a8\u7a0b\u5e8f\u4f7f\u7528\u5728\u4efb\u4f55\u7ed9\u5b9a\u65f6\u95f4\u7684\u6c60\u5185\u5b58\u91cf\u3002 \u4e0a\u8ff0\u5bf9PoolMon\u7684\u63cf\u8ff0\u6765\u81ea \u5fae\u8f6f\u5b98\u65b9\u8bf4\u660e \u3002poolMon\u5728DDK(Micrsoft's Driver Development, DDK\uff0c\u4e5f\u53ebWDK)\u4e2d\u53ef\u4ee5\u627e\u5230\u3002\u5b83\u4f1a\u62a5\u544a\u7cfb\u7edf\u4e2d\u4f7f\u7528\u7684\uff0c\u5173\u4e8e\u6c60\u6807\u7b7e\u5b9e\u65f6\u7684\u66f4\u65b0\uff0c\u4ee5\u53ca\u4ee5\u4e0b\u4fe1\u606f\uff1a \u5185\u5b58\u7c7b\u578b(\u662f\u5426\u5206\u9875) \u5206\u914d\u6570\u91cf \u7a7a\u95f2\u6570\u91cf \u5206\u914d\u5360\u7528\u7684\u5b57\u8282\u7684\u603b\u6570 \u5e73\u5747\u6bcf\u4e00\u4e2a\u5206\u914d\u5360\u7528\u7684\u5b57\u8282\u6570 \u3000\u3000\u4f60\u53ef\u4ee5 \u4ece\u8fd9\u91cc \u4e0b\u8f7dDDK\uff0c\u5728 C:\\Program Files (x86)\\Windows Kits\\10\\Tools\\x64 \u8def\u5f84\u5c31\u53ef\u4ee5\u770b\u5230\u8be5\u5de5\u5177\u3002\u4f7f\u7528\u5de5\u5177\u7684-b\u9009\u9879\u53ef\u4ee5\u4ee5\u5b57\u8282\u7684\u683c\u5f0f\u6574\u7406\u6570\u636e\uff0c\u5c06\u6700\u5bf9\u5185\u5b58\u654f\u611f\u7684\u6807\u7b7e\u5148\u5217\u51fa\u6765\uff0c\u4e0b\u56fe\u662f\u6211\u5728win10\u4e0a\u7684\u7ed3\u679c\uff1a \u3000\u3000 \u3000\u3000\u5bf9\u6211\u6211\u8fd9\u91cc\u7684\u622a\u56fe\u6765\u8bf4\uff0c\u6211\u5f53\u524dMmSt\u6807\u7b7e\u662f\u5728\u6bd4\u7279\u6570\u91cf(Bytes\u5217)\u6392\u5e8f\u4e2d\u662f\u7b2c\u4e00\u4e2a\uff0c\u4ece\u7cfb\u7edf\u5f00\u59cb\u5230\u622a\u56fe\u8fd9\u4e00\u523b\uff0c\u8fd9\u4e2a\u6807\u7b7e\u8c03\u7528\u4e86503058\u6b21 exAllocatePoolWithTag \u51fd\u6570(\u7b2c\u4e09\u5217)\uff0c\u5176\u4e2d431441\u4e2a\u6c60\u88ab\u91ca\u653e\u4e86\uff0c\u4e8c\u8005\u7684\u5dee\u4e3a71,617(Diff\u5217)\uff0c\u5373\u5f53\u524d\u670971617\u4e2a\u6c60\u88ab\u5206\u914d\uff0c\u4ed6\u4eec\u603b\u5171\u5360\u7528\u4e86324342208\u4e2a\u5b57\u8282\u7684\u5185\u5b58(\u5927\u6982324.3MB)\uff0c\u5e73\u5747\u7b97\u4e0b\u6765\u4e00\u4e2a\u6c60\u5360\u4e86\u5185\u5b58\u7ea6\u4e3a4528\u5b57\u8282\u3002 \u3000\u3000\u5728\u7b2c\u4e00\u4e2a\u767d\u8272\u7684\u6760\u4e0b\u9762\u7b2c\u4e8c\u6760\u6709\u4e00\u4e2aCM25\u6807\u7b7e\uff0c\u5927\u6982\u5360\u4e86\u5185\u5b5816MB\uff0cCM\u7684\u610f\u601d\u662f\u914d\u7f6e\u7ba1\u7406\u5668(Configuration Manager)\uff0c\u5b83\u662f\u4e00\u4e2a\u5305\u542b\u7740windows\u6ce8\u518c\u8868\u7684\u5185\u6838\u7ec4\u4ef6\u3002\u6240\u6709\u8fd9\u4e9bCM\u6807\u7b7e\u52a0\u8d77\u6765\u7684\u603b\u548c\u5927\u6982\u5c31\u662f\u4f60\u6ce8\u518c\u8868\u7684\u5927\u5c0f\uff0c\u4f46\u662f\u4f60\u4e0d\u53ef\u80fd\u628a\u4ed6\u4eec\u90fd\u4ece\u5185\u5b58\u4e2ddump\u51fa\u6765\uff0c\u56e0\u4e3a\u50a8\u5b58\u5728\u5206\u9875\u5185\u5b58\u4e2d\u7684\u6807\u7b7e\u5b83\u7684\u6570\u636e\u53ef\u80fd\u4f1a\u6620\u5c04\u5230\u78c1\u76d8\u4e0a\uff0c\u800c\u4f60\u624b\u5934\u53ea\u6709\u5185\u5b58\u3002 \u3000\u3000\u6b64\u5916\uff0c\u7b2c\u4e00\u4e2a\u767d\u8272\u7684\u6760\u662f\u4e00\u4e2aFile\u6807\u7b7e\uff0c\u5b83\u50a8\u5b58\u7740\u4e00\u4e2a_FILE_OBJECT\u6570\u636e\u7ed3\u6784\uff0c\u53ef\u4ee5\u770b\u5230\u5927\u69829900000\u4e2a\u6c60\u88ab\u521b\u5efa\uff0c\u5b83\u7684\u7279\u70b9\u662f\u6bcf\u6b21\u6587\u4ef6\u88ab\u6253\u5f00\u6216\u8005\u521b\u5efa\u7684\u65f6\u5019\u90fd\u4f1a\u5206\u914d\u4e00\u4e2a_FILE_OBJECT\u7ed3\u6784\u4f53\u3002\u4f46\u662f\u56e0\u4e3a\u6587\u4ef6\u5bf9\u8c61\u90fd\u76f8\u5bf9\u5c0f\u4e00\u70b9\uff0c\u6240\u4ee5\u53ef\u4ee5\u770b\u5230\u5b9e\u9645\u4e0a\u53ea\u670945265\u5b57\u8282\u88ab\u771f\u6b63\u5206\u914d\uff0c\u5e73\u5747\u6bcf\u4e2a\u6c60399\u5b57\u8282\u3002 \u3000\u3000\u5de6\u624b\u4e00\u4e2apoolMon\u53f3\u624b\u4e00\u4e2apooltag.txt\uff0c\u57fa\u672c\u4f60\u5c31\u638c\u63e1\u4e86\u6c60\u6807\u7b7e\uff0c\u76f8\u5e94\u63cf\u8ff0\uff0c\u6240\u5c5e\u5185\u6838\u9a71\u52a8\uff0c\u5206\u914d\u5927\u5c0f\uff0c\u5185\u5b58\u7c7b\u578b\u8fd9\u4e9b\u4fe1\u606f\u4e86\u3002\u8fd9\u4e9b\u4fe1\u606f\u5c31\u8db3\u591f\u4f60\u5f00\u59cb\u626b\u63cf\u5185\u5b58\u5bfc\u51fa\u6587\u4ef6\uff0c\u67e5\u627e\u5206\u914d\u7684\u5b9e\u4f8b\u4e86\u3002 \u3000\u3000\u4e3a\u4e86\u5b66\u4e60\u65b9\u4fbf\uff0c\u4f60\u8fd8\u53ef\u4ee5\u5728windbg\u4e2d\u4f7f\u7528!poolfind\u547d\u4ee4\u6765\u67e5\u627e\u4f60\u60f3\u8981\u7684\u6807\u7b7e\u5e76\u544a\u8bc9\u4f60\u5185\u5b58\u7c7b\u578b\u548c\u5206\u914d\u7684\u5927\u5c0f\uff0c\u6bd4\u5982\u4e66\u4e0a\u7684\u8fd9\u4e2a\u6817\u5b50\uff1a kd> !poolfind Proc Searching NonPaged pool (fffffa8000c02000 : ffffffe000000000) for Tag: Proc *fffffa8000c77000 size: 430 previous size: 0 (Allocated) Proc (Protected) *fffffa8001346000 size: 430 previous size: 0 (Allocated) Proc (Protected) *fffffa8001361000 size: 430 previous size: 0 (Allocated) Proc (Protected) *fffffa800138f7a0 size: 430 previous size: 30 (Free) Pro. *fffffa80013cb1e0 size: 430 previous size: c0 (Allocated) Proc (Protected) *fffffa80013e4460 size: 430 previous size: f0 (Allocated) Proc (Protected) *fffffa80014fd000 size: 430 previous size: 0 (Allocated) Proc (Protected) *fffffa800153ebd0 size: 10 previous size: 70 (Free) Pro. [snip] \u3000\u3000\u4ece\u4e0a\u9762\u7684\u4fe1\u606f\u4f60\u53ef\u4ee5\u770b\u5230\uff0c\u6709\u516d\u4e2a\u88ab\u5206\u914d\u4e86\u7684\u8fdb\u7a0b\uff0c\u6709\u4e24\u4e2a\u88ab\u6807\u8bb0\u4e3afree\uff0c\u5176\u4e2d\u4e00\u4e2afree\u7684\u5927\u5c0f\u548c\u5176\u4ed6\u4e00\u6837\uff0c\u90fd\u662f430\uff0c\u800c\u53e6\u4e00\u4e2a\u662f10\u3002\u6240\u4ee5\u4f60\u53ef\u4ee5\u63a8\u65ad\u8fd9\u4e2a\u4f4d\u4e8e0xfffffa800138f7a0\u7684\u5757\u53ef\u80fd\u5305\u542b\u8fd9\u4e00\u4e2a\u7ec8\u6b62\u7684\u8fdb\u7a0b_EPROCESS\u6570\u636e\u7ed3\u6784\uff0c\u800c0xfffffa800153ebd0\u7684\u90a3\u4e2a\u5757\u53ef\u80fd\u88ab\u91cd\u7528\u4e86\u3002","title":"PoolMon Utility (\u5185\u5b58\u6c60\u76d1\u89c6\u5668)"},{"location":"ram2/#pool-tracker-tables","text":"\u4e0a\u9762\u7684poolMon\u725b\u903c\u662f\u725b\u903c\uff0c\u95ee\u9898\u662f\u5185\u5b58\u53d6\u8bc1\u4e07\u4e00\u54b1\u53ea\u6709\u5185\u5b58\uff0c\u4e48\u5f97\u5b9e\u4f53\u673a\u548b\u8dd1poolMon.exe\uff1f\u6240\u5e78\u7684\u662f\u5185\u5b58\u4e2d\u5176\u5b9e\u662f\u5305\u542b\u4e86\u4e00\u4e9b\u9759\u6001\u6570\u636e\uff0c\u5b83\u4eec\u90fd\u4f1a\u88abpoolMon\u8bfb\u53d6\uff0c\u90a3\u600e\u4e48\u4e0d\u901a\u8fc7poolMon\u8bfb\u53d6\u8fd9\u4e9b\u6570\u636e\u5462\uff1f\u5b83\u4eec\u50a8\u5b58\u5728\u4e00\u4e2a\u5185\u6838\u8c03\u8bd5\u6570\u636e\u5757\u4e2d(_KDDEBUGGER_DATA64)\uff0c\u8fd9\u4e2a\u5757\u540c\u6837\u4e5f\u50a8\u5b58\u4e86\u6d3b\u52a8\u7684\u8fdb\u7a0b\u548c\u52a0\u8f7d\u7684\u6a21\u5757\u7684\u5217\u8868\u3002PoolTrackTable\u8868\u5b9e\u9645\u4e0a\u6307\u5411\u4e86\u4e00\u4e2a\u6570\u7ec4\uff0c\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u50a8\u5b58\u7740\u4e00\u4e9b\u540d\u4e3a _POOL_TRACKER_TABLE \u7684\u6570\u636e\u7ed3\u6784\uff0c\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u72ec\u7279\u7684\u5403\u6807\u7b7e\u90fd\u4f1a\u88ab\u8bb0\u5f55\uff0c\u4f7f\u7528volshell\u67e5\u770b\u4e00\u4e0b\uff0c\u8fd8\u662fWin7SP1x64: In [ 2 ] : dt ( \"_POOL_TRACKER_TABLE\" ) '_POOL_TRACKER_TABLE' ( 40 bytes ) 0x0 : Key [ 'String' , { 'length' : 4 }] 0x4 : NonPagedAllocs [ 'long' ] 0x8 : NonPagedFrees [ 'long' ] 0x10 : NonPagedBytes [ 'unsigned long long' ] 0x18 : PagedAllocs [ 'unsigned long' ] 0x1c : PagedFrees [ 'unsigned long' ] 0x20 : PagedBytes [ 'unsigned long long' ] \u3000\u3000\u53ef\u4ee5\u770b\u5230\u6bcf\u4e00\u4e2a\u8ddf\u8e2a\u5668\u8868\u90fd\u6709\u4e00\u4e2a4\u5b57\u8282\u7684Key\u5c5e\u6027\uff0c\u5269\u4e0b\u7684\u5c5e\u6027\u6839\u636e\u5185\u5b58\u7684\u7c7b\u578b\u5206\u4e3a\u4e86\u4e24\u7c7b\uff0c\u5206\u522b\u544a\u8bc9\u4f60\u4e86\u5206\u914d\u7684\u6570\u91cf\u3001\u91ca\u653e\u7684\u6570\u91cf\u3001\u5360\u7528\u603b\u5b57\u8282\u6570\u3002\u867d\u7136\u5185\u5b58\u6587\u4ef6\u662f\u4e00\u4e2a\u65f6\u523b\u7684\uff0c\u5e76\u4e0d\u80fd\u9879poolMon\u90a3\u6837\u5b9e\u65f6\u7684\u66f4\u65b0\u6570\u636e\uff0c\u4f46\u662f\u4f60\u81f3\u5c11\u80fd\u5224\u65ad\u51fa\u6765\u5b83\u5728\u8fd9\u4e00\u65f6\u523b(\u5185\u5b58\u5bfc\u51fa\u65f6)\u7684\u72b6\u6001\uff0c\u4e0b\u9762\u4f7f\u7528volatility\u7684 pooltracker \u63d2\u4ef6\u6765\u67e5\u8be2\u51e0\u4e2a\u7279\u5b9a\u7684\u6267\u884c\u4f53\u5bf9\u8c61\u6807\u7b7e\uff0c Np \u4ee3\u8868\u4e0d\u5206\u9875\uff0c Pg \u4ee3\u8868\u5206\u9875\uff1a \u3000\u3000 \u3000\u3000\u4ece\u7ed3\u679c\u6765\u770b\uff0c\u8fd9\u56db\u4e2a\u6807\u7b7e\u7684\u5bf9\u8c61\u90fd\u5728\u975e\u5206\u9875\u7684\u5185\u5b58\u4e2d\uff0c\u4ece\u4e0a\u9762\u7684\u7ed3\u679c\u4f60\u53ef\u4ee5\u5f97\u5230\u6bd4\u5982\u8fd9\u6837\u7684\u4fe1\u606f\uff1a\u5bf9\u4e8eThre\u6807\u7b7e(Thread Object)\uff0c\u5b83\u5e73\u5747\u6c60\u5927\u5c0f\u4e3a252544/(23747-22436)=1311\u5b57\u8282\u3002\u6240\u4ee5\u5982\u679c\u8981\u67e5\u627e\u6240\u6709\u7684\u5305\u542b\u7ebf\u7a0b\u5bf9\u8c61\u7684\u5206\u914d\u6c60\u7684\u8bdd\uff0c\u4f60\u7684\u67e5\u627e\u7ea6\u675f\u6761\u4ef6\u5c31\u662f\u8fd9\u6837\u7684\uff1a1.\u662f Thre \u6807\u7b7e\uff1b2.\u5927\u5c0f\u81f3\u5c11\u662f1311\u5b57\u8282\u3002 \u3000\u3000\u6b64\u5916\u8fd9\u91cc\u6709\u51e0\u4e2a\u4f7f\u7528 pooltracker \u63d2\u4ef6\u7684\u5c0f\u6280\u5de7\uff1a \u3000\u3000\u5982\u679c\u4f60\u8981\u663e\u793a\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\u7684\u8bdd\uff0c\u53ef\u4ee5\u5e26\u5e26\u4e0a--tagfile\u53c2\u6570\uff0c\u53c2\u6570\u503c\u662f\u4f60\u7684pooltag.txt\u6587\u4ef6\uff0c\u8fd9\u6837\u8f93\u51fa\u5c31\u4f1a\u663e\u793a\u4e0a\u9762\u7ed3\u679c\u6ca1\u6709\u663e\u793a\u7684\u63cf\u8ff0\u4ee5\u53ca\u6240\u5c5e\u9a71\u52a8\u4e86\u3002\u6bd4\u5982\u8fd9\u6837(\u6211\u7528\u7684win7\u7684pooltag.txt\uff0c\u4ed6\u6bd4win10\u7684\u5c0f)\uff1a \u3000\u3000 \u3000\u3000**\u6ce8\u610f\uff1a**\u56e0\u4e3awindows\u5728XP\u548c2003\u4e4b\u524d(\u5305\u62ec\u4ed6\u4eec)\u4e0d\u4f1a\u5c06\u8fd9\u4e9b\u7edf\u8ba1\u6570\u636e\u5199\u5230\u6c60\u8ddf\u8e2a\u5668\u8868\u4e2d\uff0c\u6240\u4ee5\u8fd9\u4e2a\u63d2\u4ef6\u53ea\u9002\u7528\u4e8eVista\u53ca\u4e4b\u540e\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002\u6b64\u5916\uff0c\u6c60\u8ddf\u8e2a\u8868\u4e5f\u6709\u5b83\u7684\u9650\u5236\u6027\uff0c\u4ed6\u53ea\u4f1a\u7edf\u8ba1\u6807\u7b7e\u7684\u4f7f\u7528\u60c5\u51b5\u7ed3\u679c\uff0c\u4e0d\u4f1a\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u6807\u7b7e\u7684\u6240\u6709\u5206\u914d\u6c60\u7684\u5730\u5740","title":"Pool Tracker Tables (\u6c60\u8ddf\u8e2a\u5668\u8868)"},{"location":"ram2/#building-a-pool-scanner","text":"DIY\u8d70\u8d77 \u5728\u4e0a\u9762\u7684\u5c0f\u8282\u4e2d\u53ef\u4ee5\u770b\u5230\uff0cVolatility\u4e3a\u5e38\u89c1\u7684tags\u90fd\u6709\u81ea\u5df1\u63d2\u4ef6\uff0c\u6bd4\u5982psscan\uff0cthrdscan\uff0cfilescan\u7b49\u7b49\u3002\u540c\u65f6Volatility\u4e5f\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u57fa\u7840\u7684\u53eb PoolScanner \u7c7b\uff0c\u6765\u5e2e\u52a9\u6211\u4eec\u81ea\u5df1DIY\u4e00\u4e2a\u626b\u63cf\u5668(\u6bd4\u5982\u53ef\u4ee5\u81ea\u5df1\u6307\u5b9a\u67e5\u627e\u4ec0\u4e48\u6807\u7b7e\uff0c\u6307\u5b9a\u67e5\u627e\u7684\u5206\u914d\u6c60\u5927\u5c0f\uff0c\u5206\u914d\u7684\u5185\u5b58\u7684\u7c7b\u578b\u7b49\u7b49)\uff0c\u4ee5\u53ca\u4e00\u4e2a\u53eb AbstractScanCommand \u7684\u7c7b\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e00\u4e2a\u6c60\u626b\u63cf\u5668\u5e94\u6709\u7684\u547d\u4ee4\u884c\u9009\u9879\u3002","title":"Building a Pool Scanner (\u5efa\u7acb\u4e00\u4e2a\u6c60\u626b\u63cf\u5668)"},{"location":"ram2/#extending-the-poolscanner-poolscanner","text":"\u4e0b\u9762\u7684\u4ee3\u7801\u662fpsscan\u63d2\u4ef6(\u626b\u63cf\u8fdb\u7a0b\u5bf9\u8c61\u7684\u6c60\u626b\u63cf\u5668)\u7684\u4e00\u4e2a\u5fc5\u8981\u914d\u7f6e\u6587\u4ef6\uff0c\u53ef\u81ea\u884c\u67e5\u770b\u6e90\u4ee3\u7801(/usr/lib/python2.7/dist-packages/volatility)\uff1a 1 class PoolScanProcess ( poolscan . PoolScanner ): 2 \"\"\"Pool scanner for process objects\"\"\" 3 4 def __init__ ( self , address_space , ** kwargs ): 5 poolscan . PoolScanner . __init__ ( self , address_space , ** kwargs ) 6 7 self . struct_name = \"_EPROCESS\" 8 self . object_type = \"Process\" 9 self . pooltag = obj . VolMagic ( address_space ) . ProcessPoolTag . v () 10 size = self . address_space . profile . get_obj_size ( \"_EPROCESS\" ) 11 12 self . checks = [ 13 ( 'CheckPoolSize' , dict ( condition = lambda x : x >= size )), 14 ( 'CheckPoolType' , dict ( non_paged = True , free = True )), 15 ( 'CheckPoolIndex' , dict ( value = 0 )), 16 ] \u3000\u3000\u9996\u5148 PoolScanProcess \u7c7b\u7ee7\u627f\u4e86 poolscan.PoolScan \u7c7b\uff0c\u6240\u4ee5\u65b9\u6cd5\u53ef\u4ee5\u4ece\u7236\u7c7b\u7ee7\u627f\uff0c\u5982\u679c\u4f60\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a\u626b\u63cf\u5668\u7684\u8bdd\uff0c\u53ea\u9700\u8981\u505a\u5982\u4e0b\u4fee\u6539\uff1a \u3000\u30001. Structure name\uff1a\u4fee\u6539\u7b2c\u4e03\u884c\u7684\u6570\u636e\u7ed3\u6784\u540d\u79f0\u3002\u5b83\u4f1a\u544a\u8bc9\u6c60\u626b\u63cf\u5668\u8981\u626b\u63cf\u7684\u6570\u636e\u7ed3\u6784\u7c7b\u578b \u3000\u30002. Object type\uff1a\u4fee\u6539\u7b2c\u516b\u884c\u7684\u6267\u884c\u4f53\u5bf9\u8c61\u7c7b\u578b\u3002\u5f53\u626b\u63cf\u5668\u626b\u63cf\u53ef\u80fd\u7684\u6c60\u5bf9\u8c61\u65f6\uff0c\u4ed6\u4f1a\u770b\u8fd9\u4e2a\u5bf9\u8c61\u7684_OBJECT_HEADER.Name\u5c5e\u6027\u7684\u503c\u662f\u4e0d\u662f\u8fd9\u91cc\u8bbe\u5b9a\u7684\u503c\u3002\u5982\u679c\u4e0d\u5305\u542b\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u8bdd\uff0c\u8fd9\u91cc\u7684\u503c\u53ef\u4ee5\u4e3a\u7a7a(\u6bd4\u5982\u7f51\u7edc\u8fde\u63a5\u548csockets) \u3000\u30003. Pool tag\uff1a\u4fee\u6539\u7b2c\u4e5d\u884c\u7684\u6c60\u6807\u7b7e\u3002\u5047\u5982\u4f60\u8981\u627eProc\u6807\u7b7e\u7684\u5bf9\u8c61\uff0c\u8fd9\u91cc\u4e0d\u80fd\u76f4\u63a5\u5199\u4e2aProc\uff0c\u800c\u662f\u4f7f\u7528\u4e86\u4e00\u4e2a\u6839\u636e\u4e0d\u540c\u7684profile\u7684\u5bb9\u5668\u6765\u83b7\u53d6\u7684\uff0c\u56e0\u4e3a\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u7684\u6807\u7b7e\u53ef\u80fd\u4f1a\u53d1\u751f\u53d8\u5316 \u3000\u30004. Allocation size\uff1a\u4fee\u6539\u7b2c\u5341\u884c\u7684\u5206\u914d\u5927\u5c0f\uff0c\u57fa\u4e8e\u6700\u5c0f\u7684\u8981\u67e5\u627e\u7684\u5bf9\u8c61\u7684\u5927\u5c0f(\u6bd4\u5982_EPROCESS\u7684\u5927\u5c0f)\u3002\u8fd9\u91cc\u7684\u503c\u4e5f\u4e0d\u662f\u76f4\u63a5\u5199\u7684\uff0c\u56e0\u4e3a\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u4f1a\u5f71\u54cd\u8fd9\u4e2a\u503c\uff0c\u5c24\u5176\u5bf9\u4e8e32\u4f4d\u64cd\u4f5c\u7cfb\u7edf\u548c64\u4f4d\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5927\u5c0f\u7684\u7ea6\u675f\u572813\u884c\u3002 \u3000\u30005. Memory type\uff1a\u4fee\u6539\u7b2c\u5341\u56db\u884c\u7684\u5185\u5b58\u7c7b\u578b\u3002\u8fd9\u91cc\u53ea\u6709non_paged\u548cfree\u4e24\u4e2a\u503c\u7684\u952e\u503c\u4e3atrue\uff0c\u90a3\u4e48\u626b\u63cf\u5668\u4f1a\u626b\u63cf\u975e\u5206\u9875\u533a\u548c\u91ca\u653e\u4e86\u7684\u5185\u5b58\u4e2d\u7684\u6c60\uff0c\u5e76\u8df3\u8fc7\u5728\u5206\u9875\u5185\u5b58\u4e2d\u7684\u7ed3\u679c\u3002","title":"Extending the PoolScanner (\u6269\u5c55PoolScanner\u63d2\u4ef6)"},{"location":"ram2/#extending-abstractscancommand","text":"\u4e0a\u4e00\u8282\u4e2d\u5df2\u7ecf\u770b\u4e86\u4e00\u4e2a\u626b\u63cf\u5668\u662f\u600e\u4e48\u521d\u59cb\u5316\u7684\uff0c\u4e0b\u4e00\u6b65\u5c31\u4f3c\u4e4e\u521b\u5efa\u4e00\u4e2a\u63d2\u4ef6\uff0c\u7531\u5b83\u6765\u52a0\u8f7d\u626b\u63cf\u5668\u5e76\u5728\u7ec8\u7aef\u4e2d\u5c55\u793a\u7ed3\u679c\uff0c\u4e0b\u9762\u662fpsscan\u7684\u63d2\u4ef6\u4ee3\u7801\uff1a 1 class PSScan ( common . AbstractScanCommand ): 2 \"\"\"Pool scanner for process objects\"\"\" 3 4 scanners = [ poolscan . PoolScanProcess ] 5 6 def render_text ( self , outfd , data ): 7 self . table_header ( outfd , [( 'Offset(P)' , '[addrpad]' ), 8 ( 'Name' , '16' ), 9 ( 'PID' , '>6' ), 10 ( 'PPID' , '>6' ), 11 ( 'PDB' , '[addrpad]' ), 12 ( 'Time created' , '30' ), 13 ( 'Time exited' , '30' ) 14 ]) 15 16 for pool_obj , eprocess in data : 17 self . table_row ( outfd , 18 eprocess . obj_offset , 19 eprocess . ImageFileName , 20 eprocess . UniqueProcessId , 21 eprocess . InheritedFromUniqueProcessId , 22 eprocess . Pcb . DirectoryTableBase , 23 eprocess . CreateTime or '' , 24 eprocess . ExitTime or '' ) \u3000\u3000PSScan\u7c7b\u7ee7\u627f\u4e86 common.AbstractScanCommand \u7236\u7c7b\uff0c\u5728\u7b2c\u56db\u884c\u7684scanners\u53d8\u91cf\uff0c\u5176\u503c\u65f6\u4e0a\u9762\u7684 poolscan.PoolScanProcess \u7c7b\uff0c\u8fd9\u91cc\u7684\u503c\u7531\u4f60\u8981\u5bfb\u627e\u7684\u5bf9\u8c61\u7684\u7c7b\u578b\u51b3\u5b9a\u30027-14\u884c\u751f\u6210\u4e86\u8868\u7684\u5934\u90e8\uff0c\u5c31\u662f\u4e0b\u56fe\u4e2d\u7a7a\u6846\u8fd9\u4e00\u884c\uff1a \u3000\u3000 \u3000\u300016-24\u884c\u5c06\u626b\u63cf\u5668\u5f97\u5230\u7684\u7ed3\u679c\u653e\u5165\u8868\u4e2d\uff0c\u5c31\u662f\u4e0a\u56fe\u4e2d\u7684\u6bcf\u4e00\u884c\u7ed3\u679c\uff0c\u4ed6\u4eec\u90fd\u662f_EPROCESS\u7c7b\u578b\u5bf9\u8c61(\u5728\u672c\u4f8b\u4e2d)\u3002 \u3000\u3000\u901a\u8fc7\u7ee7\u627fAbstractScanCommand\u7c7b\uff0c\u4f60\u7684\u65b0\u7684\u63d2\u4ef6\u5c31\u62e5\u6709\u4e86\u7528\u6237\u4f7f\u7528\u4e0d\u540c\u7684\u547d\u4ee4\u884c\u9009\u9879\u6765\u8c03\u6574\u7684\u80fd\u529b\uff0c\u6bd4\u5982\u4f60\u53ef\u4ee5\u7528--help\u6307\u4ee4\u770b\u4e0b\u5e2e\u52a9\uff1a (\u7701\u7565) -V, --virtual Scan virtual space instead of physical -W, --show-unallocated Skip unallocated objects (e.g. 0xbad0b0b0) -A START, --start=START The starting address to begin scanning -G LENGTH, --length=LENGTH Length (in bytes) to scan from the starting address Module Output Options: dot, greptext, html, json, sqlite, text, xlsx --------------------------------- Module PSScan --------------------------------- Pool scanner for process objects \u3000\u3000\u6bd4\u5982\u6211\u53ea\u626b\u63cf\u4e00\u6bb5\u533a\u95f4\u7684\uff1a","title":"Extending AbstractScanCommand (\u6269\u5c55\u9009\u9879)"},{"location":"ram2/#poolscanner-algorithm","text":"\u6240\u6709\u6c60\u626b\u63cf\u5668\u7684\u7236\u7c7b--- PoolScanner \u7c7b\u4f7f\u7528\u4e86\u4e0b\u9762\u8fd9\u4e2a\u56fe\u7684\u903b\u8f91\uff1a \u3000\u3000 \u3000\u3000\u56fe\u4e2d\u7684\u68c0\u67e5\u6b65\u9aa4\u90fd\u662f\u524d\u9762\u5c0f\u8282\u5b66\u4e60\u7684\u5185\u5bb9\u3002\u5373\u6bcf\u5230\u4e0b\u4e00\u4e2a\u5730\u5740\uff0c\u5c31\u68c0\u67e5\u8fd9\u4e2a\u5730\u5740\u4e2d\u7684\u6c60\u5bf9\u8c61\u662f\u5426\u5305\u542b**\u6807\u7b7e**Proc\uff0c\u662f\u7684\u8bdd\u63a5\u7740\u5224\u65ad\u4ed6\u7684**\u5927\u5c0f**\u662f\u5426\u6709\u6548\uff0c\u662f\u7684\u8bdd\u63a5\u7740\u5224\u65ad\u662f\u5426\u662f\u5728\u4e0d\u5206\u9875\u6216\u7a7a\u95f2\u5185\u5b58( \u5185\u5b58\u7c7b\u578b )\u4e2d\uff0c\u662f\u7684\u8bdd\u63a5\u7740\u4f7f\u7528\u7528\u6237**\u81ea\u5b9a\u4e49\u7684\u7ea6\u675f**\u8fdb\u884c\u5224\u65ad\uff0c\u6700\u7ec8\u5f97\u5230\u7ed3\u679c\u3002 \u3000\u3000\u5bf9\u4e8epsscan\u63d2\u4ef6\uff0c\u5982\u679c\u4f60\u8bbe\u7f6e\u4e86-V\u9009\u9879\uff0c\u90a3\u4e48\u626b\u63cf\u5668\u5c31\u4f1a\u4ece\u5185\u6838\u7684\u9875\u8868\u4e2d\u904d\u5386\u626b\u63cf\u6240\u6709\u7684\u9875\uff0c\u5426\u5219\u7684\u8bdd(\u65e0-V\u9009\u9879\u4f7f\u7528\u7269\u7406\u5730\u5740)\uff0c\u626b\u63cf\u5668\u4f1a\u4ece\u504f\u79fb\u5730\u57400\u5f00\u59cb\u8fdb\u884c\u626b\u63cf\uff0c\u76f4\u5230\u5185\u5b58\u6587\u4ef6\u7684\u672b\u5c3e\uff0c\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u7ed3\u679c\u7684\u6b63\u786e\u6027\u3002","title":"PoolScanner Algorithm (\u6c60\u626b\u63cf\u5668\u7b97\u6cd5)"},{"location":"ram2/#finding-terminated-processes","text":"\u5728\u5b98\u65b9\u7ed9\u7684windows\u955c\u50cf\u4e2d\u7684sample003.bin\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230psscan\u7684\u7ed3\u679c\u4e2d\u6709\u7684\u8fdb\u7a0b\u662f\u6709\u9000\u51fa\u65f6\u95f4\u7684\uff0c\u6bd4\u5982\u4e0b\u9762\u8fd9\u4e2acmd.exe\uff0c\u6301\u7eed\u4e862\u520610\u79d2\uff1a $ volatility -f sample003.bin --profile = WinXPSP2x86 psscan Volatility Foundation Volatility Framework 2 .6 Offset ( P ) Name PID PPID PDB Time created Time exited ------------------ ---------------- ------ ------ ---------- ------------------------------ ------------------------------ 0x000000000181b748 alg.exe 992 660 0x08140260 2008 -11-15 23 :43:25 UTC+0000 0x0000000001843b28 wuauclt.exe 1372 1064 0x08140180 2008 -11-26 07 :39:38 UTC+0000 0x000000000184e3a8 wscntfy.exe 560 1064 0x081402a0 2008 -11-26 07 :44:57 UTC+0000 0x00000000018557e0 alg.exe 512 672 0x08140260 2008 -11-26 07 :38:53 UTC+0000 0x000000000185dda0 cmd.exe 940 1516 0x081401a0 2008 -11-26 07 :43:39 UTC+0000 2008 -11-26 07 :45:49 UTC+0000 0x00000000018a13c0 VMwareService.e 1756 672 0x08140220 2008 -11-26 07 :38:45 UTC+0000 0x00000000018af448 VMwareUser.exe 1904 1516 0x08140100 2008 -11-26 07 :38:31 UTC+0000 0x00000000018af860 VMwareTray.exe 1896 1516 0x08140200 2008 -11-26 07 :38:31 UTC+0000 0x00000000018e75e8 spoolsv.exe 1648 672 0x081401e0 2008 -11-26 07 :38:28 UTC+0000 0x00000000019456e8 csrss.exe 592 360 0x08140040 2008 -11-15 23 :42:56 UTC+0000 ( \u7701\u7565 ) \u3000\u3000\u5982\u679c\u4e00\u4e2a\u8fdb\u7a0b\u6301\u7eed\u65f6\u95f4\u5f88\u77ed\uff0c\u6bd4\u5982ipconfig\u8fd9\u79cd\u53ef\u80fd\u53ea\u9700\u8981\u8fd0\u884c\u4e0d\u52302\u79d2\u5c31\u53ef\u4ee5\u9000\u51fa\u4e86\uff0c\u5728\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u90e8\u6d3b\u52a8\u8fdb\u7a0b\u8868\u4e2d\u4f60\u662f\u627e\u4e0d\u5230\u5b83\u7684\uff0c\u56e0\u4e3a\u4ed6\u4eec\u5728\u4f60\u6293\u5185\u5b58\u524d\u5c31\u7ec8\u6b62\u4e86\u3002\u4f46\u662f\u4f60\u4f7f\u7528\u6c60\u6807\u7b7e\u626b\u63cf\u662f\u53ef\u4ee5\u53d1\u73b0\u4ed6\u4eec\u7684(psscan\u5c31\u662f\u6c60\u6807\u7b7e\u5668)\u3002\u5177\u4f53\u7684\u5e94\u7528\u5c31\u662f\uff0c\u5047\u5982\u8fd9\u662f\u4e00\u53f0\u5185\u7f51\u8bbe\u5907\uff0c\u5982\u679c\u4f60\u53d1\u73b0\u5b58\u5728\u8fc7Ping\u6216\u8005ifconfig\u8fd9\u7c7b\u547d\u4ee4\uff0c\u90a3\u8bf4\u660e\u653b\u51fb\u8005\u53ef\u80fd\u5728\u8fd9\u53f0\u673a\u5668\u4e0a\u5bf9\u7f51\u6bb5\u8fdb\u884c\u4e86\u63cf\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e5f\u662f\u6c60\u626b\u63cf\u6280\u672f\u7ecf\u5e38\u5e94\u7528\u7684\u5730\u65b9\u3002\u540e\u9762\u6211\u4eec\u8fd8\u4f1a\u63a5\u89e6\u5230\u8fd0\u7528\u6c60\u626b\u63cf\u6280\u672f\u6765\u68c0\u6d4b\u5185\u6838\u7ea7\u522b\u7684rootkit\u3002","title":"Finding Terminated Processes (\u641c\u7d22\u7ec8\u6b62\u8fdb\u7a0b)"},{"location":"ram2/#limitations-of-pool-scanning","text":"\u867d\u8bf4\u4ed6\u662f\u4e2a\u5f88\u725b\u903c\u7684\u65b9\u5f0f\uff0c\u65e0\u9700\u501f\u52a9\u64cd\u4f5c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u626b\u63cf\u51fa\u5bf9\u8c61\uff0c\u4f46\u662f\u4ed6\u6709\u4e0b\u8ff0\u7684\u51e0\u4e2a\u9650\u5236\u6027\u3002","title":"Limitations of Pool Scanning (\u6c60\u626b\u63cf\u6280\u672f\u7684\u9650\u5236\u6027)"},{"location":"ram2/#non-mailcious-limitations","text":"\u4e0b\u9762\u8fd9\u51e0\u79cd\u60c5\u51b5\u53ef\u80fd\u4f1a\u88ab\u8bef\u5224\u4e3a\u662f\u5bf9\u8bc1\u636e\u7684\u6076\u610f\u7684\u7be1\u6539\uff1a \u3000\u30001. \u6ca1\u6807\u7b7e\u7684\u6c60\u5185\u5b58\uff1a\u867d\u7136\u5fae\u8f6f**\u63a8\u8350**\u4f7f\u7528 ExAllocatePoolWithTag \u6765\u8ba9\u9a71\u52a8\u548c\u5185\u6838\u6a21\u5f0f\u7684\u7ec4\u4ef6\u6765\u5206\u914d\u5185\u5b58\uff0c\u4f46\u662f\u8fd9\u5e76\u975e\u552f\u4e00\u7684\u65b9\u5f0f\uff0c\u4f7f\u7528 ExAllocatePool \u4e5f\u53ef\u4ee5\u5b9e\u73b0\uff0c\u53ea\u4e0d\u8fc7\u4ed6\u88ab\u5f03\u7528\u4e86\uff0c\u4f46\u5728\u5f88\u591awindows\u7248\u672c\u4e0a\u4ecd\u7136\u662f\u53ef\u7528\u7684\u3002\u8fd9\u79cd\u65b9\u5f0f\u5206\u914d\u7684\u5185\u5b58\u4e0d\u4f1a\u5e26tag\u6807\u7b7e\uff0c\u5bf9\u4f60\u7684\u67e5\u627e\u5de5\u4f5c\u4f1a\u9020\u6210\u56f0\u96be\u3002 \u3000\u30002. \u5047\u9633\u6027(False positives)\uff1a\u6c60\u626b\u63cf\u5668\u7684\u903b\u8f91\u6211\u4eec\u5df2\u7ecf\u770b\u8fc7\u4e86\uff0c\u5b9e\u8d28\u662f\u4e00\u4e2a\u57fa\u4e8e\u7ecf\u9a8c\u5224\u65ad\u7684\u542f\u53d1\u5f0f\u7b97\u6cd5\uff0c\u8bef\u62a5\u662f\u96be\u514d\u7684\u3002 \u3000\u30003. \u5927\u7684\u5185\u5b58\u5206\u914d\uff1a\u6c60\u6807\u7b7e\u626b\u63cf\u6280\u672f\u4e0d\u80fd\u626b\u63cf\u51fa\u8d85\u8fc74096\u5b57\u8282\u7684\u5206\u914d(\u540e\u9762\u4f1a\u63d0\u5230\"Big Page Pool\"\u5927\u9875\u6c60)\uff0c\u4e0d\u8fc7\u6240\u6709\u7684\u6267\u884c\u4f53\u5bf9\u8c61\u90fd\u6bd4\u5b83\u5c0f\u3002","title":"Non-mailcious Limitations (\u8bef\u5224)"},{"location":"ram2/#malicious-limitationsanti-forensics","text":"\u4e0b\u9762\u8fd9\u4e9b\u53cd\u53d6\u8bc1\u624b\u6bb5\u4e5f\u4f1a\u5bfc\u81f4\u6c60\u626b\u63cf\u7684\u8bef\u5224\uff1a \u3000\u30001. \u4efb\u610f\u6807\u7b7e\uff1a\u9a71\u52a8\u5728\u5206\u914d\u5185\u5b58\u65f6\u9ed8\u8ba4\u4f7f\u7528\u7684\u6807\u7b7e\u65f6\"Ddk \"(\u540e\u9762\u6709\u7a7a\u683c)\u3002\u5f53\u64cd\u4f5c\u7cfb\u7edf\u6216\u7b2c\u4e09\u65b9\u4ee3\u7801\u6ca1\u6709\u6307\u5b9a\u6807\u7b7e\u65f6\uff0c\u5c31\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u6807\u7b7e\u3002\u5982\u679c\u4e00\u4e2a\u6076\u610f\u9a71\u52a8\u4f7f\u7528\u4e86\"Ddk \"\u4f5c\u4e3a\u5b83\u4eec\u7684\u6807\u7b7e\uff0c\u5185\u5b58\u5757\u5c31\u4f1a\u548c\u5176\u4ed6\u5757\u6df7\u5408\u8d77\u6765\uff0c\u96be\u4ee5\u5206\u8fa8\u3002 \u3000\u30002. \u4f2a\u9020\u6807\u7b7e\uff1a \u8fd9\u7bc7\u6587\u7ae0 \u4e2d\u63d0\u51fa\uff0c\u9a71\u52a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u8868\u73b0\u7684\u5f88\u50cf\u4e00\u4e2a\u6b63\u5e38\u5bf9\u8c61\u7684\uff0c\u5e26\u6709\u5047\u6807\u7b7e\u7684\u5bf9\u8c61\u6765\u8bef\u5bfc\u53d6\u8bc1\u4eba\u5458\u3002 \u3000\u30003. \u88ab\u64cd\u7eb5\u7684\u6807\u7b7e\uff1a\u524d\u9762\u4e5f\u63d0\u5230\u4e86\uff0c \u5fae\u8f6f\u521b\u5efa\u6c60\u6807\u8bb0\u662f\u4e3a\u4e86\u8c03\u8bd5\u548c\u5ba1\u8ba1\u7684\u76ee\u7684 \uff0c\u5b83\u4eec\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u7684\u7a33\u5b9a\u6027\u5e76\u4e0d\u91cd\u8981\u3002\u4f46\u662f\u5185\u6838Rootkit\u53ef\u4ee5\u4fee\u6539\u6c60\u6807\u7b7e(\u6216\u8005_POOL_HEADER\u4e2d\u7684\u4efb\u4f55\u503c\uff0c\u6bd4\u5982\u5927\u5c0f\uff0c\u5185\u5b58\u7c7b\u578b\u7b49)\uff0c\u8fd9\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u6ca1\u4ec0\u4e48\u5f71\u54cd\uff0c\u4f46\u662f\u4f1a\u5f71\u54cdVolatility\u7684\u626b\u63cf\u7ed3\u679c\u3002 \u3000\u3000\u4f46\u662f\u5bf9\u4e8e\u8fd9\u4e9b\u9650\u5236\u4f60\u4e5f\u53ef\u4ee5\u5e94\u53d8\uff0c\u6bd4\u5982\u4f7f\u7528\u5176\u4ed6\u624b\u6bb5\u6765\u8fdb\u884c\u641c\u7d22\uff0c\u6c60\u626b\u63cf\u53ea\u662f\u5176\u4e2d\u7684\u4e00\u79cd\uff0c\u6216\u8005\u53ef\u4ee5\u501f\u52a9\u5176\u4ed6\u8bc1\u636e\u6587\u4ef6\uff0c\u6bd4\u5982\u68c0\u67e5\u6d41\u91cf\u5305\u6765\u786e\u5b9a\u662f\u5426\u53d1\u751f\u8fc7\u67d0\u4e00\u4e8b\u4ef6\u3002","title":"Malicious Limitations(Anti-Forensics) (\u53cd\u53d6\u8bc1\u7684\u9650\u5236)"},{"location":"ram2/#big-page-pool","text":"\u524d\u9762\u63d0\u8fc7\uff0cWindows\u5185\u6838\u4f1a\u5c1d\u8bd5\u5c06\u8fd1\u4f3c\u5927\u5c0f\u7684\u5206\u914d\u653e\u5728\u4e00\u8d77\uff0c\u4f46\u662f\u5982\u679c\u8bf7\u6c42\u5185\u5b58\u7684\u5927\u5c0f\u8d85\u8fc7\u4e86\u4e00\u4e2a\u9875\u7684\u5927\u5c0f(4096\u5b57\u8282\uff0c4KB)\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5757\u5c31\u4f1a\u7531\u4e00\u4e2a\u7279\u6b8a\u7684\u6c60\u6765\u5206\u914d --- \u5927\u9875\u6c60(Big Page Pool) \u5728\u4f7f\u7528\u5927\u9875\u6c60\u5206\u914d\u7684\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u662f\u4e0d\u5b58\u5728_POOL_HEADER\u7ed3\u6784\u7684\uff0c\u6240\u4ee5\u5403\u6807\u7b7e\u626b\u63cf\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a\u538b\u6839\u5c31\u6ca1\u6709\u6807\u7b7e\u3002\u4e0b\u56fe\u662f\u5c0f\u4e8e4096\u548c\u5927\u4e8e4096\u7684\u5185\u5b58\u7684\u5206\u7ed3\u6784\uff0c\u53ef\u4ee5\u770b\u5230\u4e8c\u8005\u533a\u522b\u5c31\u662f\u540e\u8005\u6ca1\u6709_POOL_HEADER\u5934\u4fe1\u606f\uff1a \u3000\u3000 \u3000\u3000\u4f46\u662f\u4f60\u53ea\u9700\u8981\u6362\u4e00\u4e2a\u89d2\u5ea6\u5c31\u53ef\u4ee5\u627e\u5230\u8fd9\u4e2a\u5355\u5143\u4e86\uff0c\u90a3\u5c31\u662f\u67e5\u770b\u5927\u9875\u8ddf\u8e2a\u8868(big page track tables)\uff0c\u5b83\u7684\u6761\u76ee\u4f1a\u76f4\u63a5\u6307\u5411\u5927\u9875\u6c60\u4e2d\u7684\u5bf9\u8c61\u3002","title":"Big Page Pool (\u5927\u9875\u6c60)"},{"location":"ram2/#big-page-track-tables","text":"\u5927\u9875\u8ddf\u8e2a\u8868\u548c\u4e0a\u9762\u63d0\u5230\u7684\u6c60\u8ddf\u8e2a\u8868\u662f\u6709\u533a\u522b\u7684\u3002\u6c60\u8ddf\u8e2a\u8868(PoolTrackTable)\u9002\u7528\u4e8e\u5c0f\u7684\u5185\u5b58\u5757(\u5c0f\u4e8e4096\u5b57\u8282)\uff0c\u5176\u4e2d\u50a8\u5b58\u7740\u7edf\u8ba1\u4fe1\u606f(\u5206\u914d\u6570\u91cf\u3001\u4f7f\u7528\u91cf\u7b49)\uff0c \u4f46\u662f\u5b83\u4e0d\u4f1a\u544a\u8bc9\u4f60\u6bcf\u4e00\u4e2a\u5206\u914d\u7684\u51c6\u786e\u7684\u5730\u5740\uff0c\u8fd9\u4e00\u70b9\u5728PoolTrackTable\u5c0f\u59d0\u63d0\u5230\u4e86\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u9700\u8981\u904d\u5386\u53bb\u626b\u63cf\u7684\u539f\u56e0 \u3002\u4f46\u662f\u5bf9\u4e8e\u5927\u9875\u8ddf\u8e2a\u8868\uff0c \u6070\u6070\u76f8\u53cd\uff0c\u5b83\u4e0d\u50a8\u5b58\u7edf\u8ba1\u4fe1\u606f\uff0c\u4f46\u662f\u5374\u5305\u542b\u4e86\u6bcf\u4e00\u4e2a\u5206\u914d\u7684\u5730\u5740 \uff0c\u5982\u679c\u4f60\u627e\u5230\u4e86\u5927\u9875\u8ddf\u8e2a\u8868\uff0c\u5c31\u76f8\u5f53\u4e8e\u4f60\u6709\u4e86\u4e00\u5f20\u5728\u5185\u6838\u5185\u5b58\u4e2d\u5b9a\u4f4d\u4efb\u4f55\u5927\u7684\u5206\u914d\u5757\u7684\u5730\u56fe\u3002 \u3000\u3000\u4e0d\u8fc7\uff0c\u5185\u6838\u7b26\u53f7 nt!PoolBigPageTable \u6307\u5411\u7684\u6570\u7ec4\u4e2d\uff0c\u867d\u7136\u50a8\u5b58\u4e86\u4e00\u4e9b _POOL_TRACKER_BIG_PAGES \u7684\u6570\u636e\u7ed3\u6784(\u6bcf\u4e00\u4e2a\u5bf9\u5e94\u7740\u4e00\u4e2a\u5927\u7684\u5206\u914d\u5757)\uff0c\u4f46\u662f\u5b83\u4eec\u4e0d\u4f1a\u88ab\u62f7\u8d1d\u6216\u5bfc\u51fa\u5230\u5185\u6838\u8c03\u8bd5\u6570\u636e\u5757(_KDDEBUGGER_DATA64)\u4e2d(\u4e0d\u50cfPoolTrackTable)\u3002\u4f46\u662f\uff0c\u4f60\u53ef\u4ee5\u5728nt!PoolTrackTable\u4e2d\u7684\u4e00\u4e2a\u53ef\u9884\u6d4b\u7684\u4f4d\u7f6e\u4e0a\u627e\u5230\u5b83\uff0c\u56e0\u4e3a\u8fd9\u90e8\u5206\u662f\u4f1a\u62f7\u8d1d\u5230\u5185\u6838\u8c03\u8bd5\u6570\u636e\u5757\u4e2d\u53bb\u7684\u3002\u4e0b\u9762\u7528volshell\u770b\u4e00\u4e0bwin7SP1x64\u4e2d\u5927\u9875\u8ffd\u8e2a\u8868\u7684\u6570\u636e\u7ed3\u6784\uff1a In [ 10 ] : dt ( \"_POOL_TRACKER_BIG_PAGES\" ) '_POOL_TRACKER_BIG_PAGES' ( 24 bytes ) 0x0 : Va [ 'pointer64' , [ 'void' ]] 0x8 : Key [ 'String' , { 'length' : 4 }] 0xc : PoolType [ 'Enumeration' , { 'target' : 'long' , 'choices' : { 0 : 'NonPagedPool' , 1 : 'PagedPool' , 2 : 'NonPagedPoolMustSucceed' , 3 : 'DontUseThisType' , 4 : 'NonPagedPoolCacheAligned' , 5 : 'PagedPoolCacheAligned' , 6 : 'NonPagedPoolCacheAlignedMustS' , 7 : 'MaxPoolType' , 34 : 'NonPagedPoolMustSucceedSession' , 35 : 'DontUseThisTypeSession' , 32 : 'NonPagedPoolSession' , 36 : 'NonPagedPoolCacheAlignedSession' , 33 : 'PagedPoolSession' , 38 : 'NonPagedPoolCacheAlignedMustSSession' , 37 : 'PagedPoolCacheAlignedSession' }}] 0x10 : NumberOfBytes [ 'unsigned long long' ] \u3000\u3000\u7b2c\u4e00\u4e2a\u53c2\u6570 Va \u662f*Virtual Address*\u7684\u7f29\u5199\uff0c\u5b83\u7684\u503c\u662f\u4e00\u4e2a\u6307\u5411\u5206\u914d\u5757\u7684\u57fa\u5740\u7684\u6307\u9488\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570 Key (4\u5b57\u8282\uff0c0xc-0x8)\u5c31\u662fpool tag\uff0c\u800c\u7b2c\u4e09\u4e2a\u53c2\u6570 PoolType \u5c31\u662f\u5185\u5b58\u7684\u7c7b\u578b(\u662f\u5426\u5206\u9875)\uff0c\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u662f\u5206\u914d\u7684\u5927\u5c0f\u3002 \u3000\u3000**\u6ce8\u610f\uff1a**\u867d\u7136\u5730\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662fpoolTag\uff0c\u4f46\u662f\u8fd9\u4e2a\u6807\u7b7e\u7684\u4f4d\u7f6e\u662fVa\u53c2\u6570\u6307\u5411\u7684\u4f4d\u7f6e\uff0c\u548c\u5206\u914d\u7684\u5730\u5740\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u3002\u800c\u5728\u5bf9\u4e8e\u5c0f\u7684\u5206\u914d(_POOL_TRACKER_TABLE)\uff0c\u5b83\u7684\u6807\u7b7e\u662f\u50a8\u5b58\u5728\u5206\u914d\u4e2d\u7684\u3002\u8fd9\u4e00\u70b9\u5f88\u597d\u7406\u89e3\uff0c\u4e0a\u9762\u7684\u5bf9\u6bd4\u56fe\u4e2d\u540e\u8005\u6ca1\u6709_POOL_HEADER\u5934\uff0c\u800ctag\u5c5e\u6027\u662f\u50a8\u5b58\u5728_POOL_HEADER\u4e2d\u7684(\u7ea2\u6846)\uff1a","title":"Big Page Track Tables (\u5927\u9875\u8ddf\u8e2a\u8868)"},{"location":"ram2/#bigpools-plugin","text":"\u4e3a\u4e86\u4ece\u5185\u5b58\u4e2d\u5f97\u5230\u751f\u6210\u5927\u7684\u5185\u6838\u6c60\u5206\u914d\u7684\u4fe1\u606f(\u4e0a\u8ff0\u7ed3\u6784\u4f53\u4fe1\u606f)\uff0cVolatility\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53eb bigpools \u7684\u63d2\u4ef6\uff0c\u4e0b\u9762\u662f\u90e8\u5206\u7ed3\u679c\uff1a $ volatility -f FLOAT-WIN7-20200130-110844.raw --profile Win7SP1x64 bigpools Volatility Foundation Volatility Framework 2 .6 Allocation Tag PoolType NumberOfBytes ------------------ -------- -------------------------- ------------- 0xfffff8a003c09000 CM25 PagedPool 0x1000L 0xfffff8a00458d000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a0007ee000 CM25 PagedPool 0x4000L 0xfffff8a004a4f000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a000cb0000 CM25 PagedPool 0x1000L 0xfffff8a004f11000 CM31 PagedPoolCacheAligned 0x1000L 0xfffffa8019cc2000 Cont NonPagedPool 0x1000L 0xfffff8a0053d3000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a005895000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a005d57000 CM31 PagedPoolCacheAligned 0x4000L 0xfffff8a006219000 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a005ce1000 CM31 PagedPoolCacheAligned 0x2000L 0xfffff8a001f42000 Obtb PagedPool 0x1000L 0xfffff8a0061a3000 CM31 PagedPoolCacheAligned 0x1000L ( \u7701\u7565 ) \u3000\u3000\u7b2c\u4e00\u5217\u544a\u8bc9\u4f60\u4e86\u5206\u914d\u7684\u5757\u7684\u8d77\u59cb\u5730\u5740\uff0c\u6700\u540e\u4e00\u5217\u662f\u5927\u5c0f(\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d)\uff0c\u77e5\u9053\u4e86\u8fd9\u4e24\u4e2a\u4fe1\u606f\uff0c\u4f60\u53ef\u4ee5\u5728volshell\u4e2d\u5bfc\u51fa\u8fd9\u90e8\u5206\u7684\u6570\u636e\uff0c\u6bd4\u5982\u6211\u67e5\u770b\u7b2c\u4e00\u9879\uff1a In [ 2 ] : db ( 0xfffff8a003c09000, length = 0x1000L ) 0xfffff8a003c09000 68 62 69 6e 00 50 23 00 00 10 00 00 00 00 00 00 hbin.P#......... 0xfffff8a003c09010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0xfffff8a003c09020 d8 ff ff ff 76 6b 0a 00 08 00 00 00 e8 4f 23 00 ....vk.......O#. 0xfffff8a003c09030 03 00 00 00 01 00 00 00 31 31 30 36 33 31 36 38 ........11063168 0xfffff8a003c09040 30 33 00 00 00 00 00 00 d8 ff ff ff 76 6b 0a 00 03 ..........vk.. 0xfffff8a003c09050 08 00 00 00 70 50 23 00 03 00 00 00 01 00 00 00 ....pP#......... 0xfffff8a003c09060 31 31 30 36 33 31 38 39 30 30 00 00 00 00 00 00 1106318900 ...... 0xfffff8a003c09070 f0 ff ff ff 00 00 70 00 00 00 00 00 00 00 00 00 ......p......... 0xfffff8a003c09080 e8 ff ff ff 78 4f 23 00 a0 4f 23 00 20 50 23 00 ....xO#..O#..P#. 0xfffff8a003c09090 48 50 23 00 00 00 00 00 e0 ff ff ff 76 6b 07 00 HP#.........vk.. 0xfffff8a003c090a0 08 00 00 00 68 4a 23 00 01 00 00 00 01 00 2d 00 ....hJ#.......-. 0xfffff8a003c090b0 53 65 72 76 69 63 65 00 d8 ff ff ff 76 6b 0c 00 Service.....vk.. 0xfffff8a003c090c0 14 00 00 00 70 52 23 00 07 00 00 00 01 00 30 00 ....pR#.......0. 0xfffff8a003c090d0 55 70 70 65 72 46 69 6c 74 65 72 73 31 00 30 00 UpperFilters1.0. 0xfffff8a003c090e0 d8 ff ff ff 76 6b 0f 00 4e 00 00 00 08 51 23 00 ....vk..N....Q#. 0xfffff8a003c090f0 01 00 00 00 01 00 41 00 44 72 69 76 65 72 50 61 ......A.DriverPa 0xfffff8a003c09100 63 6b 61 67 65 49 64 00 a8 ff ff ff 61 00 67 00 ckageId.....a.g. 0xfffff8a003c09110 70 00 2e 00 69 00 6e 00 66 00 5f 00 61 00 6d 00 p...i.n.f._.a.m. \u3000\u3000\u6211\u67e5\u770b\u7684\u8fd9\u5757\u7684\u6807\u7b7eCM25\uff0c\u4e4b\u524d\u8bf4\u8fc7CM\u7684\u610f\u601d\u5c31\u662fConfiguration Manager\u7684\u610f\u601d\uff0c\u8bf4\u660e\u8fd9\u5757\u662f\u5185\u6838\u4e2d\u6ce8\u518c\u8868\u7684\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u5176\u4e2d hbin \u548c vk \u5206\u522b\u4ee3\u8868\u6ce8\u518c\u8868HBIN\u5757\u7684\u7b7e\u540d\u548c\u4e00\u4e9b\u503c\u3002 \u3000\u3000\u6709\u4e00\u4e2a\u6bd4\u8f83\u6709\u610f\u601d\u7684\u5730\u65b9\uff0c\u4f5c\u8005\u63d0\u5230\u6839\u636e\u4ed6\u4eec\u7684\u7814\u7a76\uff0c\u5206\u914d\u57fa\u5740\u7684\u6700\u540e\u4e00\u4f4d16\u8fdb\u5236\u6570\u5982\u679c\u4e3a1\u7684\u8bdd\uff0c\u5c31\u8bf4\u660e\u8fd9\u5757\u5185\u5b58\u5df2\u7ecf\u88ab\u6807\u8bb0\u4e3a\u4e86free\u3002\u4e0b\u9762\u6211\u4e5f\u5b9e\u9a8c\u4e00\u4e0b\uff0c\u770b\u662f\u5426\u5982\u6b64\uff1a \u3000\u3000\u6211\u67e5\u770b\u4e0b\u8fd9\u51e0\u4e2a\u5757\uff1a 0xfffff8a001e1b001 CM31 PagedPoolCacheAligned 0x1000L 0xfffff8a002148001 CM31 PagedPoolCacheAligned 0x1000L \u3000\u3000 \u3000\u3000\u53ef\u4ee5\u770b\u5230\u6709\u4e00\u4e2a\u662f\u4e0d\u53ef\u8bfb\u7684\u72b6\u6001\uff0c\u800c\u53e6\u4e00\u4e2a\u8fd8\u662f\u53ef\u8bfb\u7684\uff0c\u4f5c\u8005\u7684\u89e3\u91ca\u662f\u4e0d\u53ef\u8bfb\u7684\u90a3\u4e00\u4e2a\u53ef\u80fd\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u63d0\u5230\u7684\uff0c\u6570\u636e\u6620\u5c04\u5230\u4e86\u78c1\u76d8\u4e0a\u7684\u4f8b\u5b50\uff0c\u56e0\u4e3a\u4ed6\u662f\u4f4d\u4e8e\u5206\u9875\u7684\u5185\u5b58\u3002\u800c\u53e6\u4e00\u4e2a\u5219\u5df2\u7ecf\u88ab\u91cd\u65b0\u5206\u914d\u5e76\u4e14\u91cd\u5199\u4e86\uff0c\u56e0\u4e3a\u5b83\u7684\u6570\u636e\u5df2\u7ecf\u6ca1\u6709 hbin \u8fd9\u4e2a\u6570\u5b57\u7b7e\u540d\u4e86\u3002","title":"Bigpools Plugin (\u5e94\u7528\u4e8e\u5927\u6c60\u626b\u63cf\u7684\u63d2\u4ef6)"},{"location":"ram2/#exploring-big-page-pools","text":"\u521a\u624d\u5f88\u591a\u547d\u4ee4\u7684\u7ed3\u679c\u90fd\u662f\u90e8\u5206\u7ed3\u679c\uff0c\u5728\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u5927\u9875\u6c60\u53ef\u80fd\u4f1a\u6709\u6210\u5343\u7684\u5206\u914d\u7ed3\u679c\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 --tags \u6765\u5e2e\u52a9\u4f60\u8fc7\u6ee4\uff0c\u518d\u7ed3\u5408\u4e00\u4e9b\u7ba1\u9053\u6765\u8fdb\u884c\u7b5b\u9009\uff0c\u6bd4\u5982\u505a\u4e00\u4e2a\u7b80\u5355\u7edf\u8ba1\uff1a $ awk '{print $2}' bigpools.txt | sort | uniq -c | sort -rn 9929 CM31 2753 CM25 1368 Cont 878 CMA? 322 CM53 183 MmRe 141 MmSt 123 Obtb 91 CM16 81 Ntf9 (\u7701\u7565) \u3000\u3000\u5982\u679c\u4f60\u5bf9windows\u5185\u6838\u6570\u636e\u7ed3\u6784\u8db3\u591f\u719f\u6089\u7684\u8bdd\uff0c\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5c31\u53ef\u4ee5\u5e2e\u52a9\u4f60\u8fdb\u884c\u6570\u636e\u5206\u6790\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u5f88\u591a\u7684\u8f6c\u6362\u8868\u3001\u5185\u5b58\u7ba1\u7406\u9875\u8868\u3001\u8bbf\u95ee\u8bb0\u5f55\u3001ASLR(Address Space Layout Randomization)\u7ec6\u8282\u7b49\u7b49\u4fe1\u606f\u3002","title":"Exploring Big Page Pools (\u6df1\u5165\u641c\u7d22\u5927\u9875\u6c60)"},{"location":"ram2/#pool-scanning-alternatives","text":"\u5230\u8fd9\u91cc\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u4e86\u5185\u5b58\u533a\u6b63\u4e2d\u7684\u6c60\u6807\u7b7e\u626b\u63cf(pool tag scanning)\u4f18\u70b9\u548c\u7f3a\u70b9\u4ee5\u53ca\u539f\u7406\u65b9\u6cd5\u4e86\uff0c\u4e0b\u9762\u8ba8\u8bba\u51e0\u4e2a\u5907\u7528\u65b9\u6848\u3002","title":"Pool-Scanning Alternatives (\u6c60\u626b\u63cf\u5907\u9009\u65b9\u6848)"},{"location":"ram2/#dispatcher-header-scans","text":"\u8bb8\u591a\u6267\u884c\u4f53\u5bf9\u8c61(\u5982\u8fdb\u7a0b\u3001\u7ebf\u7a0b\u3001\u4e92\u65a5\u9501)\u90fd\u662f\u53ef\u540c\u6b65\u7684\u3002\u8fd9\u610f\u5473\u7740\u5176\u4ed6\u7ebf\u7a0b\u53ef\u4ee5\u540c\u6b65\u3001\u6216\u7b49\u5f85\u8fd9\u4e9b\u5bf9\u8c61\u7684\u6267\u884c\u3001\u7ed3\u675f\u3001\u6216\u8005\u6267\u884c\u5176\u4ed6\u7c7b\u578b\u52a8\u4f5c\uff0c\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4f1a\u5c06\u4e00\u4e2a\u5bf9\u8c61\u7684\u5f53\u524d\u72b6\u6001\u50a8\u5b58\u5728\u4e00\u4e2a\u53eb _DISPATCHER_HEADER \u7684\u5b50\u7ed3\u6784(substructure)\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u6267\u884c\u4f53\u5bf9\u8c61\u7684\u5f00\u5934\u90fd\u4f1a\u6709\u8fd9\u4e2a\u5b50\u7ed3\u6784\u3002 \u3000\u3000\u6b64\u5916\u8fd9\u4e2a\u7ed3\u6784\u4f53\u5185\u8fd8\u5305\u542b\u7740\u4e00\u4e9b\u4e0ewindows\u7248\u672c\u6709\u5173\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u5e2e\u52a9\u4f60\u786e\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u7684profile\u503c\u3002\u66f4\u591a\u5173\u4e8e\u8c03\u5ea6\u5668\u5934\u90e8\u4fe1\u606f\u5728\u5185\u5b58\u53d6\u8bc1\u53d6\u8bc1\u4e2d\u7684\u7528\u9014\uff0c\u53c2\u8003 Searching for Processes and Threads in Microsoft Windows Memory Dumps \u3000\u3000\u4e0b\u9762\u662fvolshell\u4e2d\u67e5\u770bWin7SP1x64\u4e2d _DISPATCHER_HEADER \u7684\u7ed3\u679c\uff1a In [ 1 ] : dt ( \"_DISPATCHER_HEADER\" ) '_DISPATCHER_HEADER' ( 24 bytes ) 0x0 : Lock [ 'long' ] 0x0 : Type [ 'unsigned char' ] 0x1 : Abandoned [ 'unsigned char' ] 0x1 : Absolute [ 'BitField' , { 'end_bit' : 1 , 'start_bit' : 0 , 'native_type' : 'unsigned char' }] 0x1 : Coalescable [ 'BitField' , { 'end_bit' : 2 , 'start_bit' : 1 , 'native_type' : 'unsigned char' }] 0x1 : EncodedTolerableDelay [ 'BitField' , { 'end_bit' : 8 , 'start_bit' : 3 , 'native_type' : 'unsigned char' }] 0x1 : KeepShifting [ 'BitField' , { 'end_bit' : 3 , 'start_bit' : 2 , 'native_type' : 'unsigned char' }] 0x1 : Signalling [ 'unsigned char' ] 0x1 : TimerControlFlags [ 'unsigned char' ] 0x2 : CounterProfiling [ 'BitField' , { 'end_bit' : 3 , 'start_bit' : 2 , 'native_type' : 'unsigned char' }] 0x2 : CpuThrottled [ 'BitField' , { 'end_bit' : 1 , 'start_bit' : 0 , 'native_type' : 'unsigned char' }] 0x2 : CycleProfiling [ 'BitField' , { 'end_bit' : 2 , 'start_bit' : 1 , 'native_type' : 'unsigned char' }] 0x2 : Hand [ 'unsigned char' ] 0x2 : Reserved [ 'BitField' , { 'end_bit' : 8 , 'start_bit' : 3 , 'native_type' : 'unsigned char' }] 0x2 : Size [ 'unsigned char' ] 0x2 : ThreadControlFlags [ 'unsigned char' ] 0x3 : ActiveDR7 [ 'BitField' , { 'end_bit' : 1 , 'start_bit' : 0 , 'native_type' : 'unsigned char' }] 0x3 : DebugActive [ 'unsigned char' ] 0x3 : DpcActive [ 'unsigned char' ] 0x3 : Expired [ 'BitField' , { 'end_bit' : 8 , 'start_bit' : 7 , 'native_type' : 'unsigned char' }] 0x3 : Index [ 'BitField' , { 'end_bit' : 6 , 'start_bit' : 0 , 'native_type' : 'unsigned char' }] 0x3 : Inserted [ 'BitField' , { 'end_bit' : 7 , 'start_bit' : 6 , 'native_type' : 'unsigned char' }] 0x3 : Instrumented [ 'BitField' , { 'end_bit' : 2 , 'start_bit' : 1 , 'native_type' : 'unsigned char' }] 0x3 : Reserved2 [ 'BitField' , { 'end_bit' : 6 , 'start_bit' : 2 , 'native_type' : 'unsigned char' }] 0x3 : TimerMiscFlags [ 'unsigned char' ] 0x3 : UmsPrimary [ 'BitField' , { 'end_bit' : 8 , 'start_bit' : 7 , 'native_type' : 'unsigned char' }] 0x3 : UmsScheduled [ 'BitField' , { 'end_bit' : 7 , 'start_bit' : 6 , 'native_type' : 'unsigned char' }] 0x4 : SignalState [ 'long' ] 0x8 : WaitListHead [ '_LIST_ENTRY' ] \u4f5c\u8005\u6307\u51fa\uff0c\u5bf9\u4e8eAbsolute\u548cInserted\u8fd9\u4e24\u4e2a\u53d8\u91cf\uff0c\u5728win2K,2k3,XP\u4e2d\u90fd\u662f0\uff0c\u800cType\u548cSize\u53d8\u91cf\u90fd\u662f\u786c\u7f16\u7801\u7684\u5f62\u5f0f\u5199\u6b7b\u4e86\u5bf9\u8c61\u7684\u7c7b\u578b\u548c\u5927\u5c0f\uff0c\u6bd4\u5982WinXPx32\uff0cType\u53d8\u91cf\u503c\u4e3a3\u4ee3\u8868\u8fdb\u7a0b\uff0c\u5bf9\u5e94\u5927\u5c0f\u4e3a0x1b\uff0c\u56db\u5b57\u8282\u7b7e\u540d\u4e3a\\x03\\x00\\x1b\\x00\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u7b7e\u540d\uff0c\u4ee5\u7c7b\u4f3c\u6c60tag\u626b\u63cf\u7684\u65b9\u5f0f\u8fdb\u884c\u626b\u63cf\uff0c\u8fd9\u4e5f\u662f\u65e9\u671f\u5185\u5b58\u53d6\u8bc1\u7684\u4e00\u6b3e\u540d\u4e3aPTFinder\u7684\u5de5\u5177\u5de5\u4f5c\u539f\u7406\u3002 \u4f46\u662f\u8c03\u5ea6\u5668\u5934\u626b\u63cf\u7684\u65b9\u6cd5\u53ea\u80fd\u626b\u63cf\u5230\u540c\u6b65\u4e86\u7684\u5bf9\u8c61\uff0c\u5047\u5982\u4e00\u4e2a\u5bf9\u8c61\u6ca1\u6709\u8fdb\u884c\u540c\u6b65\uff0c\u90a3\u4e48\u5b83\u5c31\u6ca1\u6709 _DISPATCHER_HEADER \u8fd9\u4e2a\u5934\u90e8\u4fe1\u606f\uff0c\u8fd9\u6837\u4f60\u5c31\u4e0d\u80fd\u627e\u5230 _FILE_OBJECT \u7c7b\u578b\u7684\u5b9e\u4f8b\u4e86\u3002 \u3000\u3000\u8fd9\u4e2a\u65b9\u6cd5\u53ea\u4f5c\u4e3a\u4ecb\u7ecd\uff0c\u6ca1\u6709\u592a\u5927\u5b9e\u8df5\u4ef7\u503c\uff0cVolatility\u4e2d\u7684pspdispscan\u63d2\u4ef6\u5c31\u662f\u5bf9\u5e94\u8fd9\u4e2a\u65b9\u6cd5(2.6\u7248\u672c\u4e2d\u5df2\u7ecf\u53bb\u6389\u4e86\uff0c\u4f5c\u4e3a\u4e00\u4e2aPOC)\uff0c\u4f46\u53ea\u9650\u4e8e32\u4f4dWindowsXP\u3002","title":"Dispatcher Header Scans (\u8c03\u5ea6\u5668\u5934\u90e8\u626b\u63cf)"},{"location":"ram2/#robust-signature-scans","text":"\u6c60\u5934\u90e8\u4fe1\u606f\u548c\u8c03\u5ea6\u5668\u5934\u90e8\u4fe1\u606f\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u6765\u8bf4\u90fd\u662f\u4e0d\u91cd\u8981\u7684\uff0c\u6240\u4ee5\u6076\u610f\u7684\u4fee\u6539\u5b83\u4eec\u53ef\u4ee5\u9003\u8fc7\u57fa\u4e8e\u6807\u7b7e\u7684\u626b\u63cf\u65b9\u6cd5\uff0c\u540c\u65f6\u4e0d\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u9020\u6210\u5f71\u54cd\u3002\u6240\u4ee5\u6709\u53e6\u4e00\u4e2a\u5bf9\u6297\u8fd9\u79cd\u6076\u610f\u4fee\u6539\u7684\u641c\u7d22\u5bf9\u8c61\u7684\u624b\u6bb5\uff0c\u8be6\u7ec6\u63cf\u8ff0\u5728\u8fd9\u7bc7\u6587\u7ae0\uff1a Robust Signatures for Kernel Data Structures \u3002\u5927\u6982\u5c31\u662f\u7814\u7a76\u8981\u67e5\u627e\u7684\u7ed3\u6784\u4f53\u4e2d\uff0c\u90a3\u4e9b\u4fe1\u606f\u7684\u4fee\u6539\u4f1a\u5bfc\u81f4\u64cd\u4f5c\u7cfb\u7edf\u7684\u5d29\u6e83\uff0c\u518d\u4f9d\u636e\u8fd9\u4e9b\u4fe1\u606f\u6765\u8fdb\u884c\u641c\u7d22\uff0c\u8fd9\u6837\u654c\u624b\u5c31\u4e0d\u80fd\u968f\u610f\u4fee\u6539\u4e86\u3002\u8fd9\u5bf9\u4e8e\u641c\u7d22\u88ab\u5185\u6838\u7ea7\u522b\u7684rootkit\u9690\u85cf\u7684\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u6709\u53c2\u8003\u4ef7\u503c\u3002 \u3000\u3000\u5728Volatility 1.3\u7248\u672c\u4e2d\u53ef\u4ee5\u4f7f\u7528 psscan3 \u63d2\u4ef6\u8fdb\u884c\u589e\u5f3a\u578b\u7684\u7b7e\u540d\u626b\u63cf\uff0c\uff0c\u4f46\u662f\u6700\u65b0\u7248\u672c\u4e2d\u4e0d\u5305\u542b\u8be5\u63d2\u4ef6\u3002\u53ef\u4ee5\u81ea\u884c\u5728\u8fd9\u91cc\u4e0b\u8f7d psscan3","title":"Robust Signature Scans (\u589e\u5f3a\u578b\u7b7e\u540d\u626b\u63cf)"},{"location":"ram2/#summary","text":"\u672c\u7bc7\u4e3b\u8981\u8ba8\u8bba\u7684\u662fwindows\u5bf9\u8c61\u7ba1\u7406\u5668(Windows Object Manager)\u5728\u521b\u5efa\u548c\u5220\u9664\u4e00\u4e9b\u4e3b\u8981\u7c7b\u578b\u5bf9\u8c61(\u8fdb\u7a0b\u3001\u6587\u4ef6\u3001\u6ce8\u518c\u8868\u952e\u503c\u7b49)\u65f6\u7684\u4f5c\u7528\uff0c\u8fd9\u4e9b\u90fd\u662f\u53d6\u8bc1\u65f6\u8981\u4f9d\u8d56\u7684\u5bf9\u8c61\u3002 \u3000\u3000\u672c\u7bc7\u4e3b\u8981\u5b66\u4e60\u4e86\u5177\u4f53Volatility\u5728\u5b9e\u73b0\u641c\u7d22\u8fd9\u4e9b\u5bf9\u8c61\u65f6\u4f7f\u7528\u7684\u65b9\u5f0f\u4ee5\u53ca\u539f\u7406\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u770b\u5230\uff0c\u867d\u7136\u5bf9\u5185\u5b58\u6587\u4ef6\u53ca\u9006\u884c\u5168\u5c40\u7684\u7206\u7834\u641c\u7d22\u5f88\u6709\u6548\uff0c\u4f46\u662f\u4e5f\u5bb9\u6613\u8bef\u5224\uff0c\u56e0\u4e3a\u4f7f\u7528\u7684\u65b9\u6cd5(\u6c60\u6807\u7b7e\u626b\u63cf)\u4f9d\u8d56\u7684\u6570\u636e\u654c\u624b\u4e5f\u53ef\u4ee5\u4f2a\u9020\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u4e86\u89e3\u626b\u63cf\u6280\u672f\u5230\u5e95\u600e\u4e48\u5de5\u4f5c\u7684\u3001\u653b\u51fb\u8005\u662f\u5982\u4f55\u907f\u5f00\u8fd9\u4e9b\u626b\u63cf\u624b\u6bb5\u7684\uff0c\u8fd9\u4e5f\u662f\u672c\u7bc7\u4e3b\u8981\u5b66\u4e60\u7684\u5185\u5bb9\u3002\u6b64\u5916\uff0c\u5728\u5f97\u51fa\u7ed3\u8bba\u4e4b\u524d\uff0c\u4f60\u5e94\u8be5\u4e60\u60ef\u4e8e\u7ed3\u5408\u591a\u79cd\u8bc1\u636e\u6765\u6e90\u6765\u7efc\u5408\u5224\u65ad\u3002","title":"Summary \u603b\u7ed3"},{"location":"ram2/#_4","text":"Windbg\u4e0b\u8f7d\u5730\u5740 \u5229\u7528Volatility\u8fdb\u884cWindows\u5185\u5b58\u53d6\u8bc1\u5206\u6790(\u4e00)\uff1a\u521d\u4f53\u9a8c \u5229\u7528Volatility\u8fdb\u884cWindows\u5185\u5b58\u53d6\u8bc1\u5206\u6790(\u4e8c)\uff1a\u5185\u6838\u5bf9\u8c61\u3001\u5185\u6838\u6c60\u5b66\u4e60\u5c0f\u8bb0 win10\u4e2d\u201cwindbg+vmware+win7\u53cc\u673a\u8c03\u8bd5\u201d\u8bbe\u7f6e ExAllocatePool\u548cExAllocatePoolWithTag\u7684\u533a\u522b","title":"\u53c2\u8003\u5b66\u4e60\u94fe\u63a5"},{"location":"win/","text":"Windows Analysis \u00b6 \u4e0e\u6316\u6398Linux\u670d\u52a1\u5668\u955c\u50cf\u4e2d\u7684\u7f51\u7edc\u884c\u4e3a\u4fe1\u606f\u4e0d\u540c\uff0c\u53d6\u8bc1\u6bd4\u8d5b\u4e2d\u5bf9\u4e8eWindows\u955c\u50cf\u7684\u8003\u67e5\u4e3b\u8981\u4f53\u73b0\u5728\u4f7f\u7528\u75d5\u8ff9\u4e0e\u6587\u4ef6\u4e0a\uff0c\u6bd4\u5982\u8f6f\u4ef6\u4f7f\u7528\u8bb0\u5f55\uff0c\u6d4f\u89c8\u5668\u5386\u53f2\u8bb0\u5f55\uff0c\u75c5\u6bd2\u6837\u672c\u6587\u4ef6\uff0c\u4ee5\u53ca\u722c\u53d6\u7684\u8868\u5355\u8bdd\u5355\u7b49\u3002 \u56e0\u6b64\u53d6\u8bc1\u5de5\u4f5c\u8005\u8981\u719f\u7ec3\u5730\u638c\u63e1\u6587\u4ef6\u63d0\u53d6\u3001\u6570\u636e\u6062\u590d\u3001\u7cfb\u7edf\u4eff\u771f\u3001\u8be6\u5355\u5206\u6790\u3001\u7f16\u7a0b\u4e0e\u9006\u5411\u5de5\u7a0b\u7b49\u77e5\u8bc6\u4e0e\u6280\u672f\u624b\u6bb5\u3002 \u78c1\u76d8\u7ed3\u6784 \u00b6 \u4ece\u7269\u7406\u5c42\u9762\uff0c\u4e00\u4e2a\u78c1\u76d8\u6309\u5c42\u6b21\u5206\u4e3a \uff1a \u78c1\u76d8\u7ec4\u5408 \u2192 \u5355\u4e2a\u78c1\u76d8 \u2192 \u67d0\u4e00\u76d8\u9762 \uff08platter\uff09\u2192 \u67d0\u4e00\u78c1\u9053 \uff08track\uff09\u2192 \u67d0\u4e00\u6247\u533a\uff08sector\uff09 \u5173\u4e8e\u7c07\u548c\u6247\u533a\uff1a \u6587\u4ef6\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u65f6\uff0c\u57fa\u672c\u5355\u4f4d\u4e0d\u662f\u5b57\u8282\u800c\u662f\u7c07\u3002\u7c07\u7684\u5927\u5c0f\u4e0e\u78c1\u76d8\u7684\u89c4\u683c\u6709\u5173\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8f6f\u76d8\u6bcf\u7c07\u662f1\u4e2a\u6247\u533a\uff0c\u786c\u76d8\u6bcf\u7c07\u7684\u6247\u533a\u6570\u4e0e\u786c\u76d8\u7684\u603b\u5bb9\u91cf\u5927\u5c0f\u6709\u5173\uff0c\u53ef\u80fd\u662f4\u30018\u300116\u300132\u300164\u2026\u2026 Windows\u6587\u4ef6\u7cfb\u7edf\uff1a \u901a\u5e38\u5728Windows\u5e73\u53f0\u4e0b\u4f7f\u7528\u76843\u79cd\u6587\u4ef6\u7cfb\u7edf\u662fFAT\uff08\u6587\u4ef6\u5206\u533a\u8868\uff09\uff0cFAT32\uff0832\u4f4d\u6587\u4ef6\u5206\u533a\u8868\uff09\u548cNTFS\uff08NT\u6587\u4ef6\u7cfb\u7edf\uff09\u3002 \u5728FAT\u6587\u4ef6\u7cfb\u7edf\u4e0b\uff0c\u6bcf\u4e00\u4e2a\u78c1\u76d8\u88ab\u5206\u6210\u56fa\u5b9a\u5927\u5c0f\u7684\u7c07\u3002\u7c07\u6700\u5c11\u4e3a512\u4e2a\u5b57\u8282\uff0c\u5176\u5927\u5c0f\u53ef\u4ee5\u6210\u500d\u589e\u957f\uff0c\u6700\u5927\u4e3a32K\u3002\u6bcf\u4e2a\u7c07\u90fd\u662f\u7531\u552f\u4e00\u7684\u7d22\u5f15\u53f7\u2014\u2014\u4e00\u4e2a16\u4f4d\u4e8c\u8fdb\u5236\u6570\u6765\u6807\u8bc6\u3002\u56e0\u4e3a16\u4f4d\u4e8c\u8fdb\u5236\u6570\u6700\u5927\u4e3a65536\uff0c\u6240\u4ee5FAT\u5206\u533a\u6240\u62e5\u6709\u7684\u7c07\u7684\u6570\u91cf\u4e0d\u53ef\u80fd\u8d85\u8fc765536\u4e2a\u3002 FAT32\u6587\u4ef6\u7684\u539f\u7406\u51e0\u4e4e\u4e0e\u6b64\u76f8\u540c\uff0c\u4f46\u5b83\u7684\u7c07\u66f4\u5c0f\uff0c\u800c\u4e14\u7531\u4e8eFAT32\u5165\u53e3\u662f32\u4f4d\uff0c\u6240\u4ee5\u5176\u5bb9\u91cf\u7406\u8bba\u4e0a\u53ef\u4ee5\u8d85\u8fc740\u4ebf\u4e2a\u5b57\u8282\u3002 NTFS\u662f\u4e00\u4e2a\u76f8\u5f53\u9ad8\u7ea7\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u5b83\u7684\u4e3b\u6587\u4ef6\u8868\uff08MFT\uff09\u662f\u4e00\u4e2a\u975e\u5e38\u5b8c\u6574\u7684\u6570\u636e\u5e93\uff0c\u5b83\u8d1f\u8d23\u5bf9\u78c1\u76d8\u4e0a\u7684\u6bcf\u4e2a\u6587\u4ef6\u8fdb\u884c\u7d22\u5f15\u3002\u6bcf\u4e2aMFT\u7684\u5165\u53e3\u901a\u5e38\u4e3a1K\u5927\u5c0f\uff0c\u5176\u4e2d\u8bb0\u5f55\u4e86\u5927\u91cf\u7684\u6587\u4ef6\u4fe1\u606f\u3002NTFS\u53ef\u4ee5\u5728\u6587\u4ef6\u7684MFT\u5165\u53e3\u4e2d\u5b58\u50a8\u975e\u5e38\u5c0f\u7684\u6587\u4ef6\u7684\u5168\u90e8\u5185\u5bb9\uff1b\u5bf9\u4e8e\u5927\u4e00\u4e9b\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u5165\u53e3\u4f1a\u6807\u8bc6\u51fa\u5305\u542b\u6587\u4ef6\u6570\u636e\u7684\u7c07\u3002 \u4fe1\u606f\u63d0\u53d6\u4e0e\u5206\u6790 \u00b6 \u63a8\u8350\u4f7f\u7528\u7684\u6709\u4e24\u79cd\u8f6f\u4ef6\uff1a\u7f8e\u4e9a\u7684\u53d6\u8bc1\u5927\u5e08\u548c\u5f18\u8fde\u7684\u8bc1\u636e\u5206\u6790\u8f6f\u4ef6\u3002 \u4e8c\u8005\u5404\u6709\u5404\u7684\u4f18\u7f3a\u70b9\uff0c\u53d6\u8bc1\u5927\u5e08\u4e3b\u8981\u4f53\u73b0\u5728\u5e7f\u5ea6\uff0c\u529f\u80fd\u975e\u5e38\u9f50\u5168\u3002\u5728\u81ea\u52a8\u53d6\u8bc1\u7ed3\u679c\u4e2d\u80fd\u591f\u76f4\u63a5\u63d0\u4f9b\u5f88\u591a\u6709\u7528\u7684\u4fe1\u606f\uff08\u5982\u65f6\u95f4\u7ebf\uff0c\u8f6f\u4ef6\u4f7f\u7528\u75d5\u8ff9\u7b49\uff09\uff0c\u7701\u53bb\u5f88\u591a\u9ebb\u70e6\u300219\u5e74\u589e\u52a0\u5c0f\u7a0b\u5e8f\u677f\u5757\u540e\uff0c\u529f\u80fd\u7684\u6269\u5c55\u6027\u4e5f\u6781\u597d\uff0c\u80fd\u591f\u8c03\u7528python\u7b49\u811a\u672c\u53bb\u505a\u65e5\u5fd7\u5206\u6790\u7b49\uff0c\u8fd8\u63d0\u4f9b\u4e86\u5305\u62ec\u5982\u6b63\u5219\u8868\u8fbe\u5f0f\u5728\u5185\u7684\u5339\u914d\u65b9\u6cd5\uff0c\u7b5b\u9009\u529f\u80fd\u5f3a\u5927\u3002 \u706b\u773c\u8bc1\u636e\u5206\u6790\u8f6f\u4ef6\u8865\u5145\u4e86\u53d6\u8bc1\u5927\u5e08\u5728\u5904\u7406\u6570\u636e\u5e93\u548c\u5907\u4efd\u6587\u4ef6\u4e0a\u7684\u7f3a\u9677\u3002\u4e0d\u4ec5\u80fd\u591f\u5bf9SQL\u6570\u636e\u5e93\u8fdb\u884c\u76f4\u63a5\u9884\u89c8\u548c\u5904\u7406\uff0c\u800c\u4e14\u80fd\u5c06PC\u4e2d\u7684iOS\u4e0eAndroid\u5907\u4efd\u6587\u4ef6\u4f5c\u4e3a\u8bc1\u636e\u6587\u4ef6\uff0c\u518d\u6b21\u8fdb\u884c\u53d6\u8bc1\u5206\u6790\uff0c\u751a\u81f3\u5c06\u624b\u673a\u4e2d\u7684\u5fae\u4fe1\u8bb0\u5f55\u7b49\u7ec6\u8282\u76f4\u89c2\u7684\u6295\u5230\u5c4f\u5e55\uff0c\u5728\u9047\u5230PC+\u624b\u673a\u5907\u4efd\u7684\u60c5\u51b5\u4e0b\u8f83\u4e3a\u5b9e\u7528\u3002 \u7cfb\u7edf\u4eff\u771f \u00b6 \u7cfb\u7edf\u4eff\u771f\u662f\u6307\u5c06\u955c\u50cf\u6587\u4ef6\u6216\u8005\u5bf9\u8c61\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u786c\u76d8\u6a21\u62df\u4e3a\u865a\u62df\u673a\uff0c\u5728\u865a\u62df\u673a\u73af\u5883\u4e0b\u8fdb\u884c\u542f\u52a8\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ee5\u4ea4\u4e92\u7684\u65b9\u5f0f\u548c\u7cfb\u7edf\u7528\u6237\u7684\u89d2\u5ea6\u76f4\u89c2\u7684\u68c0\u67e5\u548c\u64cd\u4f5c\u76ee\u6807\u7cfb\u7edf\uff0c\u67e5\u770b\u76f8\u5173\u4fe1\u606f\u3002 \u76ee\u524d\u63a8\u8350\u4f7f\u7528\u7684\u8f6f\u4ef6\u5de5\u5177\u662f\u5f18\u8fde\u7684\u706b\u773c\u4eff\u771f\u8f6f\u4ef6\uff0c\u80fd\u65b9\u4fbf\u5730\u5b9e\u73b0\u9501\u5b9a\u7cfb\u7edf\u7248\u672c\u548c\u7ed5\u8fc7\u5f00\u673a\u5bc6\u7801\uff0c\u5e76\u8c03\u7528\u672c\u673a\u7684VMware\u865a\u62df\u673a\u5b9e\u73b0\u4eff\u771f\uff0c\u5982\u4e0b\uff1a \u77e5\u8bc6\u6574\u7406\uff08\u6301\u7eed\u5b8c\u5584\u4e2d\uff09 \u00b6 \u78c1\u76d8\u5bb9\u91cf \u00b6 \u9996\u5148\u9700\u8981\u7406\u89e3 4K\u5bf9\u9f50 \u7684\u539f\u7406\u3002 \u7535\u8111\u4f20\u7edf\u673a\u68b0\u786c\u76d8\u7684\u6bcf\u4e2a\u6247\u533a\u4e00\u822c\u5927\u5c0f\u4e3a512\u4e2a\u5b57\u8282\uff0c\u7136\u800c\u968f\u7740\u65f6\u4ee3\u53d1\u5c55\uff0c\u786c\u76d8\u5bb9\u91cf\u4e0d\u65ad\u6269\u5c55\uff0c\u4e8e\u662f\u5c06\u6bcf\u4e2a\u6247\u533a512\u5b57\u8282\u6539\u4e3a\u6bcf\u4e2a\u6247\u533a4096\u4e2a\u5b57\u8282\uff0c\u4e5f\u5c31\u662f\u73b0\u5728\u5e38\u8bf4\u7684\u201c4K\u6247\u533a\u201d\u3002 \u968f\u7740NTFS\u6210\u4e3a\u4e86\u6807\u51c6\u7684\u786c\u76d8\u6587\u4ef6\u7cfb\u7edf\uff0c\u5176\u6587\u4ef6\u7cfb\u7edf\u7684\u9ed8\u8ba4\u5206\u914d\u5355\u5143\u5927\u5c0f\uff08\u7c07\uff09\u4e5f\u662f4096\u5b57\u8282\uff0c\u4e3a\u4e86\u4f7f\u7c07\u4e0e\u6247\u533a\u76f8\u5bf9\u5e94\uff0c\u5373\u4f7f\u7269\u7406\u786c\u76d8\u5206\u533a\u4e0e\u8ba1\u7b97\u673a\u4f7f\u7528\u7684\u903b\u8f91\u5206\u533a\u5bf9\u9f50\uff0c\u4fdd\u8bc1\u786c\u76d8\u8bfb\u5199\u6548\u7387\uff0c\u6240\u4ee5\u5c31\u6709\u4e86\u201c4K\u5bf9\u9f50\u201d\u7684\u6982\u5ff5\u3002 \u4f8b\uff082019\u7f8e\u4e9a\u676f\u4e2a\u4eba4\uff09 \u901a\u8fc7\u53d6\u8bc1\u5927\u5e08\u67e5\u770b\uff1a \u5f97\u77e5D\u76d8\u4e3a\u7cfb\u7edf\uff08OS\uff09\u76d8\uff0c\u6247\u533a\u6570\u4e3a 961099776 \u518d\u6b21\u786e\u8ba4\u903b\u8f91\u6247\u533a\u7684\u5927\u5c0f\u4e3a 512 \u5b57\u8282\uff0c\u6545\u9700\u8981\u7a7a\u51fa4096/512= 8 \u4e2a\u6247\u533a\u7684\u7a7a\u95f4\uff0c\u5373: (961099776 - 8) * 512 = 492,083,081,216 \u65f6\u95f4\u6233 \u00b6 \u7531\u4e8e\u5728\u6570\u636e\u5e93\u7b49\u4fe1\u606f\u50a8\u5b58\u4ecb\u8d28\u4e2d\uff0c\u7ecf\u5e38\u4f7f\u7528 \u65f6\u95f4\u6233(timestamp) \u6765\u8bb0\u5f55\u65f6\u95f4\u4fe1\u606f\uff0c\u9700\u8981\u7406\u89e3\u5e76\u80fd\u591f\u628a\u5b83\u4e0e\u6807\u51c6\u65f6\u95f4\u8fdb\u884c\u4e92\u76f8\u8f6c\u6362\u3002 \u4f8b\uff082019\u7f8e\u4e9a\u676f\u4e2a\u4eba41\uff09 \u5229\u7528\u53d6\u8bc1\u5927\u5e08\u5f97\u5230\u4e0a\u4f20\u7684\u6807\u51c6\u65f6\u95f4\uff08\u5e74-\u6708-\u65e5 \u65f6:\u5206:\u79d2\uff092019-10-31 15:22:31 \u6700\u540e\u4f7f\u7528Python\u5e93\u51fd\u6570\u8f6c\u6362\u4e3a\u65f6\u95f4\u6233\uff0c\u9644\u4ee3\u7801\uff1a '''\u6807\u51c6\u65f6\u95f4\u5230\u65f6\u95f4\u6233''' import time a = time_str timeArray = time.strptime(a,\"%Y-%m-%d %H:%M:%S\") timeStamp = int(time.mktime(timeArray)) '''\u65f6\u95f4\u6233\u5230\u6807\u51c6\u65f6\u95f4''' import time timeArray = time.localtime(timeStamp) otherStyleTime = time.strftime(\"%Y-%m-%d %H:%M:%S\", timeArray) \u6d4b\u8bd5\uff1a \u52a8\u6001\u94fe\u63a5\u5e93 \u00b6 \u4f8b\uff082019\u7f8e\u4e9a\u676f\u4e2a\u4eba15\uff09 \u60f3\u5728\u955c\u50cf\u6587\u4ef6\u4e2d\u627e\u5230\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u8c03\u7528\u60c5\u51b5\u53ef\u80fd\u6bd4\u8f83\u56f0\u96be\uff0c\u4e0d\u59a8\u6362\u4e2a\u601d\u8def\u3002 \u5229\u7528\u53d6\u8bc1\u5927\u5e08\u63d0\u53d6\u51fa\u8be5exe\u7a0b\u5e8f\u540e\u5728\u672c\u5730\u8fd0\u884c\uff0c\u518d\u5229\u7528\u706b\u7ed2\u5251\u67e5\u770b\u5373\u53ef\u3002","title":"Windows"},{"location":"win/#windows-analysis","text":"\u4e0e\u6316\u6398Linux\u670d\u52a1\u5668\u955c\u50cf\u4e2d\u7684\u7f51\u7edc\u884c\u4e3a\u4fe1\u606f\u4e0d\u540c\uff0c\u53d6\u8bc1\u6bd4\u8d5b\u4e2d\u5bf9\u4e8eWindows\u955c\u50cf\u7684\u8003\u67e5\u4e3b\u8981\u4f53\u73b0\u5728\u4f7f\u7528\u75d5\u8ff9\u4e0e\u6587\u4ef6\u4e0a\uff0c\u6bd4\u5982\u8f6f\u4ef6\u4f7f\u7528\u8bb0\u5f55\uff0c\u6d4f\u89c8\u5668\u5386\u53f2\u8bb0\u5f55\uff0c\u75c5\u6bd2\u6837\u672c\u6587\u4ef6\uff0c\u4ee5\u53ca\u722c\u53d6\u7684\u8868\u5355\u8bdd\u5355\u7b49\u3002 \u56e0\u6b64\u53d6\u8bc1\u5de5\u4f5c\u8005\u8981\u719f\u7ec3\u5730\u638c\u63e1\u6587\u4ef6\u63d0\u53d6\u3001\u6570\u636e\u6062\u590d\u3001\u7cfb\u7edf\u4eff\u771f\u3001\u8be6\u5355\u5206\u6790\u3001\u7f16\u7a0b\u4e0e\u9006\u5411\u5de5\u7a0b\u7b49\u77e5\u8bc6\u4e0e\u6280\u672f\u624b\u6bb5\u3002","title":"Windows Analysis"},{"location":"win/#_1","text":"\u4ece\u7269\u7406\u5c42\u9762\uff0c\u4e00\u4e2a\u78c1\u76d8\u6309\u5c42\u6b21\u5206\u4e3a \uff1a \u78c1\u76d8\u7ec4\u5408 \u2192 \u5355\u4e2a\u78c1\u76d8 \u2192 \u67d0\u4e00\u76d8\u9762 \uff08platter\uff09\u2192 \u67d0\u4e00\u78c1\u9053 \uff08track\uff09\u2192 \u67d0\u4e00\u6247\u533a\uff08sector\uff09 \u5173\u4e8e\u7c07\u548c\u6247\u533a\uff1a \u6587\u4ef6\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u65f6\uff0c\u57fa\u672c\u5355\u4f4d\u4e0d\u662f\u5b57\u8282\u800c\u662f\u7c07\u3002\u7c07\u7684\u5927\u5c0f\u4e0e\u78c1\u76d8\u7684\u89c4\u683c\u6709\u5173\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8f6f\u76d8\u6bcf\u7c07\u662f1\u4e2a\u6247\u533a\uff0c\u786c\u76d8\u6bcf\u7c07\u7684\u6247\u533a\u6570\u4e0e\u786c\u76d8\u7684\u603b\u5bb9\u91cf\u5927\u5c0f\u6709\u5173\uff0c\u53ef\u80fd\u662f4\u30018\u300116\u300132\u300164\u2026\u2026 Windows\u6587\u4ef6\u7cfb\u7edf\uff1a \u901a\u5e38\u5728Windows\u5e73\u53f0\u4e0b\u4f7f\u7528\u76843\u79cd\u6587\u4ef6\u7cfb\u7edf\u662fFAT\uff08\u6587\u4ef6\u5206\u533a\u8868\uff09\uff0cFAT32\uff0832\u4f4d\u6587\u4ef6\u5206\u533a\u8868\uff09\u548cNTFS\uff08NT\u6587\u4ef6\u7cfb\u7edf\uff09\u3002 \u5728FAT\u6587\u4ef6\u7cfb\u7edf\u4e0b\uff0c\u6bcf\u4e00\u4e2a\u78c1\u76d8\u88ab\u5206\u6210\u56fa\u5b9a\u5927\u5c0f\u7684\u7c07\u3002\u7c07\u6700\u5c11\u4e3a512\u4e2a\u5b57\u8282\uff0c\u5176\u5927\u5c0f\u53ef\u4ee5\u6210\u500d\u589e\u957f\uff0c\u6700\u5927\u4e3a32K\u3002\u6bcf\u4e2a\u7c07\u90fd\u662f\u7531\u552f\u4e00\u7684\u7d22\u5f15\u53f7\u2014\u2014\u4e00\u4e2a16\u4f4d\u4e8c\u8fdb\u5236\u6570\u6765\u6807\u8bc6\u3002\u56e0\u4e3a16\u4f4d\u4e8c\u8fdb\u5236\u6570\u6700\u5927\u4e3a65536\uff0c\u6240\u4ee5FAT\u5206\u533a\u6240\u62e5\u6709\u7684\u7c07\u7684\u6570\u91cf\u4e0d\u53ef\u80fd\u8d85\u8fc765536\u4e2a\u3002 FAT32\u6587\u4ef6\u7684\u539f\u7406\u51e0\u4e4e\u4e0e\u6b64\u76f8\u540c\uff0c\u4f46\u5b83\u7684\u7c07\u66f4\u5c0f\uff0c\u800c\u4e14\u7531\u4e8eFAT32\u5165\u53e3\u662f32\u4f4d\uff0c\u6240\u4ee5\u5176\u5bb9\u91cf\u7406\u8bba\u4e0a\u53ef\u4ee5\u8d85\u8fc740\u4ebf\u4e2a\u5b57\u8282\u3002 NTFS\u662f\u4e00\u4e2a\u76f8\u5f53\u9ad8\u7ea7\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u5b83\u7684\u4e3b\u6587\u4ef6\u8868\uff08MFT\uff09\u662f\u4e00\u4e2a\u975e\u5e38\u5b8c\u6574\u7684\u6570\u636e\u5e93\uff0c\u5b83\u8d1f\u8d23\u5bf9\u78c1\u76d8\u4e0a\u7684\u6bcf\u4e2a\u6587\u4ef6\u8fdb\u884c\u7d22\u5f15\u3002\u6bcf\u4e2aMFT\u7684\u5165\u53e3\u901a\u5e38\u4e3a1K\u5927\u5c0f\uff0c\u5176\u4e2d\u8bb0\u5f55\u4e86\u5927\u91cf\u7684\u6587\u4ef6\u4fe1\u606f\u3002NTFS\u53ef\u4ee5\u5728\u6587\u4ef6\u7684MFT\u5165\u53e3\u4e2d\u5b58\u50a8\u975e\u5e38\u5c0f\u7684\u6587\u4ef6\u7684\u5168\u90e8\u5185\u5bb9\uff1b\u5bf9\u4e8e\u5927\u4e00\u4e9b\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u5165\u53e3\u4f1a\u6807\u8bc6\u51fa\u5305\u542b\u6587\u4ef6\u6570\u636e\u7684\u7c07\u3002","title":"\u78c1\u76d8\u7ed3\u6784"},{"location":"win/#_2","text":"\u63a8\u8350\u4f7f\u7528\u7684\u6709\u4e24\u79cd\u8f6f\u4ef6\uff1a\u7f8e\u4e9a\u7684\u53d6\u8bc1\u5927\u5e08\u548c\u5f18\u8fde\u7684\u8bc1\u636e\u5206\u6790\u8f6f\u4ef6\u3002 \u4e8c\u8005\u5404\u6709\u5404\u7684\u4f18\u7f3a\u70b9\uff0c\u53d6\u8bc1\u5927\u5e08\u4e3b\u8981\u4f53\u73b0\u5728\u5e7f\u5ea6\uff0c\u529f\u80fd\u975e\u5e38\u9f50\u5168\u3002\u5728\u81ea\u52a8\u53d6\u8bc1\u7ed3\u679c\u4e2d\u80fd\u591f\u76f4\u63a5\u63d0\u4f9b\u5f88\u591a\u6709\u7528\u7684\u4fe1\u606f\uff08\u5982\u65f6\u95f4\u7ebf\uff0c\u8f6f\u4ef6\u4f7f\u7528\u75d5\u8ff9\u7b49\uff09\uff0c\u7701\u53bb\u5f88\u591a\u9ebb\u70e6\u300219\u5e74\u589e\u52a0\u5c0f\u7a0b\u5e8f\u677f\u5757\u540e\uff0c\u529f\u80fd\u7684\u6269\u5c55\u6027\u4e5f\u6781\u597d\uff0c\u80fd\u591f\u8c03\u7528python\u7b49\u811a\u672c\u53bb\u505a\u65e5\u5fd7\u5206\u6790\u7b49\uff0c\u8fd8\u63d0\u4f9b\u4e86\u5305\u62ec\u5982\u6b63\u5219\u8868\u8fbe\u5f0f\u5728\u5185\u7684\u5339\u914d\u65b9\u6cd5\uff0c\u7b5b\u9009\u529f\u80fd\u5f3a\u5927\u3002 \u706b\u773c\u8bc1\u636e\u5206\u6790\u8f6f\u4ef6\u8865\u5145\u4e86\u53d6\u8bc1\u5927\u5e08\u5728\u5904\u7406\u6570\u636e\u5e93\u548c\u5907\u4efd\u6587\u4ef6\u4e0a\u7684\u7f3a\u9677\u3002\u4e0d\u4ec5\u80fd\u591f\u5bf9SQL\u6570\u636e\u5e93\u8fdb\u884c\u76f4\u63a5\u9884\u89c8\u548c\u5904\u7406\uff0c\u800c\u4e14\u80fd\u5c06PC\u4e2d\u7684iOS\u4e0eAndroid\u5907\u4efd\u6587\u4ef6\u4f5c\u4e3a\u8bc1\u636e\u6587\u4ef6\uff0c\u518d\u6b21\u8fdb\u884c\u53d6\u8bc1\u5206\u6790\uff0c\u751a\u81f3\u5c06\u624b\u673a\u4e2d\u7684\u5fae\u4fe1\u8bb0\u5f55\u7b49\u7ec6\u8282\u76f4\u89c2\u7684\u6295\u5230\u5c4f\u5e55\uff0c\u5728\u9047\u5230PC+\u624b\u673a\u5907\u4efd\u7684\u60c5\u51b5\u4e0b\u8f83\u4e3a\u5b9e\u7528\u3002","title":"\u4fe1\u606f\u63d0\u53d6\u4e0e\u5206\u6790"},{"location":"win/#_3","text":"\u7cfb\u7edf\u4eff\u771f\u662f\u6307\u5c06\u955c\u50cf\u6587\u4ef6\u6216\u8005\u5bf9\u8c61\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u786c\u76d8\u6a21\u62df\u4e3a\u865a\u62df\u673a\uff0c\u5728\u865a\u62df\u673a\u73af\u5883\u4e0b\u8fdb\u884c\u542f\u52a8\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ee5\u4ea4\u4e92\u7684\u65b9\u5f0f\u548c\u7cfb\u7edf\u7528\u6237\u7684\u89d2\u5ea6\u76f4\u89c2\u7684\u68c0\u67e5\u548c\u64cd\u4f5c\u76ee\u6807\u7cfb\u7edf\uff0c\u67e5\u770b\u76f8\u5173\u4fe1\u606f\u3002 \u76ee\u524d\u63a8\u8350\u4f7f\u7528\u7684\u8f6f\u4ef6\u5de5\u5177\u662f\u5f18\u8fde\u7684\u706b\u773c\u4eff\u771f\u8f6f\u4ef6\uff0c\u80fd\u65b9\u4fbf\u5730\u5b9e\u73b0\u9501\u5b9a\u7cfb\u7edf\u7248\u672c\u548c\u7ed5\u8fc7\u5f00\u673a\u5bc6\u7801\uff0c\u5e76\u8c03\u7528\u672c\u673a\u7684VMware\u865a\u62df\u673a\u5b9e\u73b0\u4eff\u771f\uff0c\u5982\u4e0b\uff1a","title":"\u7cfb\u7edf\u4eff\u771f"},{"location":"win/#_4","text":"","title":"\u77e5\u8bc6\u6574\u7406\uff08\u6301\u7eed\u5b8c\u5584\u4e2d\uff09"},{"location":"win/#_5","text":"\u9996\u5148\u9700\u8981\u7406\u89e3 4K\u5bf9\u9f50 \u7684\u539f\u7406\u3002 \u7535\u8111\u4f20\u7edf\u673a\u68b0\u786c\u76d8\u7684\u6bcf\u4e2a\u6247\u533a\u4e00\u822c\u5927\u5c0f\u4e3a512\u4e2a\u5b57\u8282\uff0c\u7136\u800c\u968f\u7740\u65f6\u4ee3\u53d1\u5c55\uff0c\u786c\u76d8\u5bb9\u91cf\u4e0d\u65ad\u6269\u5c55\uff0c\u4e8e\u662f\u5c06\u6bcf\u4e2a\u6247\u533a512\u5b57\u8282\u6539\u4e3a\u6bcf\u4e2a\u6247\u533a4096\u4e2a\u5b57\u8282\uff0c\u4e5f\u5c31\u662f\u73b0\u5728\u5e38\u8bf4\u7684\u201c4K\u6247\u533a\u201d\u3002 \u968f\u7740NTFS\u6210\u4e3a\u4e86\u6807\u51c6\u7684\u786c\u76d8\u6587\u4ef6\u7cfb\u7edf\uff0c\u5176\u6587\u4ef6\u7cfb\u7edf\u7684\u9ed8\u8ba4\u5206\u914d\u5355\u5143\u5927\u5c0f\uff08\u7c07\uff09\u4e5f\u662f4096\u5b57\u8282\uff0c\u4e3a\u4e86\u4f7f\u7c07\u4e0e\u6247\u533a\u76f8\u5bf9\u5e94\uff0c\u5373\u4f7f\u7269\u7406\u786c\u76d8\u5206\u533a\u4e0e\u8ba1\u7b97\u673a\u4f7f\u7528\u7684\u903b\u8f91\u5206\u533a\u5bf9\u9f50\uff0c\u4fdd\u8bc1\u786c\u76d8\u8bfb\u5199\u6548\u7387\uff0c\u6240\u4ee5\u5c31\u6709\u4e86\u201c4K\u5bf9\u9f50\u201d\u7684\u6982\u5ff5\u3002 \u4f8b\uff082019\u7f8e\u4e9a\u676f\u4e2a\u4eba4\uff09 \u901a\u8fc7\u53d6\u8bc1\u5927\u5e08\u67e5\u770b\uff1a \u5f97\u77e5D\u76d8\u4e3a\u7cfb\u7edf\uff08OS\uff09\u76d8\uff0c\u6247\u533a\u6570\u4e3a 961099776 \u518d\u6b21\u786e\u8ba4\u903b\u8f91\u6247\u533a\u7684\u5927\u5c0f\u4e3a 512 \u5b57\u8282\uff0c\u6545\u9700\u8981\u7a7a\u51fa4096/512= 8 \u4e2a\u6247\u533a\u7684\u7a7a\u95f4\uff0c\u5373: (961099776 - 8) * 512 = 492,083,081,216","title":"\u78c1\u76d8\u5bb9\u91cf"},{"location":"win/#_6","text":"\u7531\u4e8e\u5728\u6570\u636e\u5e93\u7b49\u4fe1\u606f\u50a8\u5b58\u4ecb\u8d28\u4e2d\uff0c\u7ecf\u5e38\u4f7f\u7528 \u65f6\u95f4\u6233(timestamp) \u6765\u8bb0\u5f55\u65f6\u95f4\u4fe1\u606f\uff0c\u9700\u8981\u7406\u89e3\u5e76\u80fd\u591f\u628a\u5b83\u4e0e\u6807\u51c6\u65f6\u95f4\u8fdb\u884c\u4e92\u76f8\u8f6c\u6362\u3002 \u4f8b\uff082019\u7f8e\u4e9a\u676f\u4e2a\u4eba41\uff09 \u5229\u7528\u53d6\u8bc1\u5927\u5e08\u5f97\u5230\u4e0a\u4f20\u7684\u6807\u51c6\u65f6\u95f4\uff08\u5e74-\u6708-\u65e5 \u65f6:\u5206:\u79d2\uff092019-10-31 15:22:31 \u6700\u540e\u4f7f\u7528Python\u5e93\u51fd\u6570\u8f6c\u6362\u4e3a\u65f6\u95f4\u6233\uff0c\u9644\u4ee3\u7801\uff1a '''\u6807\u51c6\u65f6\u95f4\u5230\u65f6\u95f4\u6233''' import time a = time_str timeArray = time.strptime(a,\"%Y-%m-%d %H:%M:%S\") timeStamp = int(time.mktime(timeArray)) '''\u65f6\u95f4\u6233\u5230\u6807\u51c6\u65f6\u95f4''' import time timeArray = time.localtime(timeStamp) otherStyleTime = time.strftime(\"%Y-%m-%d %H:%M:%S\", timeArray) \u6d4b\u8bd5\uff1a","title":"\u65f6\u95f4\u6233"},{"location":"win/#_7","text":"\u4f8b\uff082019\u7f8e\u4e9a\u676f\u4e2a\u4eba15\uff09 \u60f3\u5728\u955c\u50cf\u6587\u4ef6\u4e2d\u627e\u5230\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u8c03\u7528\u60c5\u51b5\u53ef\u80fd\u6bd4\u8f83\u56f0\u96be\uff0c\u4e0d\u59a8\u6362\u4e2a\u601d\u8def\u3002 \u5229\u7528\u53d6\u8bc1\u5927\u5e08\u63d0\u53d6\u51fa\u8be5exe\u7a0b\u5e8f\u540e\u5728\u672c\u5730\u8fd0\u884c\uff0c\u518d\u5229\u7528\u706b\u7ed2\u5251\u67e5\u770b\u5373\u53ef\u3002","title":"\u52a8\u6001\u94fe\u63a5\u5e93"}]}